<!DOCTYPE html>
<!-- saved from url=(0061)http://andrew.gibiansky.com/blog/physics/quadcopter-dynamics/ -->
<html class="no-js" lang="en"><!--<![endif]--><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  <title>Quadcopter Dynamics and Simulation -  Andrew Gibiansky</title>
  <meta name="author" content="Andrew Gibiansky">

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link href="./Quadcopter_Dynamics_and_Simulation_files/css" rel="stylesheet" type="text/css">
  <link href="http://andrew.gibiansky.com/favicon.ico" rel="icon">
  <link rel="stylesheet" href="./Quadcopter_Dynamics_and_Simulation_files/font-awesome.min.css">
  <link href="./Quadcopter_Dynamics_and_Simulation_files/asciidoctor-default.css" rel="stylesheet" type="text/css">
  <link href="./Quadcopter_Dynamics_and_Simulation_files/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script type="text/javascript" async="" src="./Quadcopter_Dynamics_and_Simulation_files/ga.js"></script><script src="./Quadcopter_Dynamics_and_Simulation_files/jquery.min.js"></script>

  <script type="text/javascript">
  window.MathJax = {
      tex2jax: {
        // Hack for Hakyll. Char code 86 is a dollar sign, which is used in templates...
        inlineMath: [ [String.fromCharCode(36), String.fromCharCode(36)], ["\\(","\\)"] ],
        processEscapes: true
      }
  };
  </script>
  <script type="text/javascript" src="./Quadcopter_Dynamics_and_Simulation_files/MathJax.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>

  <style>
  table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
      margin: 0;
      padding: 0;
      vertical-align: baseline;
      border: none;
  }
  table.sourceCode { 
      width: 100%;
      background-color: #2a211c;
      color: #bdae9d;

      line-height: 1.4;
      font-size: 0.8em;
  }
  td.lineNumbers { 
      text-align: right;
      padding-right: 4px;
      padding-left: 4px;
      background-color: #2a211c;
      color: #bdae9d;
      border-right: 1px solid #bdae9d;
  }
  td.sourceCode { 
      padding-left: 5px;
  }

  pre.sourceCode, code.sourceCode { 
      color: #bdbdbd;
      background-color: #000000;
  }

  code > span.dt { text-decoration: underline; }
  code > span.dv { color: #44aa43; }
  code > span.bn { color: #44aa43; }
  code > span.fl { color: #44aa43; }
  code > span.ch { color: #049b0a; }
  code > span.st { color: #049b0a; }
  code > span.al { color: #ffff00; }
  code > span.er { font-weight: bold; }

  code > span.co {
      color: #ee5555;
      font-style: italic;
  }
  code > span.fu { 
      color: #ff9358;
      font-weight: bold;
  }
  code > span.kw { 
      color: #43a8ed;
      font-weight: bold;
  }
  </style>

  <style>
  .center {
      text-align: center;
  }
  .gist .line-data { width: 100% }

  .entry-content figure {
    display: block;
    margin-left: auto;
    margin-right: auto;
    text-align: center;
    margin-bottom: 1em;
    margin-top: 1em;
  }
  </style>

  

  <script type="text/javascript">
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-40714888-1']);
_gaq.push(['_trackPageview']);

(function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();
</script>

<style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax_LineBox {display: table!important}
.MathJax_LineBox span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Blank; src: url('about:blank')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>

<body><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>
  <header role="banner">
    <hgroup>
      <h1>
        <a href="http://andrew.gibiansky.com/">
          Andrew Gibiansky
          &nbsp;&nbsp;::&nbsp;
          &nbsp;<em>Math</em>&nbsp;→&nbsp;[<strong>Code</strong>]
        </a>
      </h1>
    </hgroup>
  </header>
  <nav role="navigation"><ul class="main-navigation">
  <li><a href="http://andrew.gibiansky.com/">Blog</a></li>
  <li><a href="http://andrew.gibiansky.com/archive.html">Archive</a></li>
  <li><a href="http://andrew.gibiansky.com/pages/about.html">About</a></li>
</ul>
</nav>
  <div id="main">
    <div id="content">
        <div>
<article class="hentry" role="article">

  <header>
    <!--
    <div style="text-align: center; font-weight: bold; font-size: 1.3em; border-width: 2px; border-style: solid; border-radius: 20px; padding: 0.5em; background: none repeat scroll 0% 0% rgba(225, 68, 68, 0.2); overflow: hidden;"><div><img style="float: left; width: 70px; border: none; box-shadow: none;" src="http://www.kronosnotebook.com/static/imgs/logo.png" alt="Kronos Notebook logo"> <div style="">Check out <a href="http://www.kronosnotebook.com">Kronos Notebook</a>, my new <a href="http://www.ipython.org/notebook.html">IPython</a>-based Mac app for interactive computing and data analysis in Python or Haskell.</div></div></div> -->

    <h1 class="entry-title">Quadcopter Dynamics and Simulation</h1>

    <p class="meta">
    Friday, November 23, 2012
    </p>
</header>


<div class="entry-content"><h1 id="introduction" class="unnumbered">Introduction</h1>
<p>A helicopter is a flying vehicle which uses rapidly spinning rotors to push air downwards, thus creating a thrust force keeping the helicopter aloft. Conventional helicopters have two rotors. These can be arranged as two coplanar rotors both providing upwards thrust, but spinning in opposite directions (in order to balance the torques exerted upon the body of the helicopter). The two rotors can also be arranged with one main rotor providing thrust and a smaller side rotor oriented laterally and counteracting the torque produced by the main rotor. However, these configurations require complicated machinery to control the direction of motion; a swashplate is used to change the angle of attack on the main rotors. In order to produce a torque the angle of attack is modulated by the location of each rotor in each stroke, such that more thrust is produced on one side of the rotor plane than the other. The complicated design of the rotor and swashplate mechanism presents some problems, increasing construction costs and design complexity.</p>
<p>A quadrotor helicopter (quadcopter) is a helicopter which has four equally spaced rotors, usually arranged at the corners of a square body. With four independent rotors, the need for a swashplate mechanism is alleviated. The swashplate mechanism was needed to allow the helicopter to utilize more degrees of freedom, but the same level of control can be obtained by adding two more rotors.</p>
<p>The development of quadcopters has stalled until very recently, because controlling four independent rotors has proven to be incredibly difficult and impossible without electronic assistance. The decreasing cost of modern microprocessors has made electronic and even completely autonomous control of quadcopters feasible for commercial, military, and even hobbyist purposes.</p>
<p>Quadcopter control is a fundamentally difficult and interesting problem. With six degrees of freedom (three translational and three rotational) and only four independent inputs (rotor speeds), quadcopters are severely underactuated. In order to achieve six degrees of freedom, rotational and translational motion are coupled. The resulting dynamics are highly nonlinear, especially after accounting for the complicated aerodynamic effects. Finally, unlike ground vehicles, helicopters have very little friction to prevent their motion, so they must provide their own damping in order to stop moving and remain stable. Together, these factors create a very interesting control problem. We will present a very simplified model of quadcopter dynamics and design controllers for our dynamics to follow a designated trajectory. We will then test our controllers with a numerical simulation of a quadcopter in flight.</p>
<h1 id="quadcopter-dynamics" class="unnumbered">Quadcopter Dynamics</h1>
<p>We will start deriving quadcopter dynamics by introducing the two frames in which will operate. The inertial frame is defined by the ground, with gravity pointing in the negative <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 0.467em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.374em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(2em 1000.37em 2.789em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: STIXGeneral-Italic;">z</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.16em; border-left: 0px solid; width: 0px; height: 0.709em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-1">z</script></span> direction. The body frame is defined by the orientation of the quadcopter, with the rotor axes pointing in the positive <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4" style="width: 0.467em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.374em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(2em 1000.37em 2.789em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-5"><span class="mi" id="MathJax-Span-6" style="font-family: STIXGeneral-Italic;">z</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.16em; border-left: 0px solid; width: 0px; height: 0.709em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-2">z</script></span> direction and the arms pointing in the <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-7" style="width: 0.56em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(2em 1000.47em 2.696em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-8"><span class="mi" id="MathJax-Span-9" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.655em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-3">x</script></span> and <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-10" style="width: 0.56em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(2em 1000.47em 2.882em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-11"><span class="mi" id="MathJax-Span-12" style="font-family: STIXGeneral-Italic;">y</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.269em; border-left: 0px solid; width: 0px; height: 0.872em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-4">y</script></span> directions.</p>
<p><img src="./Quadcopter_Dynamics_and_Simulation_files/Quadcopter_Coordinates.png" alt="image"><br>
<span>Quadcopter Body Frame and Inertial Frame</span></p>
<h2 id="kinematics" class="unnumbered">Kinematics</h2>
<p>Before delving into the physics of quadcopter motion, let us formalize the kinematics in the body and inertial frames. We define the position and velocity of the quadcopter in the inertial frame as <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-13" style="width: 5.995em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.112em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.582em 1005.11em 2.882em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-14"><span class="mi" id="MathJax-Span-15" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-16" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="mo" id="MathJax-Span-17" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">(</span><span class="texatom" id="MathJax-Span-18"><span class="mrow" id="MathJax-Span-19"><span class="mi" id="MathJax-Span-20" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-21" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-22" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">y</span><span class="mo" id="MathJax-Span-23" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-24" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">z</span></span></span><span class="msubsup" id="MathJax-Span-25"><span style="display: inline-block; position: relative; width: 0.838em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.28em 4.322em -999.998em); top: -3.992em; left: 0em;"><span class="mo" id="MathJax-Span-26" style="font-family: STIXGeneral-Regular;">)</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.364em; left: 0.327em;"><span class="mi" id="MathJax-Span-27" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.269em; border-left: 0px solid; width: 0px; height: 1.307em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>=</mo><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi></mrow><msup><mo stretchy="false">)</mo><mi>T</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-5">x = ({x , y , z})^T</script></span> and <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-28" style="width: 6.041em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.158em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.582em 1005.16em 2.882em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-29"><span class="texatom" id="MathJax-Span-30"><span class="mrow" id="MathJax-Span-31"><span class="munderover" id="MathJax-Span-32"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.47em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-33" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.254em 1000.24em 3.626em -999.998em); top: -4.039em; left: 0.095em;"><span class="mo" id="MathJax-Span-34" style="font-family: STIXGeneral-Regular;">˙</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-35" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="mo" id="MathJax-Span-36" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">(</span><span class="texatom" id="MathJax-Span-37"><span class="mrow" id="MathJax-Span-38"><span class="texatom" id="MathJax-Span-39"><span class="mrow" id="MathJax-Span-40"><span class="munderover" id="MathJax-Span-41"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.47em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-42" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.254em 1000.24em 3.626em -999.998em); top: -4.039em; left: 0.095em;"><span class="mo" id="MathJax-Span-43" style="font-family: STIXGeneral-Regular;">˙</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-44" style="font-family: STIXGeneral-Regular;">,</span><span class="texatom" id="MathJax-Span-45" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-46"><span class="munderover" id="MathJax-Span-47"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.322em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-48" style="font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.254em 1000.24em 3.626em -999.998em); top: -4.039em; left: 0.049em;"><span class="mo" id="MathJax-Span-49" style="font-family: STIXGeneral-Regular;">˙</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-50" style="font-family: STIXGeneral-Regular;">,</span><span class="texatom" id="MathJax-Span-51" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-52"><span class="munderover" id="MathJax-Span-53"><span style="display: inline-block; position: relative; width: 0.374em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.37em 4.229em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-54" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.254em 1000.24em 3.626em -999.998em); top: -3.992em; left: 0.049em;"><span class="mo" id="MathJax-Span-55" style="font-family: STIXGeneral-Regular;">˙</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span></span></span><span class="msubsup" id="MathJax-Span-56"><span style="display: inline-block; position: relative; width: 0.838em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.28em 4.322em -999.998em); top: -3.992em; left: 0em;"><span class="mo" id="MathJax-Span-57" style="font-family: STIXGeneral-Regular;">)</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.364em; left: 0.327em;"><span class="mi" id="MathJax-Span-58" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.269em; border-left: 0px solid; width: 0px; height: 1.307em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mi>x</mi><mo>˙</mo></mover></mrow><mo>=</mo><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mover><mi>x</mi><mo>˙</mo></mover></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo>˙</mo></mover></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>z</mi><mo>˙</mo></mover></mrow></mrow><msup><mo stretchy="false">)</mo><mi>T</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-6">\dot x = ({\dot x , \dot y , \dot z})^T</script></span>, respectively. Similarly, we define the roll, pitch, and yaw angles in the body frame as <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03C8;&lt;/mi&gt;&lt;/mrow&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-59" style="width: 6.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.623em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.582em 1005.62em 2.882em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-60"><span class="mi" id="MathJax-Span-61" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-62" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="mo" id="MathJax-Span-63" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">(</span><span class="texatom" id="MathJax-Span-64"><span class="mrow" id="MathJax-Span-65"><span class="mi" id="MathJax-Span-66" style="font-family: STIXGeneral-Italic;">ϕ</span><span class="mo" id="MathJax-Span-67" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-68" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-69" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-70" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.095em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-71"><span style="display: inline-block; position: relative; width: 0.838em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.28em 4.322em -999.998em); top: -3.992em; left: 0em;"><span class="mo" id="MathJax-Span-72" style="font-family: STIXGeneral-Regular;">)</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.364em; left: 0.327em;"><span class="mi" id="MathJax-Span-73" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.269em; border-left: 0px solid; width: 0px; height: 1.307em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi><mo>=</mo><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi>ϕ</mi><mo>,</mo><mi>θ</mi><mo>,</mo><mi>ψ</mi></mrow><msup><mo stretchy="false">)</mo><mi>T</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-7">\theta = ({\phi , \theta , \psi})^T</script></span>, with corresponding angular velocities equal to <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03C8;&lt;/mi&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-74" style="width: 6.645em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.669em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.535em 1005.67em 2.882em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-75"><span class="texatom" id="MathJax-Span-76"><span class="mrow" id="MathJax-Span-77"><span class="munderover" id="MathJax-Span-78"><span style="display: inline-block; position: relative; width: 0.513em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.51em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-79" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.254em 1000.24em 3.626em -999.998em); top: -4.271em; left: 0.095em;"><span class="mo" id="MathJax-Span-80" style="font-family: STIXGeneral-Regular;">˙</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-81" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="mo" id="MathJax-Span-82" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">(</span><span class="texatom" id="MathJax-Span-83"><span class="mrow" id="MathJax-Span-84"><span class="texatom" id="MathJax-Span-85"><span class="mrow" id="MathJax-Span-86"><span class="munderover" id="MathJax-Span-87"><span style="display: inline-block; position: relative; width: 0.606em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.61em 4.322em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-88" style="font-family: STIXGeneral-Italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.254em 1000.24em 3.626em -999.998em); top: -4.271em; left: 0.142em;"><span class="mo" id="MathJax-Span-89" style="font-family: STIXGeneral-Regular;">˙</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-90" style="font-family: STIXGeneral-Regular;">,</span><span class="texatom" id="MathJax-Span-91" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-92"><span class="munderover" id="MathJax-Span-93"><span style="display: inline-block; position: relative; width: 0.513em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.51em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-94" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.254em 1000.24em 3.626em -999.998em); top: -4.271em; left: 0.095em;"><span class="mo" id="MathJax-Span-95" style="font-family: STIXGeneral-Regular;">˙</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-96" style="font-family: STIXGeneral-Regular;">,</span><span class="texatom" id="MathJax-Span-97" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-98"><span class="munderover" id="MathJax-Span-99"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.322em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-100" style="font-family: STIXGeneral-Italic;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.095em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.254em 1000.24em 3.626em -999.998em); top: -4.039em; left: 0.235em;"><span class="mo" id="MathJax-Span-101" style="font-family: STIXGeneral-Regular;">˙</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span></span></span><span class="msubsup" id="MathJax-Span-102"><span style="display: inline-block; position: relative; width: 0.838em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.28em 4.322em -999.998em); top: -3.992em; left: 0em;"><span class="mo" id="MathJax-Span-103" style="font-family: STIXGeneral-Regular;">)</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.364em; left: 0.327em;"><span class="mi" id="MathJax-Span-104" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.269em; border-left: 0px solid; width: 0px; height: 1.416em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mi>θ</mi><mo>˙</mo></mover></mrow><mo>=</mo><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mover><mi>ϕ</mi><mo>˙</mo></mover></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>θ</mi><mo>˙</mo></mover></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>ψ</mi><mo>˙</mo></mover></mrow></mrow><msup><mo stretchy="false">)</mo><mi>T</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-8">\dot \theta =  ({\dot \phi , \dot \theta , \dot \psi})^T</script></span>. However, note that the angular velocity vector <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-105" style="width: 3.022em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.557em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.535em 1002.56em 2.836em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-106"><span class="mi" id="MathJax-Span-107" style="font-family: STIXGeneral-Italic;">ω</span><span class="mo" id="MathJax-Span-108" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">≠</span><span class="texatom" id="MathJax-Span-109" style="padding-left: 0.327em;"><span class="mrow" id="MathJax-Span-110"><span class="munderover" id="MathJax-Span-111"><span style="display: inline-block; position: relative; width: 0.513em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.51em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-112" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.254em 1000.24em 3.626em -999.998em); top: -4.271em; left: 0.095em;"><span class="mo" id="MathJax-Span-113" style="font-family: STIXGeneral-Regular;">˙</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.215em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ω</mi><mo>≠</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>θ</mi><mo>˙</mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-9">\omega \ne \dot \theta</script></span>. The angular velocity is a vector pointing along the axis of rotation, while <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-114" style="width: 0.606em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.513em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.21em 1000.51em 2.371em -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-115"><span class="texatom" id="MathJax-Span-116"><span class="mrow" id="MathJax-Span-117"><span class="munderover" id="MathJax-Span-118"><span style="display: inline-block; position: relative; width: 0.513em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.51em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-119" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.254em 1000.24em 3.626em -999.998em); top: -4.271em; left: 0.095em;"><span class="mo" id="MathJax-Span-120" style="font-family: STIXGeneral-Regular;">˙</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 1.144em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mi>θ</mi><mo>˙</mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-10">\dot \theta</script></span> is just the time derivative of yaw, pitch, and roll. In order to convert these angular velocities into the angular velocity vector, we can use the following relation: <span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-121" style="width: 11.754em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.036em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(2.325em 1010.04em 6.691em -999.998em); top: -4.736em; left: 0em;"><span class="mrow" id="MathJax-Span-122"><span class="mi" id="MathJax-Span-123" style="font-family: STIXGeneral-Italic;">ω</span><span class="mo" id="MathJax-Span-124" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="texatom" id="MathJax-Span-125" style="padding-left: 0.327em;"><span class="mrow" id="MathJax-Span-126"><span class="mrow" id="MathJax-Span-127"><span class="mo" id="MathJax-Span-128" style="vertical-align: 2.278em;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.296em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.23em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.552em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.763em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -0.973em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mtable" id="MathJax-Span-129" style="padding-right: 0.188em; padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 6.18em; height: 0px;"><span style="position: absolute; clip: rect(2.371em 1000.47em 6.366em -999.998em); top: -4.689em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.513em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.37em 4.136em -999.998em); top: -5.479em; left: 50%; margin-left: -0.23em;"><span class="mtd" id="MathJax-Span-130"><span class="mrow" id="MathJax-Span-131"><span class="mn" id="MathJax-Span-132" style="font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em 1000.47em 4.136em -999.998em); top: -4.039em; left: 50%; margin-left: -0.23em;"><span class="mtd" id="MathJax-Span-142"><span class="mrow" id="MathJax-Span-143"><span class="mn" id="MathJax-Span-144" style="font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em 1000.47em 4.136em -999.998em); top: -2.506em; left: 50%; margin-left: -0.23em;"><span class="mtd" id="MathJax-Span-158"><span class="mrow" id="MathJax-Span-159"><span class="mn" id="MathJax-Span-160" style="font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.694em;"></span></span><span style="position: absolute; clip: rect(2.65em 1001.58em 6.924em -999.998em); top: -4.968em; left: 1.628em;"><span style="display: inline-block; position: relative; width: 1.582em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.47em 4.136em -999.998em); top: -5.479em; left: 50%; margin-left: -0.23em;"><span class="mtd" id="MathJax-Span-133"><span class="mrow" id="MathJax-Span-134"><span class="mn" id="MathJax-Span-135" style="font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.44em 1000.98em 4.415em -999.998em); top: -4.039em; left: 50%; margin-left: -0.462em;"><span class="mtd" id="MathJax-Span-145"><span class="mrow" id="MathJax-Span-146"><span class="msubsup" id="MathJax-Span-147"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-148" style="font-family: STIXGeneral-Italic;">c</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-149" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.3em 1001.58em 4.415em -999.998em); top: -2.506em; left: 50%; margin-left: -0.787em;"><span class="mtd" id="MathJax-Span-161"><span class="mrow" id="MathJax-Span-162"><span class="mo" id="MathJax-Span-163" style="font-family: STIXGeneral-Regular;">−</span><span class="msubsup" id="MathJax-Span-164"><span style="display: inline-block; position: relative; width: 0.931em; height: 0px;"><span style="position: absolute; clip: rect(3.393em 1000.37em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-165" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.374em;"><span class="mi" id="MathJax-Span-166" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.973em;"></span></span><span style="position: absolute; clip: rect(2.65em 1001.81em 6.784em -999.998em); top: -4.829em; left: 4.322em;"><span style="display: inline-block; position: relative; width: 1.814em; height: 0px;"><span style="position: absolute; clip: rect(3.3em 1001.49em 4.276em -999.998em); top: -5.479em; left: 50%; margin-left: -0.741em;"><span class="mtd" id="MathJax-Span-136"><span class="mrow" id="MathJax-Span-137"><span class="mo" id="MathJax-Span-138" style="font-family: STIXGeneral-Regular;">−</span><span class="msubsup" id="MathJax-Span-139"><span style="display: inline-block; position: relative; width: 0.838em; height: 0px;"><span style="position: absolute; clip: rect(3.393em 1000.37em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-140" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.374em;"><span class="mi" id="MathJax-Span-141" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.393em 1001.77em 4.415em -999.998em); top: -4.039em; left: 50%; margin-left: -0.88em;"><span class="mtd" id="MathJax-Span-150"><span class="mrow" id="MathJax-Span-151"><span class="msubsup" id="MathJax-Span-152"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-153" style="font-family: STIXGeneral-Italic;">c</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-154" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-155"><span style="display: inline-block; position: relative; width: 0.931em; height: 0px;"><span style="position: absolute; clip: rect(3.393em 1000.37em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-156" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.374em;"><span class="mi" id="MathJax-Span-157" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.44em 1001.81em 4.415em -999.998em); top: -2.506em; left: 50%; margin-left: -0.927em;"><span class="mtd" id="MathJax-Span-167"><span class="mrow" id="MathJax-Span-168"><span class="msubsup" id="MathJax-Span-169"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-170" style="font-family: STIXGeneral-Italic;">c</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-171" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-172"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-173" style="font-family: STIXGeneral-Italic;">c</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-174" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.833em;"></span></span></span></span><span class="mo" id="MathJax-Span-175" style="vertical-align: 2.278em;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.296em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.23em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.552em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.763em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -0.973em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span></span><span class="texatom" id="MathJax-Span-176"><span class="mrow" id="MathJax-Span-177"><span class="munderover" id="MathJax-Span-178"><span style="display: inline-block; position: relative; width: 0.513em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.51em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-179" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.254em 1000.24em 3.626em -999.998em); top: -4.271em; left: 0.095em;"><span class="mo" id="MathJax-Span-180" style="font-family: STIXGeneral-Regular;">˙</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.74em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.171em; border-left: 0px solid; width: 0px; height: 4.894em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>ω</mi><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mo>−</mo><msub><mi>s</mi><mi>θ</mi></msub></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><msub><mi>c</mi><mi>ϕ</mi></msub></mtd><mtd><msub><mi>c</mi><mi>θ</mi></msub><msub><mi>s</mi><mi>ϕ</mi></msub></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mo>−</mo><msub><mi>s</mi><mi>ϕ</mi></msub></mtd><mtd><msub><mi>c</mi><mi>θ</mi></msub><msub><mi>c</mi><mi>ϕ</mi></msub></mtd></mtr></mtable><mo>]</mo></mrow></mrow><mrow class="MJX-TeXAtom-ORD"><mover><mi>θ</mi><mo>˙</mo></mover></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-11">\omega = {\begin{bmatrix} 
    1 &0 & -s_\theta \\
    0 & c_\phi & c_\theta s_\phi \\
    0 & -s_\phi & c_\theta c_\phi
\end{bmatrix}} \dot\theta</script></span> where <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-181" style="width: 0.838em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.699em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(2em 1000.65em 2.696em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-182"><span class="mi" id="MathJax-Span-183" style="font-family: STIXGeneral-Italic;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.655em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ω</mi></math></span></span><script type="math/tex" id="MathJax-Element-12">\omega</script></span> is the angular velocity vector in the body frame.</p>
<p>We can relate the body and inertial frame by a rotation matrix <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-184" style="width: 0.746em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.606em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.767em 1000.61em 2.696em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-185"><span class="mi" id="MathJax-Span-186" style="font-family: STIXGeneral-Italic;">R</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.872em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>R</mi></math></span></span><script type="math/tex" id="MathJax-Element-13">R</script></span> which goes from the body frame to the inertial frame. This matrix is derived by using the ZYZ Euler angle conventions and successively “undoing” the yaw, pitch, and roll. <span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;&amp;#x03C8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;&amp;#x03C8;&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;&amp;#x03C8;&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;&amp;#x03C8;&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;&amp;#x03C8;&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;&amp;#x03C8;&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;&amp;#x03C8;&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;&amp;#x03C8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;&amp;#x03C8;&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;&amp;#x03C8;&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-187" style="width: 23.785em; display: inline-block;"><span style="display: inline-block; position: relative; width: 20.301em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(2.325em 1020.25em 6.784em -999.998em); top: -4.782em; left: 0em;"><span class="mrow" id="MathJax-Span-188"><span class="mi" id="MathJax-Span-189" style="font-family: STIXGeneral-Italic;">R</span><span class="mo" id="MathJax-Span-190" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="texatom" id="MathJax-Span-191" style="padding-left: 0.327em;"><span class="mrow" id="MathJax-Span-192"><span class="mrow" id="MathJax-Span-193"><span class="mo" id="MathJax-Span-194" style="vertical-align: 2.325em;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.296em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.137em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.506em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.716em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -0.927em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mtable" id="MathJax-Span-195" style="padding-right: 0.188em; padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 17.05em; height: 0px;"><span style="position: absolute; clip: rect(2.696em 1005.81em 6.924em -999.998em); top: -4.921em; left: 0em;"><span style="display: inline-block; position: relative; width: 5.809em; height: 0px;"><span style="position: absolute; clip: rect(3.3em 1005.81em 4.415em -999.998em); top: -5.525em; left: 50%; margin-left: -2.924em;"><span class="mtd" id="MathJax-Span-196"><span class="mrow" id="MathJax-Span-197"><span class="msubsup" id="MathJax-Span-198"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-199" style="font-family: STIXGeneral-Italic;">c</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-200" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-201"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-202" style="font-family: STIXGeneral-Italic;">c</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-203" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-204" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">−</span><span class="msubsup" id="MathJax-Span-205" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-206" style="font-family: STIXGeneral-Italic;">c</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-207" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-208"><span style="display: inline-block; position: relative; width: 0.931em; height: 0px;"><span style="position: absolute; clip: rect(3.393em 1000.37em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-209" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.374em;"><span class="mi" id="MathJax-Span-210" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-211"><span style="display: inline-block; position: relative; width: 0.931em; height: 0px;"><span style="position: absolute; clip: rect(3.393em 1000.37em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-212" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.374em;"><span class="mi" id="MathJax-Span-213" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.3em 1005.81em 4.415em -999.998em); top: -3.992em; left: 50%; margin-left: -2.924em;"><span class="mtd" id="MathJax-Span-241"><span class="mrow" id="MathJax-Span-242"><span class="msubsup" id="MathJax-Span-243"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-244" style="font-family: STIXGeneral-Italic;">c</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-245" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-246"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-247" style="font-family: STIXGeneral-Italic;">c</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-248" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-249"><span style="display: inline-block; position: relative; width: 0.931em; height: 0px;"><span style="position: absolute; clip: rect(3.393em 1000.37em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-250" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.374em;"><span class="mi" id="MathJax-Span-251" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-252" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">+</span><span class="msubsup" id="MathJax-Span-253" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-254" style="font-family: STIXGeneral-Italic;">c</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-255" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-256"><span style="display: inline-block; position: relative; width: 0.931em; height: 0px;"><span style="position: absolute; clip: rect(3.393em 1000.37em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-257" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.374em;"><span class="mi" id="MathJax-Span-258" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.393em 1001.72em 4.415em -999.998em); top: -2.46em; left: 50%; margin-left: -0.88em;"><span class="mtd" id="MathJax-Span-286"><span class="mrow" id="MathJax-Span-287"><span class="msubsup" id="MathJax-Span-288"><span style="display: inline-block; position: relative; width: 0.931em; height: 0px;"><span style="position: absolute; clip: rect(3.393em 1000.37em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-289" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.374em;"><span class="mi" id="MathJax-Span-290" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-291"><span style="display: inline-block; position: relative; width: 0.838em; height: 0px;"><span style="position: absolute; clip: rect(3.393em 1000.37em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-292" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.374em;"><span class="mi" id="MathJax-Span-293" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.926em;"></span></span><span style="position: absolute; clip: rect(2.696em 1006.5em 6.924em -999.998em); top: -4.921em; left: 6.97em;"><span style="display: inline-block; position: relative; width: 6.505em; height: 0px;"><span style="position: absolute; clip: rect(3.3em 1006.5em 4.415em -999.998em); top: -5.525em; left: 50%; margin-left: -3.249em;"><span class="mtd" id="MathJax-Span-214"><span class="mrow" id="MathJax-Span-215"><span class="mo" id="MathJax-Span-216" style="font-family: STIXGeneral-Regular;">−</span><span class="msubsup" id="MathJax-Span-217"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-218" style="font-family: STIXGeneral-Italic;">c</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-219" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-220"><span style="display: inline-block; position: relative; width: 0.931em; height: 0px;"><span style="position: absolute; clip: rect(3.393em 1000.37em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-221" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.374em;"><span class="mi" id="MathJax-Span-222" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-223" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">−</span><span class="msubsup" id="MathJax-Span-224" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-225" style="font-family: STIXGeneral-Italic;">c</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-226" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-227"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-228" style="font-family: STIXGeneral-Italic;">c</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-229" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-230"><span style="display: inline-block; position: relative; width: 0.931em; height: 0px;"><span style="position: absolute; clip: rect(3.393em 1000.37em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-231" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.374em;"><span class="mi" id="MathJax-Span-232" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.3em 1005.81em 4.415em -999.998em); top: -3.992em; left: 50%; margin-left: -2.924em;"><span class="mtd" id="MathJax-Span-259"><span class="mrow" id="MathJax-Span-260"><span class="msubsup" id="MathJax-Span-261"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-262" style="font-family: STIXGeneral-Italic;">c</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-263" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-264"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-265" style="font-family: STIXGeneral-Italic;">c</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-266" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-267"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-268" style="font-family: STIXGeneral-Italic;">c</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-269" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-270" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">−</span><span class="msubsup" id="MathJax-Span-271" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 0.931em; height: 0px;"><span style="position: absolute; clip: rect(3.393em 1000.37em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-272" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.374em;"><span class="mi" id="MathJax-Span-273" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-274"><span style="display: inline-block; position: relative; width: 0.931em; height: 0px;"><span style="position: absolute; clip: rect(3.393em 1000.37em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-275" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.374em;"><span class="mi" id="MathJax-Span-276" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.393em 1001.77em 4.415em -999.998em); top: -2.46em; left: 50%; margin-left: -0.88em;"><span class="mtd" id="MathJax-Span-294"><span class="mrow" id="MathJax-Span-295"><span class="msubsup" id="MathJax-Span-296"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-297" style="font-family: STIXGeneral-Italic;">c</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-298" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-299"><span style="display: inline-block; position: relative; width: 0.838em; height: 0px;"><span style="position: absolute; clip: rect(3.393em 1000.37em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-300" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.374em;"><span class="mi" id="MathJax-Span-301" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.926em;"></span></span><span style="position: absolute; clip: rect(2.557em 1002.51em 6.552em -999.998em); top: -4.689em; left: 14.588em;"><span style="display: inline-block; position: relative; width: 2.511em; height: 0px;"><span style="position: absolute; clip: rect(3.393em 1001.77em 4.415em -999.998em); top: -5.525em; left: 50%; margin-left: -0.88em;"><span class="mtd" id="MathJax-Span-233"><span class="mrow" id="MathJax-Span-234"><span class="msubsup" id="MathJax-Span-235"><span style="display: inline-block; position: relative; width: 0.838em; height: 0px;"><span style="position: absolute; clip: rect(3.393em 1000.37em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-236" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.374em;"><span class="mi" id="MathJax-Span-237" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-238"><span style="display: inline-block; position: relative; width: 0.931em; height: 0px;"><span style="position: absolute; clip: rect(3.393em 1000.37em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-239" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.374em;"><span class="mi" id="MathJax-Span-240" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.3em 1002.51em 4.415em -999.998em); top: -3.992em; left: 50%; margin-left: -1.252em;"><span class="mtd" id="MathJax-Span-277"><span class="mrow" id="MathJax-Span-278"><span class="mo" id="MathJax-Span-279" style="font-family: STIXGeneral-Regular;">−</span><span class="msubsup" id="MathJax-Span-280"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-281" style="font-family: STIXGeneral-Italic;">c</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-282" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-283"><span style="display: inline-block; position: relative; width: 0.838em; height: 0px;"><span style="position: absolute; clip: rect(3.393em 1000.37em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-284" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.374em;"><span class="mi" id="MathJax-Span-285" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.44em 1000.88em 4.276em -999.998em); top: -2.46em; left: 50%; margin-left: -0.416em;"><span class="mtd" id="MathJax-Span-302"><span class="mrow" id="MathJax-Span-303"><span class="msubsup" id="MathJax-Span-304"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-305" style="font-family: STIXGeneral-Italic;">c</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-306" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.694em;"></span></span></span></span><span class="mo" id="MathJax-Span-307" style="vertical-align: 2.325em;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.296em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.137em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.506em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.716em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -0.927em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.787em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.226em; border-left: 0px solid; width: 0px; height: 5.003em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>R</mi><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>c</mi><mi>ϕ</mi></msub><msub><mi>c</mi><mi>ψ</mi></msub><mo>−</mo><msub><mi>c</mi><mi>θ</mi></msub><msub><mi>s</mi><mi>ϕ</mi></msub><msub><mi>s</mi><mi>ψ</mi></msub></mtd><mtd><mo>−</mo><msub><mi>c</mi><mi>ψ</mi></msub><msub><mi>s</mi><mi>ϕ</mi></msub><mo>−</mo><msub><mi>c</mi><mi>ϕ</mi></msub><msub><mi>c</mi><mi>θ</mi></msub><msub><mi>s</mi><mi>ψ</mi></msub></mtd><mtd><msub><mi>s</mi><mi>θ</mi></msub><msub><mi>s</mi><mi>ψ</mi></msub></mtd></mtr><mtr><mtd><msub><mi>c</mi><mi>θ</mi></msub><msub><mi>c</mi><mi>ψ</mi></msub><msub><mi>s</mi><mi>ϕ</mi></msub><mo>+</mo><msub><mi>c</mi><mi>ϕ</mi></msub><msub><mi>s</mi><mi>ψ</mi></msub></mtd><mtd><msub><mi>c</mi><mi>ϕ</mi></msub><msub><mi>c</mi><mi>θ</mi></msub><msub><mi>c</mi><mi>ψ</mi></msub><mo>−</mo><msub><mi>s</mi><mi>ϕ</mi></msub><msub><mi>s</mi><mi>ψ</mi></msub></mtd><mtd><mo>−</mo><msub><mi>c</mi><mi>ψ</mi></msub><msub><mi>s</mi><mi>θ</mi></msub></mtd></mtr><mtr><mtd><msub><mi>s</mi><mi>ϕ</mi></msub><msub><mi>s</mi><mi>θ</mi></msub></mtd><mtd><msub><mi>c</mi><mi>ϕ</mi></msub><msub><mi>s</mi><mi>θ</mi></msub></mtd><mtd><msub><mi>c</mi><mi>θ</mi></msub></mtd></mtr></mtable><mo>]</mo></mrow></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-14">R = {\begin{bmatrix} 
    c_\phi  c_\psi - c_\theta  s_\phi  s_\psi &  -c_\psi  s_\phi -  c_\phi  c_\theta  s_\psi &  s_\theta  s_\psi\\
    c_\theta  c_\psi  s_\phi + c_\phi  s_\psi &  c_\phi  c_\theta  c_\psi - s_\phi  s_\psi &  -c_\psi  s_\theta\\
    s_\phi  s_\theta &  c_\phi  s_\theta &  c_\theta\\
\end{bmatrix}}</script></span> For a given vector <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-308" style="width: 0.56em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.303em 1000.47em 2.371em -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-309"><span class="texatom" id="MathJax-Span-310"><span class="mrow" id="MathJax-Span-311"><span class="munderover" id="MathJax-Span-312"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-313" style="font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.992em; left: 0.002em;"><span style="height: 0em; vertical-align: 0em; width: 0.467em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-314" style="font-family: STIXGeneral-Regular;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.23em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 1.035em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mi>v</mi><mo stretchy="false">→</mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-15">\vec v</script></span> in the body frame, the corresponding vector is given by <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-315" style="width: 1.257em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.071em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.628em 1001.07em 2.696em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-316"><span class="mi" id="MathJax-Span-317" style="font-family: STIXGeneral-Italic;">R</span><span class="texatom" id="MathJax-Span-318"><span class="mrow" id="MathJax-Span-319"><span class="munderover" id="MathJax-Span-320"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-321" style="font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.992em; left: 0.002em;"><span style="height: 0em; vertical-align: 0em; width: 0.467em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-322" style="font-family: STIXGeneral-Regular;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.23em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 1.035em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>R</mi><mrow class="MJX-TeXAtom-ORD"><mover><mi>v</mi><mo stretchy="false">→</mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-16">R\vec v</script></span> in the inertial frame.</p>
<h2 id="physics" class="unnumbered">Physics</h2>
<p>In order to properly model the dynamics of the system, we need an understanding of the physical properties that govern it. We will begin with a description of the motors being used for our quadcopter, and then use energy considerations to derive the forces and thrusts that these motors produce on the entire quadcopter. All motors on the quadcopter are identical, so we can analyze a single one without loss of generality. Note that adjacent propellers, however, are oriented opposite each other; if a propeller is spinning “clockwise”, then the two adjacent ones will be spinning “counter-clockwise”, so that torques are balanced if all propellers are spinning at the same rate.</p>
<h3 id="motors" class="unnumbered">Motors</h3>
<p>Brushless motors are used for all quadcopter applications. For our electric motors, the torque produced is given by <span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-323" style="width: 6.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.623em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.721em 1005.58em 2.882em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-324"><span class="mi" id="MathJax-Span-325" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-326" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="msubsup" id="MathJax-Span-327" style="padding-left: 0.327em;"><span style="display: inline-block; position: relative; width: 0.931em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.75em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-328" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.653em;"><span class="mi" id="MathJax-Span-329" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-330" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-331" style="font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mo" id="MathJax-Span-332" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">−</span><span class="msubsup" id="MathJax-Span-333" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 0.746em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.37em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-334" style="font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.327em;"><span class="mn" id="MathJax-Span-335" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-336" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.269em; border-left: 0px solid; width: 0px; height: 1.09em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>τ</mi><mo>=</mo><msub><mi>K</mi><mi>t</mi></msub><mo stretchy="false">(</mo><mi>I</mi><mo>−</mo><msub><mi>I</mi><mn>0</mn></msub><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-17">\tau = K_t (I - I_0)</script></span> where <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-337" style="width: 0.513em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(2em 1000.42em 2.696em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-338"><span class="mi" id="MathJax-Span-339" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.601em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>τ</mi></math></span></span><script type="math/tex" id="MathJax-Element-18">\tau</script></span> is the motor torque, <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-340" style="width: 0.467em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.374em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.767em 1000.37em 2.696em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-341"><span class="mi" id="MathJax-Span-342" style="font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.872em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>I</mi></math></span></span><script type="math/tex" id="MathJax-Element-19">I</script></span> is the input current, <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-343" style="width: 0.885em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.746em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.442em 1000.75em 2.511em -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-344"><span class="msubsup" id="MathJax-Span-345"><span style="display: inline-block; position: relative; width: 0.746em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.37em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-346" style="font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.327em;"><span class="mn" id="MathJax-Span-347" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.215em; border-left: 0px solid; width: 0px; height: 1.09em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>I</mi><mn>0</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-20">I_0</script></span> is the current when there is no load on the motor, and <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-348" style="width: 1.117em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.931em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.442em 1000.93em 2.511em -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-349"><span class="msubsup" id="MathJax-Span-350"><span style="display: inline-block; position: relative; width: 0.931em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.75em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-351" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.653em;"><span class="mi" id="MathJax-Span-352" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.215em; border-left: 0px solid; width: 0px; height: 1.035em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>K</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-21">K_t</script></span> is the torque proportionality constant. The voltage across the motor is the sum of the back-EMF and some resistive loss: <span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-353" style="width: 7.667em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.552em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.767em 1006.5em 2.882em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-354"><span class="mi" id="MathJax-Span-355" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.095em;"></span></span><span class="mo" id="MathJax-Span-356" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="mi" id="MathJax-Span-357" style="font-family: STIXGeneral-Italic; padding-left: 0.327em;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="msubsup" id="MathJax-Span-358"><span style="display: inline-block; position: relative; width: 1.21em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.61em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-359" style="font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.606em;"><span class="mi" id="MathJax-Span-360" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">m</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-361" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">+</span><span class="msubsup" id="MathJax-Span-362" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 1.071em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.75em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-363" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.653em;"><span class="mi" id="MathJax-Span-364" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mi" id="MathJax-Span-365" style="font-family: STIXGeneral-Italic;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.269em; border-left: 0px solid; width: 0px; height: 1.09em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>V</mi><mo>=</mo><mi>I</mi><msub><mi>R</mi><mi>m</mi></msub><mo>+</mo><msub><mi>K</mi><mi>v</mi></msub><mi>ω</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-22">V = I R_m  + K_v \omega</script></span> where <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-366" style="width: 0.838em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.699em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.767em 1000.7em 2.696em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-367"><span class="mi" id="MathJax-Span-368" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.095em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.872em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>V</mi></math></span></span><script type="math/tex" id="MathJax-Element-23">V</script></span> is the voltage drop across the motor, <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-369" style="width: 1.442em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.21em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.442em 1001.21em 2.511em -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-370"><span class="msubsup" id="MathJax-Span-371"><span style="display: inline-block; position: relative; width: 1.21em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.61em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-372" style="font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.606em;"><span class="mi" id="MathJax-Span-373" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">m</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.215em; border-left: 0px solid; width: 0px; height: 1.035em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>R</mi><mi>m</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-24">R_m</script></span> is the motor resistance, <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-374" style="width: 0.838em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.699em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(2em 1000.65em 2.696em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-375"><span class="mi" id="MathJax-Span-376" style="font-family: STIXGeneral-Italic;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.655em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ω</mi></math></span></span><script type="math/tex" id="MathJax-Element-25">\omega</script></span> is the angular velocity of the motor, and <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-377" style="width: 1.257em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.071em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.442em 1001.07em 2.557em -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-378"><span class="msubsup" id="MathJax-Span-379"><span style="display: inline-block; position: relative; width: 1.071em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.75em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-380" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.653em;"><span class="mi" id="MathJax-Span-381" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.269em; border-left: 0px solid; width: 0px; height: 1.09em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>K</mi><mi>v</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-26">K_v</script></span> is a proportionality constant (indicating back-EMF generated per RPM). We can use this description of our motor to calculate the power it consumes. The power is <span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-382" style="width: 22.113em; display: inline-block;"><span style="display: inline-block; position: relative; width: 18.908em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.071em 1018.91em 3.672em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-383"><span class="mi" id="MathJax-Span-384" style="font-family: STIXGeneral-Italic;">P</span><span class="mo" id="MathJax-Span-385" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="mi" id="MathJax-Span-386" style="font-family: STIXGeneral-Italic; padding-left: 0.327em;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mi" id="MathJax-Span-387" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.095em;"></span></span><span class="mo" id="MathJax-Span-388" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="mfrac" id="MathJax-Span-389" style="padding-left: 0.327em;"><span style="display: inline-block; position: relative; width: 14.263em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.161em 1014.12em 4.322em -999.998em); top: -4.689em; left: 50%; margin-left: -7.058em;"><span class="mrow" id="MathJax-Span-390"><span class="mo" id="MathJax-Span-391" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-392" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-393" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">+</span><span class="msubsup" id="MathJax-Span-394" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 0.931em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.75em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-395" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.653em;"><span class="mi" id="MathJax-Span-396" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-397"><span style="display: inline-block; position: relative; width: 0.746em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.37em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-398" style="font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.327em;"><span class="mn" id="MathJax-Span-399" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-400" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-401" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-402"><span style="display: inline-block; position: relative; width: 0.931em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.75em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-403" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.653em;"><span class="mi" id="MathJax-Span-404" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-405"><span style="display: inline-block; position: relative; width: 0.746em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.37em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-406" style="font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.327em;"><span class="mn" id="MathJax-Span-407" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-408"><span style="display: inline-block; position: relative; width: 1.21em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.61em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-409" style="font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.606em;"><span class="mi" id="MathJax-Span-410" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">m</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-411" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">+</span><span class="mi" id="MathJax-Span-412" style="font-family: STIXGeneral-Italic; padding-left: 0.235em;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="msubsup" id="MathJax-Span-413"><span style="display: inline-block; position: relative; width: 1.21em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.61em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-414" style="font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.606em;"><span class="mi" id="MathJax-Span-415" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">m</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-416" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">+</span><span class="msubsup" id="MathJax-Span-417" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 0.931em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.75em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-418" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.653em;"><span class="mi" id="MathJax-Span-419" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-420"><span style="display: inline-block; position: relative; width: 1.071em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.75em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-421" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.653em;"><span class="mi" id="MathJax-Span-422" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mi" id="MathJax-Span-423" style="font-family: STIXGeneral-Italic;">ω</span><span class="mo" id="MathJax-Span-424" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.022em 1001.4em 4.276em -999.998em); top: -3.156em; left: 50%; margin-left: -0.694em;"><span class="msubsup" id="MathJax-Span-425"><span style="display: inline-block; position: relative; width: 1.396em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.93em 4.276em -999.998em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-426"><span class="mrow" id="MathJax-Span-427"><span class="msubsup" id="MathJax-Span-428"><span style="display: inline-block; position: relative; width: 0.931em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.75em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-429" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.653em;"><span class="mi" id="MathJax-Span-430" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.364em; left: 0.931em;"><span class="mn" id="MathJax-Span-431" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em 1014.26em 1.21em -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 14.263em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.193em; border-left: 0px solid; width: 0px; height: 2.829em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>P</mi><mo>=</mo><mi>I</mi><mi>V</mi><mo>=</mo><mfrac><mrow><mo stretchy="false">(</mo><mi>τ</mi><mo>+</mo><msub><mi>K</mi><mi>t</mi></msub><msub><mi>I</mi><mn>0</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msub><mi>K</mi><mi>t</mi></msub><msub><mi>I</mi><mn>0</mn></msub><msub><mi>R</mi><mi>m</mi></msub><mo>+</mo><mi>τ</mi><msub><mi>R</mi><mi>m</mi></msub><mo>+</mo><msub><mi>K</mi><mi>t</mi></msub><msub><mi>K</mi><mi>v</mi></msub><mi>ω</mi><mo stretchy="false">)</mo></mrow><msup><mrow class="MJX-TeXAtom-ORD"><msub><mi>K</mi><mi>t</mi></msub></mrow><mn>2</mn></msup></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-27">P = IV = \frac{(\tau + K_t I_0) (K_t I_0 R_m + \tau R_m + K_t K_v \omega)}{ {K_t}^2}</script></span> For the purposes of our simple model, we will assume a negligible motor resistance. Then, the power becomes proportional to the angular velocity: <span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo&gt;&amp;#x2248;&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-432" style="width: 9.432em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.038em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.071em 1008.04em 3.533em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-433"><span class="mi" id="MathJax-Span-434" style="font-family: STIXGeneral-Italic;">P</span><span class="mo" id="MathJax-Span-435" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">≈</span><span class="mfrac" id="MathJax-Span-436" style="padding-left: 0.327em;"><span style="display: inline-block; position: relative; width: 5.809em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.161em 1005.67em 4.322em -999.998em); top: -4.689em; left: 50%; margin-left: -2.831em;"><span class="mrow" id="MathJax-Span-437"><span class="mo" id="MathJax-Span-438" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-439" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-440" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">+</span><span class="msubsup" id="MathJax-Span-441" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 0.931em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.75em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-442" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.653em;"><span class="mi" id="MathJax-Span-443" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-444"><span style="display: inline-block; position: relative; width: 0.746em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.37em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-445" style="font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.327em;"><span class="mn" id="MathJax-Span-446" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-447" style="font-family: STIXGeneral-Regular;">)</span><span class="msubsup" id="MathJax-Span-448"><span style="display: inline-block; position: relative; width: 1.071em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.75em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-449" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.653em;"><span class="mi" id="MathJax-Span-450" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mi" id="MathJax-Span-451" style="font-family: STIXGeneral-Italic;">ω</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.207em 1000.93em 4.276em -999.998em); top: -3.296em; left: 50%; margin-left: -0.462em;"><span class="texatom" id="MathJax-Span-452"><span class="mrow" id="MathJax-Span-453"><span class="msubsup" id="MathJax-Span-454"><span style="display: inline-block; position: relative; width: 0.931em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.75em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-455" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.653em;"><span class="mi" id="MathJax-Span-456" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em 1005.81em 1.21em -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 5.809em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.03em; border-left: 0px solid; width: 0px; height: 2.666em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>P</mi><mo>≈</mo><mfrac><mrow><mo stretchy="false">(</mo><mi>τ</mi><mo>+</mo><msub><mi>K</mi><mi>t</mi></msub><msub><mi>I</mi><mn>0</mn></msub><mo stretchy="false">)</mo><msub><mi>K</mi><mi>v</mi></msub><mi>ω</mi></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>K</mi><mi>t</mi></msub></mrow></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-28">P \approx \frac{(\tau + K_t I_0)  K_v \omega}{ {K_t}}</script></span> Further simplifying our model, we assume that <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x226A;&lt;/mo&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-457" style="width: 4.322em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.672em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.767em 1003.67em 2.836em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-458"><span class="msubsup" id="MathJax-Span-459"><span style="display: inline-block; position: relative; width: 0.931em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.75em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-460" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.653em;"><span class="mi" id="MathJax-Span-461" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-462"><span style="display: inline-block; position: relative; width: 0.746em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.37em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-463" style="font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.327em;"><span class="mn" id="MathJax-Span-464" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-465" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">≪</span><span class="mi" id="MathJax-Span-466" style="font-family: STIXGeneral-Italic; padding-left: 0.327em;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.215em; border-left: 0px solid; width: 0px; height: 1.09em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>K</mi><mi>t</mi></msub><msub><mi>I</mi><mn>0</mn></msub><mo>≪</mo><mi>τ</mi></math></span></span><script type="math/tex" id="MathJax-Element-29">K_t I_0 \ll \tau</script></span>. This is not altogether unreasonable, since <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-467" style="width: 0.885em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.746em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.442em 1000.75em 2.511em -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-468"><span class="msubsup" id="MathJax-Span-469"><span style="display: inline-block; position: relative; width: 0.746em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.37em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-470" style="font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.327em;"><span class="mn" id="MathJax-Span-471" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.215em; border-left: 0px solid; width: 0px; height: 1.09em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>I</mi><mn>0</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-30">I_0</script></span> is the current when there is no load, and is thus rather small. In practice, this approximation holds well enough. Thus, we obtain our final, simplified equation for power: <span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo&gt;&amp;#x2248;&lt;/mo&gt;&lt;mfrac&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mfrac&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-472" style="width: 5.576em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.74em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.071em 1004.69em 3.533em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-473"><span class="mi" id="MathJax-Span-474" style="font-family: STIXGeneral-Italic;">P</span><span class="mo" id="MathJax-Span-475" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">≈</span><span class="mfrac" id="MathJax-Span-476" style="padding-left: 0.327em;"><span style="display: inline-block; position: relative; width: 1.164em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.207em 1001.07em 4.322em -999.998em); top: -4.689em; left: 50%; margin-left: -0.509em;"><span class="msubsup" id="MathJax-Span-477"><span style="display: inline-block; position: relative; width: 1.071em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.75em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-478" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.653em;"><span class="mi" id="MathJax-Span-479" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.207em 1000.93em 4.276em -999.998em); top: -3.296em; left: 50%; margin-left: -0.462em;"><span class="msubsup" id="MathJax-Span-480"><span style="display: inline-block; position: relative; width: 0.931em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.75em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-481" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.653em;"><span class="mi" id="MathJax-Span-482" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em 1001.16em 1.21em -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.164em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mi" id="MathJax-Span-483" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-484" style="font-family: STIXGeneral-Italic;">ω</span><span class="mo" id="MathJax-Span-485" style="font-family: STIXGeneral-Regular;">.</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.03em; border-left: 0px solid; width: 0px; height: 2.666em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>P</mi><mo>≈</mo><mfrac><msub><mi>K</mi><mi>v</mi></msub><msub><mi>K</mi><mi>t</mi></msub></mfrac><mi>τ</mi><mi>ω</mi><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-31">P \approx \frac{K_v}{K_t} \tau \omega.</script></span></p>
<h3 id="forces" class="unnumbered">Forces</h3>
<p>The power is used to keep the quadcopter aloft. By conservation of energy, we know that the energy the motor expends in a given time period is equal to the force generated on the propeller times the distance that the air it displaces moves (<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;d&lt;/mtext&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;/mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;d&lt;/mtext&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;/mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-486" style="width: 7.574em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.459em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.721em 1006.46em 2.696em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-487"><span class="mi" id="MathJax-Span-488" style="font-family: STIXGeneral-Italic;">P</span><span class="mo" id="MathJax-Span-489" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">⋅</span><span class="texatom" id="MathJax-Span-490" style="padding-left: 0.235em;"><span class="mrow" id="MathJax-Span-491"><span class="mtext" id="MathJax-Span-492" style="font-family: STIXGeneral-Regular;">d</span><span class="mspace" id="MathJax-Span-493" style="height: 0em; vertical-align: 0em; width: 0.327em; display: inline-block; overflow: hidden;"></span></span></span><span class="mi" id="MathJax-Span-494" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-495" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="mi" id="MathJax-Span-496" style="font-family: STIXGeneral-Italic; padding-left: 0.327em;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mo" id="MathJax-Span-497" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">⋅</span><span class="texatom" id="MathJax-Span-498" style="padding-left: 0.235em;"><span class="mrow" id="MathJax-Span-499"><span class="mtext" id="MathJax-Span-500" style="font-family: STIXGeneral-Regular;">d</span><span class="mspace" id="MathJax-Span-501" style="height: 0em; vertical-align: 0em; width: 0.327em; display: inline-block; overflow: hidden;"></span></span></span><span class="mi" id="MathJax-Span-502" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo>⋅</mo><mrow class="MJX-TeXAtom-ORD"><mtext>d</mtext><mspace width="thickmathspace"></mspace></mrow><mi>t</mi><mo>=</mo><mi>F</mi><mo>⋅</mo><mrow class="MJX-TeXAtom-ORD"><mtext>d</mtext><mspace width="thickmathspace"></mspace></mrow><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-32">P\cdot {\text{d}\;}t = F \cdot {\text{d}\;}x</script></span>). Equivalently, the <em>power</em> is equal to the thrust times the air velocity (<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;d&lt;/mtext&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;/mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;d&lt;/mtext&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;/mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-503" style="width: 4.694em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.997em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.535em 1004em 3.068em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-504"><span class="mi" id="MathJax-Span-505" style="font-family: STIXGeneral-Italic;">P</span><span class="mo" id="MathJax-Span-506" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="mi" id="MathJax-Span-507" style="font-family: STIXGeneral-Italic; padding-left: 0.327em;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mfrac" id="MathJax-Span-508"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.393em 1000.98em 4.136em -999.998em); top: -4.411em; left: 50%; margin-left: -0.509em;"><span class="mrow" id="MathJax-Span-509"><span class="texatom" id="MathJax-Span-510"><span class="mrow" id="MathJax-Span-511"><span class="mtext" id="MathJax-Span-512" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">d</span><span class="mspace" id="MathJax-Span-513" style="height: 0em; vertical-align: 0em; width: 0.327em; display: inline-block; overflow: hidden;"></span></span></span><span class="mi" id="MathJax-Span-514" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.393em 1000.88em 4.136em -999.998em); top: -3.621em; left: 50%; margin-left: -0.416em;"><span class="mrow" id="MathJax-Span-515"><span class="texatom" id="MathJax-Span-516"><span class="mrow" id="MathJax-Span-517"><span class="mtext" id="MathJax-Span-518" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">d</span><span class="mspace" id="MathJax-Span-519" style="height: 0em; vertical-align: 0em; width: 0.327em; display: inline-block; overflow: hidden;"></span></span></span><span class="mi" id="MathJax-Span-520" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em 1001.12em 1.21em -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.117em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.486em; border-left: 0px solid; width: 0px; height: 1.579em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo>=</mo><mi>F</mi><mfrac><mrow><mrow class="MJX-TeXAtom-ORD"><mtext>d</mtext><mspace width="thickmathspace"></mspace></mrow><mi>x</mi></mrow><mrow><mrow class="MJX-TeXAtom-ORD"><mtext>d</mtext><mspace width="thickmathspace"></mspace></mrow><mi>t</mi></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-33">P = F\frac{{\text{d}\;}x}{{\text{d}\;}t}</script></span>). <span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-521" style="width: 4.09em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.486em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.767em 1003.49em 2.836em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-522"><span class="mi" id="MathJax-Span-523" style="font-family: STIXGeneral-Italic;">P</span><span class="mo" id="MathJax-Span-524" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="mi" id="MathJax-Span-525" style="font-family: STIXGeneral-Italic; padding-left: 0.327em;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.095em;"></span></span><span class="msubsup" id="MathJax-Span-526"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-527" style="font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-528" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">h</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.215em; border-left: 0px solid; width: 0px; height: 1.035em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>P</mi><mo>=</mo><mi>T</mi><msub><mi>v</mi><mi>h</mi></msub></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-34">P = Tv_h</script></span> We assume vehicle speeds are low, so <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-35-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-529" style="width: 1.071em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.675em 1000.88em 2.511em -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-530"><span class="msubsup" id="MathJax-Span-531"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-532" style="font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-533" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">h</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.215em; border-left: 0px solid; width: 0px; height: 0.818em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>v</mi><mi>h</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-35">v_h</script></span> is the air velocity when hovering. We also assume that the free stream velocity, <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x221E;&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-534" style="width: 1.396em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.164em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.675em 1001.16em 2.511em -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-535"><span class="msubsup" id="MathJax-Span-536"><span style="display: inline-block; position: relative; width: 1.164em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-537" style="font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-538" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∞</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.215em; border-left: 0px solid; width: 0px; height: 0.818em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>v</mi><mi mathvariant="normal">∞</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-36">v_\infty</script></span>, is zero (the air in the surrounding environment is stationary relative to the quadcopter). Momentum theory gives us the equation for hover velocity as a function of thrust, <span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-37-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msqrt&gt;&lt;mfrac&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C1;&lt;/mi&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/msqrt&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-539" style="width: 6.273em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.344em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(0.978em 1005.34em 3.718em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-540"><span class="msubsup" id="MathJax-Span-541"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-542" style="font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-543" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">h</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-544" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="msqrt" id="MathJax-Span-545" style="padding-left: 0.327em;"><span style="display: inline-block; position: relative; width: 3.115em; height: 0px;"><span style="position: absolute; clip: rect(2.511em 1002em 5.019em -999.998em); top: -3.992em; left: 1.117em;"><span class="mrow" id="MathJax-Span-546"><span class="mfrac" id="MathJax-Span-547"><span style="display: inline-block; position: relative; width: 1.721em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.207em 1000.65em 4.136em -999.998em); top: -4.689em; left: 50%; margin-left: -0.323em;"><span class="mi" id="MathJax-Span-548" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.095em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em 1001.58em 4.322em -999.998em); top: -3.296em; left: 50%; margin-left: -0.787em;"><span class="mrow" id="MathJax-Span-549"><span class="mn" id="MathJax-Span-550" style="font-family: STIXGeneral-Regular;">2</span><span class="mi" id="MathJax-Span-551" style="font-family: STIXGeneral-Italic;">ρ</span><span class="mi" id="MathJax-Span-552" style="font-family: STIXGeneral-Italic;">A</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em 1001.72em 1.21em -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.721em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.022em 1002em 3.347em -999.998em); top: -4.55em; left: 1.117em;"><span style="display: inline-block; position: relative; width: 2em; height: 0px;"><span style="position: absolute; font-family: STIXGeneral-Regular; top: -3.992em; left: 0em;">‾<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; font-family: STIXGeneral-Regular; top: -3.992em; left: 1.489em;">‾<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.992em; left: 0.374em;">‾<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.992em; left: 0.746em;">‾<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.992em; left: 1.117em;">‾<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(1.814em 1001.16em 4.555em -999.998em); top: -3.342em; left: 0em;"><span style="font-family: STIXSizeTwoSym;">√</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 2.992em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>v</mi><mi>h</mi></msub><mo>=</mo><msqrt><mfrac><mi>T</mi><mrow><mn>2</mn><mi>ρ</mi><mi>A</mi></mrow></mfrac></msqrt></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-37">v_h = \sqrt\frac{T}{2\rho A}</script></span> where <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-38-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C1;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-553" style="width: 0.606em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.513em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(2em 1000.47em 2.882em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-554"><span class="mi" id="MathJax-Span-555" style="font-family: STIXGeneral-Italic;">ρ</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.269em; border-left: 0px solid; width: 0px; height: 0.872em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ρ</mi></math></span></span><script type="math/tex" id="MathJax-Element-38">\rho</script></span> is the density of the surrounding air and <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-39-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-556" style="width: 0.746em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.606em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.767em 1000.56em 2.696em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-557"><span class="mi" id="MathJax-Span-558" style="font-family: STIXGeneral-Italic;">A</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.872em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi></math></span></span><script type="math/tex" id="MathJax-Element-39">A</script></span> is the area swept out by the rotor. Using our simplified equation for power, we can then write <span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-40-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mfrac&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mfrac&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;msup&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mfrac&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;/msup&gt;&lt;msqrt&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C1;&lt;/mi&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;/msqrt&gt;&lt;/mfrac&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-559" style="width: 16.632em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.216em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(0.653em 1014.17em 3.904em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-560"><span class="mi" id="MathJax-Span-561" style="font-family: STIXGeneral-Italic;">P</span><span class="mo" id="MathJax-Span-562" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="mfrac" id="MathJax-Span-563" style="padding-left: 0.327em;"><span style="display: inline-block; position: relative; width: 1.164em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.207em 1001.07em 4.322em -999.998em); top: -4.689em; left: 50%; margin-left: -0.509em;"><span class="msubsup" id="MathJax-Span-564"><span style="display: inline-block; position: relative; width: 1.071em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.75em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-565" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.653em;"><span class="mi" id="MathJax-Span-566" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.207em 1000.93em 4.276em -999.998em); top: -3.296em; left: 50%; margin-left: -0.462em;"><span class="msubsup" id="MathJax-Span-567"><span style="display: inline-block; position: relative; width: 0.931em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.75em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-568" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.653em;"><span class="mi" id="MathJax-Span-569" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em 1001.16em 1.21em -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.164em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mi" id="MathJax-Span-570" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-571" style="font-family: STIXGeneral-Italic;">ω</span><span class="mo" id="MathJax-Span-572" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="mfrac" id="MathJax-Span-573" style="padding-left: 0.327em;"><span style="display: inline-block; position: relative; width: 2.232em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.207em 1002.09em 4.322em -999.998em); top: -4.689em; left: 50%; margin-left: -1.066em;"><span class="mrow" id="MathJax-Span-574"><span class="msubsup" id="MathJax-Span-575"><span style="display: inline-block; position: relative; width: 1.071em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.75em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-576" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.653em;"><span class="mi" id="MathJax-Span-577" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-578"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.75em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-579" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.653em;"><span class="mi" id="MathJax-Span-580" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.207em 1000.93em 4.276em -999.998em); top: -3.296em; left: 50%; margin-left: -0.462em;"><span class="msubsup" id="MathJax-Span-581"><span style="display: inline-block; position: relative; width: 0.931em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.75em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-582" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.653em;"><span class="mi" id="MathJax-Span-583" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em 1002.23em 1.21em -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.232em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mi" id="MathJax-Span-584" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.095em;"></span></span><span class="mi" id="MathJax-Span-585" style="font-family: STIXGeneral-Italic;">ω</span><span class="mo" id="MathJax-Span-586" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="mfrac" id="MathJax-Span-587" style="padding-left: 0.327em;"><span style="display: inline-block; position: relative; width: 2.696em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(2.789em 1001.4em 4.136em -999.998em); top: -4.689em; left: 50%; margin-left: -0.694em;"><span class="msubsup" id="MathJax-Span-588"><span style="display: inline-block; position: relative; width: 1.396em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-589" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.095em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.411em; left: 0.699em;"><span class="mfrac" id="MathJax-Span-590"><span style="display: inline-block; position: relative; width: 0.374em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.533em 1000.24em 4.136em -999.998em); top: -4.318em; left: 50%; margin-left: -0.137em;"><span class="mn" id="MathJax-Span-591" style="font-size: 50%; font-family: STIXGeneral-Regular;">3</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.533em 1000.24em 4.136em -999.998em); top: -3.667em; left: 50%; margin-left: -0.137em;"><span class="mn" id="MathJax-Span-592" style="font-size: 50%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.37em 1.21em -999.998em); top: -1.205em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.374em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(2.975em 1002.56em 4.508em -999.998em); top: -3.156em; left: 50%; margin-left: -1.298em;"><span class="msqrt" id="MathJax-Span-593"><span style="display: inline-block; position: relative; width: 2.557em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1001.58em 4.322em -999.998em); top: -3.992em; left: 0.931em;"><span class="mrow" id="MathJax-Span-594"><span class="mn" id="MathJax-Span-595" style="font-family: STIXGeneral-Regular;">2</span><span class="mi" id="MathJax-Span-596" style="font-family: STIXGeneral-Italic;">ρ</span><span class="mi" id="MathJax-Span-597" style="font-family: STIXGeneral-Italic;">A</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.022em 1001.63em 3.347em -999.998em); top: -4.039em; left: 0.931em;"><span style="display: inline-block; position: relative; width: 1.628em; height: 0px;"><span style="position: absolute; font-family: STIXGeneral-Regular; top: -3.992em; left: 0em;">‾<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; font-family: STIXGeneral-Regular; top: -3.992em; left: 1.164em;">‾<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.992em; left: 0.374em;">‾<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.992em; left: 0.746em;">‾<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(2.882em 1000.98em 4.415em -999.998em); top: -3.9em; left: 0em;"><span style="font-family: STIXGeneral-Regular;">√</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em 1002.7em 1.21em -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.696em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mo" id="MathJax-Span-598" style="font-family: STIXGeneral-Regular;">.</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.465em; border-left: 0px solid; width: 0px; height: 3.535em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>P</mi><mo>=</mo><mfrac><msub><mi>K</mi><mi>v</mi></msub><msub><mi>K</mi><mi>t</mi></msub></mfrac><mi>τ</mi><mi>ω</mi><mo>=</mo><mfrac><mrow><msub><mi>K</mi><mi>v</mi></msub><msub><mi>K</mi><mi>τ</mi></msub></mrow><msub><mi>K</mi><mi>t</mi></msub></mfrac><mi>T</mi><mi>ω</mi><mo>=</mo><mfrac><msup><mi>T</mi><mfrac><mn>3</mn><mn>2</mn></mfrac></msup><msqrt><mn>2</mn><mi>ρ</mi><mi>A</mi></msqrt></mfrac><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-40">P = \frac{K_v}{K_t} \tau \omega = \frac{K_vK_\tau}{K_t} T \omega = \frac{T^\frac{3}{2}}{\sqrt{2\rho A}}.</script></span> Note that in the general case, <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-41-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-599" style="width: 4.647em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.951em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.442em 1003.95em 2.743em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-600"><span class="mi" id="MathJax-Span-601" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-602" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="texatom" id="MathJax-Span-603" style="padding-left: 0.327em;"><span class="mrow" id="MathJax-Span-604"><span class="munderover" id="MathJax-Span-605"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-606" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.992em; left: 0.049em;"><span style="height: 0em; vertical-align: 0em; width: 0.467em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-607" style="font-family: STIXGeneral-Regular;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.23em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-608" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">×</span><span class="texatom" id="MathJax-Span-609" style="padding-left: 0.235em;"><span class="mrow" id="MathJax-Span-610"><span class="munderover" id="MathJax-Span-611"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-612" style="font-family: STIXGeneral-Italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.225em; left: 0.142em;"><span style="height: 0em; vertical-align: 0em; width: 0.467em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-613" style="font-family: STIXGeneral-Regular;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.23em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.106em; border-left: 0px solid; width: 0px; height: 1.307em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>τ</mi><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>r</mi><mo stretchy="false">→</mo></mover></mrow><mo>×</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>F</mi><mo stretchy="false">→</mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-41">\tau = \vec r \times \vec F</script></span>; in this case, the torque is proportional to the thrust <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-42-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-614" style="width: 0.792em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.767em 1000.65em 2.696em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-615"><span class="mi" id="MathJax-Span-616" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.095em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.872em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-42">T</script></span> by some constant ratio <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-43-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-617" style="width: 1.21em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.442em 1001.02em 2.511em -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-618"><span class="msubsup" id="MathJax-Span-619"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.75em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-620" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.653em;"><span class="mi" id="MathJax-Span-621" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.215em; border-left: 0px solid; width: 0px; height: 1.035em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>K</mi><mi>τ</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-43">K_\tau</script></span> determined by the blade configuration and parameters. Solving for the thrust magnitude <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-44-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-622" style="width: 0.792em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.767em 1000.65em 2.696em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-623"><span class="mi" id="MathJax-Span-624" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.095em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.872em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-44">T</script></span>, we obtain that thrust is proportional to the square of angular velocity of the motor: <span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-45-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;/msub&gt;&lt;msqrt&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C1;&lt;/mi&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;/msqrt&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mfrac&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-625" style="width: 14.82em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.637em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(0.42em 1012.64em 3.997em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-626"><span class="mi" id="MathJax-Span-627" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.095em;"></span></span><span class="mo" id="MathJax-Span-628" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="msubsup" id="MathJax-Span-629" style="padding-left: 0.327em;"><span style="display: inline-block; position: relative; width: 7.76em; height: 0px;"><span style="position: absolute; clip: rect(2.186em 1007.2em 5.53em -999.998em); top: -4.085em; left: 0em;"><span class="mrow" id="MathJax-Span-630"><span class="mo" id="MathJax-Span-631" style="vertical-align: -0.787em;"><span style="font-family: STIXSizeFourSym;">(</span></span><span class="mrow" id="MathJax-Span-632"><span class="mfrac" id="MathJax-Span-633"><span style="display: inline-block; position: relative; width: 4.787em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(2.975em 1004.65em 4.508em -999.998em); top: -4.829em; left: 50%; margin-left: -2.32em;"><span class="mrow" id="MathJax-Span-634"><span class="msubsup" id="MathJax-Span-635"><span style="display: inline-block; position: relative; width: 1.071em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.75em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-636" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.653em;"><span class="mi" id="MathJax-Span-637" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-638"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.75em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-639" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.653em;"><span class="mi" id="MathJax-Span-640" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msqrt" id="MathJax-Span-641"><span style="display: inline-block; position: relative; width: 2.557em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1001.58em 4.322em -999.998em); top: -3.992em; left: 0.931em;"><span class="mrow" id="MathJax-Span-642"><span class="mn" id="MathJax-Span-643" style="font-family: STIXGeneral-Regular;">2</span><span class="mi" id="MathJax-Span-644" style="font-family: STIXGeneral-Italic;">ρ</span><span class="mi" id="MathJax-Span-645" style="font-family: STIXGeneral-Italic;">A</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.022em 1001.63em 3.347em -999.998em); top: -4.039em; left: 0.931em;"><span style="display: inline-block; position: relative; width: 1.628em; height: 0px;"><span style="position: absolute; font-family: STIXGeneral-Regular; top: -3.992em; left: 0em;">‾<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; font-family: STIXGeneral-Regular; top: -3.992em; left: 1.164em;">‾<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.992em; left: 0.374em;">‾<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.992em; left: 0.746em;">‾<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(2.882em 1000.98em 4.415em -999.998em); top: -3.9em; left: 0em;"><span style="font-family: STIXGeneral-Regular;">√</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.207em 1000.93em 4.276em -999.998em); top: -3.296em; left: 50%; margin-left: -0.462em;"><span class="msubsup" id="MathJax-Span-646"><span style="display: inline-block; position: relative; width: 0.931em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.75em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-647" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.653em;"><span class="mi" id="MathJax-Span-648" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em 1004.79em 1.21em -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.787em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mi" id="MathJax-Span-649" style="font-family: STIXGeneral-Italic;">ω</span></span><span class="mo" id="MathJax-Span-650" style="vertical-align: -0.787em;"><span style="font-family: STIXSizeFourSym;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.09em;"></span></span><span style="position: absolute; top: -5.525em; left: 7.342em;"><span class="mn" id="MathJax-Span-651" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-652" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="mi" id="MathJax-Span-653" style="font-family: STIXGeneral-Italic; padding-left: 0.327em;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="msubsup" id="MathJax-Span-654"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-655" style="font-family: STIXGeneral-Italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.411em; left: 0.699em;"><span class="mn" id="MathJax-Span-656" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.573em; border-left: 0px solid; width: 0px; height: 3.97em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>T</mi><mo>=</mo><msup><mrow><mo>(</mo><mrow><mfrac><mrow><msub><mi>K</mi><mi>v</mi></msub><msub><mi>K</mi><mi>τ</mi></msub><msqrt><mn>2</mn><mi>ρ</mi><mi>A</mi></msqrt></mrow><msub><mi>K</mi><mi>t</mi></msub></mfrac><mi>ω</mi></mrow><mo>)</mo></mrow><mn>2</mn></msup><mo>=</mo><mi>k</mi><msup><mi>ω</mi><mn>2</mn></msup></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-45">T = \left(\frac{K_vK_\tau\sqrt{2 \rho A}}{K_t} \omega\right)^2 = k\omega^2</script></span> where <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-46-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-657" style="width: 0.56em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.721em 1000.47em 2.696em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-658"><span class="mi" id="MathJax-Span-659" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-46">k</script></span> is some appropriately dimensioned constant. Summing over all the motors, we find that the total thrust on the quadcopter (in the body frame) is given by <span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-47-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-660" style="width: 12.405em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.593em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(2.325em 1010.55em 6.598em -999.998em); top: -4.689em; left: 0em;"><span class="mrow" id="MathJax-Span-661"><span class="msubsup" id="MathJax-Span-662"><span style="display: inline-block; position: relative; width: 1.071em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-663" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.095em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.56em;"><span class="mi" id="MathJax-Span-664" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">B</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-665" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="munderover" id="MathJax-Span-666" style="padding-left: 0.327em;"><span style="display: inline-block; position: relative; width: 1.303em; height: 0px;"><span style="position: absolute; clip: rect(2.882em 1001.21em 4.601em -999.998em); top: -3.992em; left: 0em;"><span class="mo" id="MathJax-Span-667" style="font-family: STIXSizeOneSym; vertical-align: -0.509em;">∑</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.393em 1000.98em 4.229em -999.998em); top: -2.831em; left: 0.142em;"><span class="texatom" id="MathJax-Span-668"><span class="mrow" id="MathJax-Span-669"><span class="mi" id="MathJax-Span-670" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-671" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-672" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.3em 1000.33em 4.136em -999.998em); top: -5.2em; left: 0.467em;"><span class="mn" id="MathJax-Span-673" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">4</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-674" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.838em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-675" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.095em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.56em;"><span class="mi" id="MathJax-Span-676" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-677" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="mi" id="MathJax-Span-678" style="font-family: STIXGeneral-Italic; padding-left: 0.327em;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="texatom" id="MathJax-Span-679"><span class="mrow" id="MathJax-Span-680"><span class="mrow" id="MathJax-Span-681"><span class="mo" id="MathJax-Span-682" style="vertical-align: 2.232em;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.296em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.323em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.552em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.809em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.066em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mtable" id="MathJax-Span-683" style="padding-right: 0.188em; padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 2.511em; height: 0px;"><span style="position: absolute; clip: rect(2.604em 1002.51em 6.784em -999.998em); top: -4.875em; left: 0em;"><span style="display: inline-block; position: relative; width: 2.511em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.47em 4.136em -999.998em); top: -5.432em; left: 50%; margin-left: -0.23em;"><span class="mtd" id="MathJax-Span-684"><span class="mrow" id="MathJax-Span-685"><span class="mn" id="MathJax-Span-686" style="font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em 1000.47em 4.136em -999.998em); top: -3.992em; left: 50%; margin-left: -0.23em;"><span class="mtd" id="MathJax-Span-687"><span class="mrow" id="MathJax-Span-688"><span class="mn" id="MathJax-Span-689" style="font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.022em 1002.51em 4.415em -999.998em); top: -2.506em; left: 50%; margin-left: -1.252em;"><span class="mtd" id="MathJax-Span-690"><span class="mrow" id="MathJax-Span-691"><span class="mo" id="MathJax-Span-692" style="font-family: STIXGeneral-Regular; vertical-align: 0.002em;">∑</span><span class="msubsup" id="MathJax-Span-693" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.396em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.98em 4.276em -999.998em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-694"><span class="mrow" id="MathJax-Span-695"><span class="msubsup" id="MathJax-Span-696"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-697" style="font-family: STIXGeneral-Italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.699em;"><span class="mi" id="MathJax-Span-698" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.364em; left: 0.978em;"><span class="mn" id="MathJax-Span-699" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.88em;"></span></span></span></span><span class="mo" id="MathJax-Span-700" style="vertical-align: 2.232em;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.296em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.323em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.552em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.809em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.066em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span></span><span class="mo" id="MathJax-Span-701" style="font-family: STIXGeneral-Regular;">.</span></span><span style="display: inline-block; width: 0px; height: 4.694em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.117em; border-left: 0px solid; width: 0px; height: 4.785em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>T</mi><mi>B</mi></msub><mo>=</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mn>4</mn></munderover><msub><mi>T</mi><mi>i</mi></msub><mo>=</mo><mi>k</mi><mrow class="MJX-TeXAtom-ORD"><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mo>∑</mo><msup><mrow class="MJX-TeXAtom-ORD"><msub><mi>ω</mi><mi>i</mi></msub></mrow><mn>2</mn></msup></mtd></mtr></mtable><mo>]</mo></mrow></mrow><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-47">T_B = \sum_{i=1}^4 T_i = k{\begin{bmatrix}  0 \\ 0 \\ \sum {\omega_i}^2 \end{bmatrix}}.</script></span></p>
<p>In addition to the thrust force, we will model friction as a force proportional to the linear velocity in each direction. This is a highly simplified view of fluid friction, but will be sufficient for our modeling and simulation. Our global drag forces will be modeled by an additional force term <span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-48-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-702" style="width: 6.924em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.902em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(2.325em 1005.86em 6.505em -999.998em); top: -4.643em; left: 0em;"><span class="mrow" id="MathJax-Span-703"><span class="msubsup" id="MathJax-Span-704"><span style="display: inline-block; position: relative; width: 1.21em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-705" style="font-family: STIXGeneral-Italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.606em;"><span class="mi" id="MathJax-Span-706" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">D</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-707" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="texatom" id="MathJax-Span-708" style="padding-left: 0.327em;"><span class="mrow" id="MathJax-Span-709"><span class="mrow" id="MathJax-Span-710"><span class="mo" id="MathJax-Span-711" style="vertical-align: 2.186em;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.296em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.416em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.32em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.391em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mtable" id="MathJax-Span-712" style="padding-right: 0.188em; padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 2.046em; height: 0px;"><span style="position: absolute; clip: rect(2.511em 1002.05em 6.552em -999.998em); top: -4.736em; left: 0em;"><span style="display: inline-block; position: relative; width: 2.046em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1002.05em 4.276em -999.998em); top: -5.386em; left: 50%; margin-left: -1.02em;"><span class="mtd" id="MathJax-Span-713"><span class="mrow" id="MathJax-Span-714"><span class="mo" id="MathJax-Span-715" style="font-family: STIXGeneral-Regular;">−</span><span class="msubsup" id="MathJax-Span-716"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.47em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-717" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-718" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="texatom" id="MathJax-Span-719"><span class="mrow" id="MathJax-Span-720"><span class="munderover" id="MathJax-Span-721"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.47em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-722" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.254em 1000.24em 3.626em -999.998em); top: -4.039em; left: 0.095em;"><span class="mo" id="MathJax-Span-723" style="font-family: STIXGeneral-Regular;">˙</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em 1002em 4.322em -999.998em); top: -3.946em; left: 50%; margin-left: -1.02em;"><span class="mtd" id="MathJax-Span-724"><span class="mrow" id="MathJax-Span-725"><span class="mo" id="MathJax-Span-726" style="font-family: STIXGeneral-Regular;">−</span><span class="msubsup" id="MathJax-Span-727"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.47em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-728" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-729" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="texatom" id="MathJax-Span-730"><span class="mrow" id="MathJax-Span-731"><span class="munderover" id="MathJax-Span-732"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.322em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-733" style="font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.254em 1000.24em 3.626em -999.998em); top: -4.039em; left: 0.049em;"><span class="mo" id="MathJax-Span-734" style="font-family: STIXGeneral-Regular;">˙</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em 1001.95em 4.276em -999.998em); top: -2.506em; left: 50%; margin-left: -0.973em;"><span class="mtd" id="MathJax-Span-735"><span class="mrow" id="MathJax-Span-736"><span class="mo" id="MathJax-Span-737" style="font-family: STIXGeneral-Regular;">−</span><span class="msubsup" id="MathJax-Span-738"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.47em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-739" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-740" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="texatom" id="MathJax-Span-741"><span class="mrow" id="MathJax-Span-742"><span class="munderover" id="MathJax-Span-743"><span style="display: inline-block; position: relative; width: 0.374em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.37em 4.229em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-744" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.254em 1000.24em 3.626em -999.998em); top: -3.992em; left: 0.049em;"><span class="mo" id="MathJax-Span-745" style="font-family: STIXGeneral-Regular;">˙</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.74em;"></span></span></span></span><span class="mo" id="MathJax-Span-746" style="vertical-align: 2.186em;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.296em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.416em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.32em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.391em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.647em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.063em; border-left: 0px solid; width: 0px; height: 4.677em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>F</mi><mi>D</mi></msub><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mo>−</mo><msub><mi>k</mi><mi>d</mi></msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>x</mi><mo>˙</mo></mover></mrow></mtd></mtr><mtr><mtd><mo>−</mo><msub><mi>k</mi><mi>d</mi></msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo>˙</mo></mover></mrow></mtd></mtr><mtr><mtd><mo>−</mo><msub><mi>k</mi><mi>d</mi></msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>z</mi><mo>˙</mo></mover></mrow></mtd></mtr></mtable><mo>]</mo></mrow></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-48">F_D = {\begin{bmatrix} 
    -k_d\dot x \\
    -k_d\dot y \\
    -k_d\dot z \\
\end{bmatrix}}</script></span> If additional precision is desired, the constant <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-49-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-747" style="width: 1.071em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.396em 1000.88em 2.511em -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-748"><span class="msubsup" id="MathJax-Span-749"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.47em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-750" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-751" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.215em; border-left: 0px solid; width: 0px; height: 1.09em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>k</mi><mi>d</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-49">k_d</script></span> can be separated into three separate friction constants, one for each direction of motion. If we were to do this, we would want to model friction in the body frame rather than the inertial frame.</p>
<h3 id="torques" class="unnumbered">Torques</h3>
<p>Now that we have computed the forces on the quadcopter, we would also like to compute the torques. Each rotor contributes some torque about the body <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-50-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-752" style="width: 0.467em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.374em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(2em 1000.37em 2.789em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-753"><span class="mi" id="MathJax-Span-754" style="font-family: STIXGeneral-Italic;">z</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.16em; border-left: 0px solid; width: 0px; height: 0.709em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-50">z</script></span> axis. This torque is the torque required to keep the propeller spinning and providing thrust; it creates the instantaneous angular acceleration and overcomes the frictional drag forces. The drag equation from fluid dynamics gives us the frictional <em>force</em>: <span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-51-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mi&gt;&amp;#x03C1;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-755" style="width: 8.131em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.924em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.071em 1006.88em 3.393em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-756"><span class="msubsup" id="MathJax-Span-757"><span style="display: inline-block; position: relative; width: 1.21em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-758" style="font-family: STIXGeneral-Italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.606em;"><span class="mi" id="MathJax-Span-759" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">D</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-760" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="mfrac" id="MathJax-Span-761" style="padding-left: 0.327em;"><span style="display: inline-block; position: relative; width: 0.606em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.161em 1000.37em 4.136em -999.998em); top: -4.689em; left: 50%; margin-left: -0.23em;"><span class="mn" id="MathJax-Span-762" style="font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em 1000.47em 4.136em -999.998em); top: -3.296em; left: 50%; margin-left: -0.23em;"><span class="mn" id="MathJax-Span-763" style="font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.61em 1.21em -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.606em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mi" id="MathJax-Span-764" style="font-family: STIXGeneral-Italic;">ρ</span><span class="msubsup" id="MathJax-Span-765"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.7em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-766" style="font-family: STIXGeneral-Italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.653em;"><span class="mi" id="MathJax-Span-767" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">D</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mi" id="MathJax-Span-768" style="font-family: STIXGeneral-Italic;">A</span><span class="msubsup" id="MathJax-Span-769"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-770" style="font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.411em; left: 0.467em;"><span class="mn" id="MathJax-Span-771" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-772" style="font-family: STIXGeneral-Regular;">.</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.867em; border-left: 0px solid; width: 0px; height: 2.503em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>F</mi><mi>D</mi></msub><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>ρ</mi><msub><mi>C</mi><mi>D</mi></msub><mi>A</mi><msup><mi>v</mi><mn>2</mn></msup><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-51">F_D = \frac{1}{2}\rho C_D A v^2.</script></span> where <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-52-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C1;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-773" style="width: 0.606em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.513em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(2em 1000.47em 2.882em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-774"><span class="mi" id="MathJax-Span-775" style="font-family: STIXGeneral-Italic;">ρ</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.269em; border-left: 0px solid; width: 0px; height: 0.872em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ρ</mi></math></span></span><script type="math/tex" id="MathJax-Element-52">\rho</script></span> is the surrounding fluid density, <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-53-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-776" style="width: 0.746em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.606em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.767em 1000.56em 2.696em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-777"><span class="mi" id="MathJax-Span-778" style="font-family: STIXGeneral-Italic;">A</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.872em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi></math></span></span><script type="math/tex" id="MathJax-Element-53">A</script></span> is the reference area (propeller cross-section, <em>not</em> area swept out by the propeller), and <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-54-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-779" style="width: 1.489em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.442em 1001.26em 2.511em -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-780"><span class="msubsup" id="MathJax-Span-781"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.7em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-782" style="font-family: STIXGeneral-Italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.653em;"><span class="mi" id="MathJax-Span-783" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">D</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.215em; border-left: 0px solid; width: 0px; height: 1.09em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>C</mi><mi>D</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-54">C_D</script></span> is a dimensionless constant. This, while only accurate in some in some cases, is good enough for our purposes. This implies that the torque due to drag is given by <span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-55-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;&amp;#x03C1;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;&amp;#x03C1;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-784" style="width: 20.627em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.607em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.071em 1017.61em 3.393em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-785"><span class="msubsup" id="MathJax-Span-786"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-787" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.42em;"><span class="mi" id="MathJax-Span-788" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">D</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-789" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="mfrac" id="MathJax-Span-790" style="padding-left: 0.327em;"><span style="display: inline-block; position: relative; width: 0.606em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.161em 1000.37em 4.136em -999.998em); top: -4.689em; left: 50%; margin-left: -0.23em;"><span class="mn" id="MathJax-Span-791" style="font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em 1000.47em 4.136em -999.998em); top: -3.296em; left: 50%; margin-left: -0.23em;"><span class="mn" id="MathJax-Span-792" style="font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.61em 1.21em -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.606em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mi" id="MathJax-Span-793" style="font-family: STIXGeneral-Italic;">R</span><span class="mi" id="MathJax-Span-794" style="font-family: STIXGeneral-Italic;">ρ</span><span class="msubsup" id="MathJax-Span-795"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.7em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-796" style="font-family: STIXGeneral-Italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.653em;"><span class="mi" id="MathJax-Span-797" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">D</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mi" id="MathJax-Span-798" style="font-family: STIXGeneral-Italic;">A</span><span class="msubsup" id="MathJax-Span-799"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-800" style="font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.411em; left: 0.467em;"><span class="mn" id="MathJax-Span-801" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-802" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="mfrac" id="MathJax-Span-803" style="padding-left: 0.327em;"><span style="display: inline-block; position: relative; width: 0.606em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.161em 1000.37em 4.136em -999.998em); top: -4.689em; left: 50%; margin-left: -0.23em;"><span class="mn" id="MathJax-Span-804" style="font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em 1000.47em 4.136em -999.998em); top: -3.296em; left: 50%; margin-left: -0.23em;"><span class="mn" id="MathJax-Span-805" style="font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.61em 1.21em -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.606em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mi" id="MathJax-Span-806" style="font-family: STIXGeneral-Italic;">R</span><span class="mi" id="MathJax-Span-807" style="font-family: STIXGeneral-Italic;">ρ</span><span class="msubsup" id="MathJax-Span-808"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.7em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-809" style="font-family: STIXGeneral-Italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.653em;"><span class="mi" id="MathJax-Span-810" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">D</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mi" id="MathJax-Span-811" style="font-family: STIXGeneral-Italic;">A</span><span class="mo" id="MathJax-Span-812" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-813" style="font-family: STIXGeneral-Italic;">ω</span><span class="mi" id="MathJax-Span-814" style="font-family: STIXGeneral-Italic;">R</span><span class="msubsup" id="MathJax-Span-815"><span style="display: inline-block; position: relative; width: 0.746em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.28em 4.322em -999.998em); top: -3.992em; left: 0em;"><span class="mo" id="MathJax-Span-816" style="font-family: STIXGeneral-Regular;">)</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.411em; left: 0.327em;"><span class="mn" id="MathJax-Span-817" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-818" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="mi" id="MathJax-Span-819" style="font-family: STIXGeneral-Italic; padding-left: 0.327em;">b</span><span class="msubsup" id="MathJax-Span-820"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-821" style="font-family: STIXGeneral-Italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.411em; left: 0.699em;"><span class="mn" id="MathJax-Span-822" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.867em; border-left: 0px solid; width: 0px; height: 2.503em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>τ</mi><mi>D</mi></msub><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>R</mi><mi>ρ</mi><msub><mi>C</mi><mi>D</mi></msub><mi>A</mi><msup><mi>v</mi><mn>2</mn></msup><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>R</mi><mi>ρ</mi><msub><mi>C</mi><mi>D</mi></msub><mi>A</mi><mo stretchy="false">(</mo><mi>ω</mi><mi>R</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo>=</mo><mi>b</mi><msup><mi>ω</mi><mn>2</mn></msup></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-55">\tau_D = \frac{1}{2}R \rho C_D A v^2 = \frac{1}{2}R \rho C_D A (\omega R)^2 = b\omega^2</script></span> where <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-56-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-823" style="width: 0.838em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.699em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(2em 1000.65em 2.696em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-824"><span class="mi" id="MathJax-Span-825" style="font-family: STIXGeneral-Italic;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.655em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ω</mi></math></span></span><script type="math/tex" id="MathJax-Element-56">\omega</script></span> is the angular velocity of the propeller, <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-57-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-826" style="width: 0.746em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.606em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.767em 1000.61em 2.696em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-827"><span class="mi" id="MathJax-Span-828" style="font-family: STIXGeneral-Italic;">R</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.872em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>R</mi></math></span></span><script type="math/tex" id="MathJax-Element-57">R</script></span> is the radius of the propeller, and <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-58-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-829" style="width: 0.606em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.513em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.721em 1000.47em 2.696em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-830"><span class="mi" id="MathJax-Span-831" style="font-family: STIXGeneral-Italic;">b</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-58">b</script></span> is some appropriately dimensioned constant. Note that we’ve assumed that all the force is applied at the tip of the propeller, which is certainly inaccurate; however, the only result that matters for our purposes is that the drag torque is proportional to the square of the angular velocity. We can then write the complete torque about the <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-59-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-832" style="width: 0.467em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.374em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(2em 1000.37em 2.789em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-833"><span class="mi" id="MathJax-Span-834" style="font-family: STIXGeneral-Italic;">z</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.16em; border-left: 0px solid; width: 0px; height: 0.709em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-59">z</script></span> axis for the <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-60-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-835" style="width: 0.327em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.281em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.767em 1000.28em 2.696em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-836"><span class="mi" id="MathJax-Span-837" style="font-family: STIXGeneral-Italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.872em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-60">i</script></span>th motor: <span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-61-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-838" style="width: 7.667em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.552em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.535em 1006.5em 2.882em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-839"><span class="msubsup" id="MathJax-Span-840"><span style="display: inline-block; position: relative; width: 0.746em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-841" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.42em;"><span class="mi" id="MathJax-Span-842" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-843" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="mi" id="MathJax-Span-844" style="font-family: STIXGeneral-Italic; padding-left: 0.327em;">b</span><span class="msubsup" id="MathJax-Span-845"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-846" style="font-family: STIXGeneral-Italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.411em; left: 0.699em;"><span class="mn" id="MathJax-Span-847" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-848" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">+</span><span class="msubsup" id="MathJax-Span-849" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.37em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-850" style="font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.327em;"><span class="mi" id="MathJax-Span-851" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="texatom" id="MathJax-Span-852"><span class="mrow" id="MathJax-Span-853"><span class="munderover" id="MathJax-Span-854"><span style="display: inline-block; position: relative; width: 0.699em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-855" style="font-family: STIXGeneral-Italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.254em 1000.24em 3.626em -999.998em); top: -4.039em; left: 0.188em;"><span class="mo" id="MathJax-Span-856" style="font-family: STIXGeneral-Regular;">˙</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.269em; border-left: 0px solid; width: 0px; height: 1.416em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>τ</mi><mi>z</mi></msub><mo>=</mo><mi>b</mi><msup><mi>ω</mi><mn>2</mn></msup><mo>+</mo><msub><mi>I</mi><mi>M</mi></msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>ω</mi><mo>˙</mo></mover></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-61">\tau_z = b\omega^2 + I_M \dot\omega</script></span> where <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-62-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-857" style="width: 1.21em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.442em 1001.02em 2.511em -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-858"><span class="msubsup" id="MathJax-Span-859"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.37em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-860" style="font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.327em;"><span class="mi" id="MathJax-Span-861" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.215em; border-left: 0px solid; width: 0px; height: 1.035em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>I</mi><mi>M</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-62">I_M</script></span> is the moment of inertia about the motor <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-63-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-862" style="width: 0.467em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.374em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(2em 1000.37em 2.789em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-863"><span class="mi" id="MathJax-Span-864" style="font-family: STIXGeneral-Italic;">z</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.16em; border-left: 0px solid; width: 0px; height: 0.709em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-63">z</script></span> axis, <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-64-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-865" style="width: 0.838em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.699em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.442em 1000.65em 2.371em -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-866"><span class="texatom" id="MathJax-Span-867"><span class="mrow" id="MathJax-Span-868"><span class="munderover" id="MathJax-Span-869"><span style="display: inline-block; position: relative; width: 0.699em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-870" style="font-family: STIXGeneral-Italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.254em 1000.24em 3.626em -999.998em); top: -4.039em; left: 0.188em;"><span class="mo" id="MathJax-Span-871" style="font-family: STIXGeneral-Regular;">˙</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.872em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mi>ω</mi><mo>˙</mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-64">\dot\omega</script></span> is the angular acceleration of the propeller, and <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-65-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-872" style="width: 0.606em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.513em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.721em 1000.47em 2.696em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-873"><span class="mi" id="MathJax-Span-874" style="font-family: STIXGeneral-Italic;">b</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-65">b</script></span> is our drag coefficient. Note that in steady state flight (i.e. not takeoff or landing), <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-66-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2248;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-875" style="width: 3.022em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.557em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.721em 1002.51em 2.696em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-876"><span class="texatom" id="MathJax-Span-877"><span class="mrow" id="MathJax-Span-878"><span class="munderover" id="MathJax-Span-879"><span style="display: inline-block; position: relative; width: 0.699em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-880" style="font-family: STIXGeneral-Italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.254em 1000.24em 3.626em -999.998em); top: -4.039em; left: 0.188em;"><span class="mo" id="MathJax-Span-881" style="font-family: STIXGeneral-Regular;">˙</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-882" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">≈</span><span class="mn" id="MathJax-Span-883" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mi>ω</mi><mo>˙</mo></mover></mrow><mo>≈</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-66">\dot\omega \approx 0</script></span>, since most of the time the propellers will be maintaining a constant (or almost constant) thrust and won’t be accelerating. Thus, we ignore this term, simplifying the entire expression to <span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-67-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-884" style="width: 8.456em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.202em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.535em 1007.16em 2.882em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-885"><span class="msubsup" id="MathJax-Span-886"><span style="display: inline-block; position: relative; width: 0.746em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-887" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.42em;"><span class="mi" id="MathJax-Span-888" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-889" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="mo" id="MathJax-Span-890" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">(</span><span class="mo" id="MathJax-Span-891" style="font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-892" style="font-family: STIXGeneral-Regular;">1</span><span class="msubsup" id="MathJax-Span-893"><span style="display: inline-block; position: relative; width: 1.442em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.28em 4.322em -999.998em); top: -3.992em; left: 0em;"><span class="mo" id="MathJax-Span-894" style="font-family: STIXGeneral-Regular;">)</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.411em; left: 0.327em;"><span class="texatom" id="MathJax-Span-895"><span class="mrow" id="MathJax-Span-896"><span class="mi" id="MathJax-Span-897" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-898" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-899" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mi" id="MathJax-Span-900" style="font-family: STIXGeneral-Italic;">b</span><span class="msubsup" id="MathJax-Span-901"><span style="display: inline-block; position: relative; width: 1.396em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.98em 4.276em -999.998em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-902"><span class="mrow" id="MathJax-Span-903"><span class="msubsup" id="MathJax-Span-904"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-905" style="font-family: STIXGeneral-Italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.699em;"><span class="mi" id="MathJax-Span-906" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.411em; left: 0.978em;"><span class="mn" id="MathJax-Span-907" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-908" style="font-family: STIXGeneral-Regular;">.</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.269em; border-left: 0px solid; width: 0px; height: 1.416em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>τ</mi><mi>z</mi></msub><mo>=</mo><mo stretchy="false">(</mo><mo>−</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msup><mi>b</mi><msup><mrow class="MJX-TeXAtom-ORD"><msub><mi>ω</mi><mi>i</mi></msub></mrow><mn>2</mn></msup><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-67">\tau_z = (-1)^{i+1} b{\omega_i}^2.</script></span> where the <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-68-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-909" style="width: 3.486em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.975em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.582em 1002.98em 2.882em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-910"><span class="mo" id="MathJax-Span-911" style="font-family: STIXGeneral-Regular;">(</span><span class="mo" id="MathJax-Span-912" style="font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-913" style="font-family: STIXGeneral-Regular;">1</span><span class="msubsup" id="MathJax-Span-914"><span style="display: inline-block; position: relative; width: 1.442em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.28em 4.322em -999.998em); top: -3.992em; left: 0em;"><span class="mo" id="MathJax-Span-915" style="font-family: STIXGeneral-Regular;">)</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.364em; left: 0.327em;"><span class="texatom" id="MathJax-Span-916"><span class="mrow" id="MathJax-Span-917"><span class="mi" id="MathJax-Span-918" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-919" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-920" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.269em; border-left: 0px solid; width: 0px; height: 1.307em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mo>−</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-68">(-1)^{i+1}</script></span> term is positive for the <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-69-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-921" style="width: 0.327em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.281em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.767em 1000.28em 2.696em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-922"><span class="mi" id="MathJax-Span-923" style="font-family: STIXGeneral-Italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.872em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-69">i</script></span>th propeller if the propeller is spinning clockwise and negative if it is spinning counterclockwise. The total torque about the <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-70-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-924" style="width: 0.467em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.374em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(2em 1000.37em 2.789em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-925"><span class="mi" id="MathJax-Span-926" style="font-family: STIXGeneral-Italic;">z</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.16em; border-left: 0px solid; width: 0px; height: 0.709em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-70">z</script></span> axis is given by the sum of all the torques from each propeller: <span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-71-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mi&gt;&amp;#x03C8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-927" style="width: 15.842em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.52em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.953em 1013.38em 3.486em -999.998em); top: -2.971em; left: 0em;"><span class="mrow" id="MathJax-Span-928"><span class="msubsup" id="MathJax-Span-929"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-930" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.42em;"><span class="mi" id="MathJax-Span-931" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-932" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="mi" id="MathJax-Span-933" style="font-family: STIXGeneral-Italic; padding-left: 0.327em;">b</span><span class="mrow" id="MathJax-Span-934" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-935" style="vertical-align: -0.183em;"><span style="font-family: STIXSizeOneSym;">(</span></span><span class="mrow" id="MathJax-Span-936"><span class="msubsup" id="MathJax-Span-937"><span style="display: inline-block; position: relative; width: 1.535em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1001.12em 4.276em -999.998em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-938"><span class="mrow" id="MathJax-Span-939"><span class="msubsup" id="MathJax-Span-940"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-941" style="font-family: STIXGeneral-Italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.699em;"><span class="mn" id="MathJax-Span-942" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.411em; left: 1.117em;"><span class="mn" id="MathJax-Span-943" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-944" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">−</span><span class="msubsup" id="MathJax-Span-945" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 1.535em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1001.12em 4.276em -999.998em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-946"><span class="mrow" id="MathJax-Span-947"><span class="msubsup" id="MathJax-Span-948"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-949" style="font-family: STIXGeneral-Italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.699em;"><span class="mn" id="MathJax-Span-950" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.411em; left: 1.117em;"><span class="mn" id="MathJax-Span-951" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-952" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">+</span><span class="msubsup" id="MathJax-Span-953" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 1.535em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1001.12em 4.276em -999.998em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-954"><span class="mrow" id="MathJax-Span-955"><span class="msubsup" id="MathJax-Span-956"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-957" style="font-family: STIXGeneral-Italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.699em;"><span class="mn" id="MathJax-Span-958" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">3</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.411em; left: 1.117em;"><span class="mn" id="MathJax-Span-959" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-960" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">−</span><span class="msubsup" id="MathJax-Span-961" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 1.535em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1001.12em 4.276em -999.998em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-962"><span class="mrow" id="MathJax-Span-963"><span class="msubsup" id="MathJax-Span-964"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-965" style="font-family: STIXGeneral-Italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.699em;"><span class="mn" id="MathJax-Span-966" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">4</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.411em; left: 1.117em;"><span class="mn" id="MathJax-Span-967" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-968" style="vertical-align: -0.183em;"><span style="font-family: STIXSizeOneSym;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.975em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.486em; border-left: 0px solid; width: 0px; height: 1.579em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>τ</mi><mi>ψ</mi></msub><mo>=</mo><mi>b</mi><mrow><mo>(</mo><mrow><msup><mrow class="MJX-TeXAtom-ORD"><msub><mi>ω</mi><mn>1</mn></msub></mrow><mn>2</mn></msup><mo>−</mo><msup><mrow class="MJX-TeXAtom-ORD"><msub><mi>ω</mi><mn>2</mn></msub></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow class="MJX-TeXAtom-ORD"><msub><mi>ω</mi><mn>3</mn></msub></mrow><mn>2</mn></msup><mo>−</mo><msup><mrow class="MJX-TeXAtom-ORD"><msub><mi>ω</mi><mn>4</mn></msub></mrow><mn>2</mn></msup></mrow><mo>)</mo></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-71">\tau_\psi = b\left( {\omega_1}^2 -  {\omega_2}^2 +  {\omega_3}^2 -  {\omega_4}^2\right)</script></span> The roll and pitch torques are derived from standard mechanics. We can arbitrarily choose the <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-72-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-969" style="width: 2.464em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.093em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.721em 1002em 2.696em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-970"><span class="mi" id="MathJax-Span-971" style="font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-972" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="mn" id="MathJax-Span-973" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-72">i =
1</script></span> and <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-73-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-974" style="width: 2.464em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.093em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.721em 1002.05em 2.696em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-975"><span class="mi" id="MathJax-Span-976" style="font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-977" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="mn" id="MathJax-Span-978" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">3</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo>=</mo><mn>3</mn></math></span></span><script type="math/tex" id="MathJax-Element-73">i=3</script></span> motors to be on the roll axis, so <span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-74-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-979" style="width: 24.296em; display: inline-block;"><span style="display: inline-block; position: relative; width: 20.766em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.86em 1020.72em 3.579em -999.998em); top: -2.971em; left: 0em;"><span class="mrow" id="MathJax-Span-980"><span class="msubsup" id="MathJax-Span-981"><span style="display: inline-block; position: relative; width: 0.931em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-982" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.42em;"><span class="mi" id="MathJax-Span-983" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-984" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="mo" id="MathJax-Span-985" style="font-family: STIXSizeOneSym; vertical-align: -0.509em; padding-left: 0.327em;">∑</span><span class="mi" id="MathJax-Span-986" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-987" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">×</span><span class="mi" id="MathJax-Span-988" style="font-family: STIXGeneral-Italic; padding-left: 0.235em;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.095em;"></span></span><span class="mo" id="MathJax-Span-989" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="mi" id="MathJax-Span-990" style="font-family: STIXGeneral-Italic; padding-left: 0.327em;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-991" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-992" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="msubsup" id="MathJax-Span-993"><span style="display: inline-block; position: relative; width: 1.535em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1001.12em 4.276em -999.998em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-994"><span class="mrow" id="MathJax-Span-995"><span class="msubsup" id="MathJax-Span-996"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-997" style="font-family: STIXGeneral-Italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.699em;"><span class="mn" id="MathJax-Span-998" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.411em; left: 1.117em;"><span class="mn" id="MathJax-Span-999" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-1000" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">−</span><span class="mi" id="MathJax-Span-1001" style="font-family: STIXGeneral-Italic; padding-left: 0.235em;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="msubsup" id="MathJax-Span-1002"><span style="display: inline-block; position: relative; width: 1.535em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1001.12em 4.276em -999.998em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1003"><span class="mrow" id="MathJax-Span-1004"><span class="msubsup" id="MathJax-Span-1005"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1006" style="font-family: STIXGeneral-Italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.699em;"><span class="mn" id="MathJax-Span-1007" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">3</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.411em; left: 1.117em;"><span class="mn" id="MathJax-Span-1008" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-1009" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1010" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="mi" id="MathJax-Span-1011" style="font-family: STIXGeneral-Italic; padding-left: 0.327em;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1012" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1013" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-1014"><span style="display: inline-block; position: relative; width: 1.535em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1001.12em 4.276em -999.998em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1015"><span class="mrow" id="MathJax-Span-1016"><span class="msubsup" id="MathJax-Span-1017"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1018" style="font-family: STIXGeneral-Italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.699em;"><span class="mn" id="MathJax-Span-1019" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.411em; left: 1.117em;"><span class="mn" id="MathJax-Span-1020" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-1021" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">−</span><span class="msubsup" id="MathJax-Span-1022" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 1.535em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1001.12em 4.276em -999.998em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1023"><span class="mrow" id="MathJax-Span-1024"><span class="msubsup" id="MathJax-Span-1025"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1026" style="font-family: STIXGeneral-Italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.699em;"><span class="mn" id="MathJax-Span-1027" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">3</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.411em; left: 1.117em;"><span class="mn" id="MathJax-Span-1028" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-1029" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.975em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.595em; border-left: 0px solid; width: 0px; height: 1.796em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>τ</mi><mi>ϕ</mi></msub><mo>=</mo><mo>∑</mo><mi>r</mi><mo>×</mo><mi>T</mi><mo>=</mo><mi>L</mi><mo stretchy="false">(</mo><mi>k</mi><msup><mrow class="MJX-TeXAtom-ORD"><msub><mi>ω</mi><mn>1</mn></msub></mrow><mn>2</mn></msup><mo>−</mo><mi>k</mi><msup><mrow class="MJX-TeXAtom-ORD"><msub><mi>ω</mi><mn>3</mn></msub></mrow><mn>2</mn></msup><mo stretchy="false">)</mo><mo>=</mo><mi>L</mi><mi>k</mi><mo stretchy="false">(</mo><msup><mrow class="MJX-TeXAtom-ORD"><msub><mi>ω</mi><mn>1</mn></msub></mrow><mn>2</mn></msup><mo>−</mo><msup><mrow class="MJX-TeXAtom-ORD"><msub><mi>ω</mi><mn>3</mn></msub></mrow><mn>2</mn></msup><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-74">\tau_\phi = \sum r\times T = L(k{\omega_1}^2 - k{\omega_3}^2) = Lk({\omega_1}^2 - {\omega_3}^2)</script></span> Correspondingly, the pitch torque is given by a similar expression <span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-75-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1030" style="width: 9.432em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.038em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.535em 1007.99em 2.882em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-1031"><span class="msubsup" id="MathJax-Span-1032"><span style="display: inline-block; position: relative; width: 0.838em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1033" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.42em;"><span class="mi" id="MathJax-Span-1034" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-1035" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="mi" id="MathJax-Span-1036" style="font-family: STIXGeneral-Italic; padding-left: 0.327em;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1037" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1038" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-1039"><span style="display: inline-block; position: relative; width: 1.535em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1001.12em 4.276em -999.998em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1040"><span class="mrow" id="MathJax-Span-1041"><span class="msubsup" id="MathJax-Span-1042"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1043" style="font-family: STIXGeneral-Italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.699em;"><span class="mn" id="MathJax-Span-1044" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.411em; left: 1.117em;"><span class="mn" id="MathJax-Span-1045" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-1046" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">−</span><span class="msubsup" id="MathJax-Span-1047" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 1.535em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1001.12em 4.276em -999.998em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1048"><span class="mrow" id="MathJax-Span-1049"><span class="msubsup" id="MathJax-Span-1050"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1051" style="font-family: STIXGeneral-Italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.699em;"><span class="mn" id="MathJax-Span-1052" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">4</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.411em; left: 1.117em;"><span class="mn" id="MathJax-Span-1053" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-1054" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.269em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>τ</mi><mi>θ</mi></msub><mo>=</mo><mi>L</mi><mi>k</mi><mo stretchy="false">(</mo><msup><mrow class="MJX-TeXAtom-ORD"><msub><mi>ω</mi><mn>2</mn></msub></mrow><mn>2</mn></msup><mo>−</mo><msup><mrow class="MJX-TeXAtom-ORD"><msub><mi>ω</mi><mn>4</mn></msub></mrow><mn>2</mn></msup><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-75">\tau_\theta = Lk({\omega_2}^2 - {\omega_4}^2)</script></span> where <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-76-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1055" style="width: 0.653em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.56em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.767em 1000.56em 2.696em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-1056"><span class="mi" id="MathJax-Span-1057" style="font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.872em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi></math></span></span><script type="math/tex" id="MathJax-Element-76">L</script></span> is the distance from the center of the quadcopter to any of the propellers. All together, we find that the torques in the body frame are <span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-77-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1058" style="width: 17.375em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.82em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(2.325em 1014.77em 6.831em -999.998em); top: -4.829em; left: 0em;"><span class="mrow" id="MathJax-Span-1059"><span class="msubsup" id="MathJax-Span-1060"><span style="display: inline-block; position: relative; width: 0.931em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1061" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.42em;"><span class="mi" id="MathJax-Span-1062" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">B</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-1063" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="texatom" id="MathJax-Span-1064" style="padding-left: 0.327em;"><span class="mrow" id="MathJax-Span-1065"><span class="mrow" id="MathJax-Span-1066"><span class="mo" id="MathJax-Span-1067" style="vertical-align: 2.371em;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.296em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.091em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.506em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.716em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -0.88em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mtable" id="MathJax-Span-1068" style="padding-right: 0.188em; padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 11.243em; height: 0px;"><span style="position: absolute; clip: rect(2.696em 1011.1em 7.202em -999.998em); top: -5.2em; left: 0em;"><span style="display: inline-block; position: relative; width: 11.243em; height: 0px;"><span style="position: absolute; clip: rect(3.022em 1005.9em 4.322em -999.998em); top: -5.525em; left: 50%; margin-left: -2.971em;"><span class="mtd" id="MathJax-Span-1069"><span class="mrow" id="MathJax-Span-1070"><span class="mi" id="MathJax-Span-1071" style="font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1072" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1073" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-1074"><span style="display: inline-block; position: relative; width: 1.535em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1001.12em 4.276em -999.998em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1075"><span class="mrow" id="MathJax-Span-1076"><span class="msubsup" id="MathJax-Span-1077"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1078" style="font-family: STIXGeneral-Italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.699em;"><span class="mn" id="MathJax-Span-1079" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.364em; left: 1.117em;"><span class="mn" id="MathJax-Span-1080" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-1081" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">−</span><span class="msubsup" id="MathJax-Span-1082" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 1.535em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1001.12em 4.276em -999.998em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1083"><span class="mrow" id="MathJax-Span-1084"><span class="msubsup" id="MathJax-Span-1085"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1086" style="font-family: STIXGeneral-Italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.699em;"><span class="mn" id="MathJax-Span-1087" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">3</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.364em; left: 1.117em;"><span class="mn" id="MathJax-Span-1088" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-1089" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.022em 1005.9em 4.322em -999.998em); top: -4.039em; left: 50%; margin-left: -2.971em;"><span class="mtd" id="MathJax-Span-1090"><span class="mrow" id="MathJax-Span-1091"><span class="mi" id="MathJax-Span-1092" style="font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1093" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1094" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-1095"><span style="display: inline-block; position: relative; width: 1.535em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1001.12em 4.276em -999.998em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1096"><span class="mrow" id="MathJax-Span-1097"><span class="msubsup" id="MathJax-Span-1098"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1099" style="font-family: STIXGeneral-Italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.699em;"><span class="mn" id="MathJax-Span-1100" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.364em; left: 1.117em;"><span class="mn" id="MathJax-Span-1101" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-1102" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">−</span><span class="msubsup" id="MathJax-Span-1103" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 1.535em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1001.12em 4.276em -999.998em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1104"><span class="mrow" id="MathJax-Span-1105"><span class="msubsup" id="MathJax-Span-1106"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1107" style="font-family: STIXGeneral-Italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.699em;"><span class="mn" id="MathJax-Span-1108" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">4</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.364em; left: 1.117em;"><span class="mn" id="MathJax-Span-1109" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-1110" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(2.975em 1011.1em 4.508em -999.998em); top: -2.506em; left: 50%; margin-left: -5.618em;"><span class="mtd" id="MathJax-Span-1111"><span class="mrow" id="MathJax-Span-1112"><span class="mi" id="MathJax-Span-1113" style="font-family: STIXGeneral-Italic;">b</span><span class="mrow" id="MathJax-Span-1114" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-1115" style="vertical-align: -0.183em;"><span style="font-family: STIXSizeOneSym;">(</span></span><span class="mrow" id="MathJax-Span-1116"><span class="msubsup" id="MathJax-Span-1117"><span style="display: inline-block; position: relative; width: 1.535em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1001.12em 4.276em -999.998em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1118"><span class="mrow" id="MathJax-Span-1119"><span class="msubsup" id="MathJax-Span-1120"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1121" style="font-family: STIXGeneral-Italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.699em;"><span class="mn" id="MathJax-Span-1122" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.364em; left: 1.117em;"><span class="mn" id="MathJax-Span-1123" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-1124" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">−</span><span class="msubsup" id="MathJax-Span-1125" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 1.535em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1001.12em 4.276em -999.998em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1126"><span class="mrow" id="MathJax-Span-1127"><span class="msubsup" id="MathJax-Span-1128"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1129" style="font-family: STIXGeneral-Italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.699em;"><span class="mn" id="MathJax-Span-1130" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.364em; left: 1.117em;"><span class="mn" id="MathJax-Span-1131" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-1132" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">+</span><span class="msubsup" id="MathJax-Span-1133" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 1.535em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1001.12em 4.276em -999.998em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1134"><span class="mrow" id="MathJax-Span-1135"><span class="msubsup" id="MathJax-Span-1136"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1137" style="font-family: STIXGeneral-Italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.699em;"><span class="mn" id="MathJax-Span-1138" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">3</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.364em; left: 1.117em;"><span class="mn" id="MathJax-Span-1139" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-1140" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">−</span><span class="msubsup" id="MathJax-Span-1141" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 1.535em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1001.12em 4.276em -999.998em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1142"><span class="mrow" id="MathJax-Span-1143"><span class="msubsup" id="MathJax-Span-1144"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1145" style="font-family: STIXGeneral-Italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.699em;"><span class="mn" id="MathJax-Span-1146" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">4</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.364em; left: 1.117em;"><span class="mn" id="MathJax-Span-1147" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-1148" style="vertical-align: -0.183em;"><span style="font-family: STIXSizeOneSym;">)</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.205em;"></span></span></span></span><span class="mo" id="MathJax-Span-1149" style="vertical-align: 2.371em;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.296em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.091em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.506em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.716em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -0.88em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.833em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.226em; border-left: 0px solid; width: 0px; height: 5.057em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>τ</mi><mi>B</mi></msub><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mi>L</mi><mi>k</mi><mo stretchy="false">(</mo><msup><mrow class="MJX-TeXAtom-ORD"><msub><mi>ω</mi><mn>1</mn></msub></mrow><mn>2</mn></msup><mo>−</mo><msup><mrow class="MJX-TeXAtom-ORD"><msub><mi>ω</mi><mn>3</mn></msub></mrow><mn>2</mn></msup><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mi>L</mi><mi>k</mi><mo stretchy="false">(</mo><msup><mrow class="MJX-TeXAtom-ORD"><msub><mi>ω</mi><mn>2</mn></msub></mrow><mn>2</mn></msup><mo>−</mo><msup><mrow class="MJX-TeXAtom-ORD"><msub><mi>ω</mi><mn>4</mn></msub></mrow><mn>2</mn></msup><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mi>b</mi><mrow><mo>(</mo><mrow><msup><mrow class="MJX-TeXAtom-ORD"><msub><mi>ω</mi><mn>1</mn></msub></mrow><mn>2</mn></msup><mo>−</mo><msup><mrow class="MJX-TeXAtom-ORD"><msub><mi>ω</mi><mn>2</mn></msub></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow class="MJX-TeXAtom-ORD"><msub><mi>ω</mi><mn>3</mn></msub></mrow><mn>2</mn></msup><mo>−</mo><msup><mrow class="MJX-TeXAtom-ORD"><msub><mi>ω</mi><mn>4</mn></msub></mrow><mn>2</mn></msup></mrow><mo>)</mo></mrow></mtd></mtr></mtable><mo>]</mo></mrow></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-77">\tau_B = {\begin{bmatrix} 
    Lk({\omega_1}^2 - {\omega_3}^2) \\
    Lk({\omega_2}^2 - {\omega_4}^2) \\
    b\left( {\omega_1}^2 -  {\omega_2}^2 +  {\omega_3}^2 -  {\omega_4}^2\right)
\end{bmatrix}}</script></span></p>
<p>The model we’ve derived so far is highly simplified. We ignore a multitude of advanced effects that contribute to the highly nonlinear dynamics of a quadcopter. We ignore rotational drag forces (our rotational velocities are relatively low), blade flapping (deformation of propeller blades due to high velocities and flexible materials), surrounding fluid velocities (wind), etc. With that said, we now have all the parts necessary to write out the dynamics of our quadcopter.</p>
<h3 id="equations-of-motion" class="unnumbered">Equations of Motion</h3>
<p>In the inertial frame, the acceleration of the quadcopter is due to thrust, gravity, and linear friction. We can obtain the thrust vector in the inertial frame by using our rotation matrix <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-78-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1150" style="width: 0.746em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.606em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.767em 1000.61em 2.696em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-1151"><span class="mi" id="MathJax-Span-1152" style="font-family: STIXGeneral-Italic;">R</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.872em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>R</mi></math></span></span><script type="math/tex" id="MathJax-Element-78">R</script></span> to map the thrust vector from the body frame to the inertial frame. Thus, the linear motion can be summarized as <span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-79-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x00A8;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1153" style="width: 12.776em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.918em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(2.325em 1010.92em 6.505em -999.998em); top: -4.643em; left: 0em;"><span class="mrow" id="MathJax-Span-1154"><span class="mi" id="MathJax-Span-1155" style="font-family: STIXGeneral-Italic;">m</span><span class="texatom" id="MathJax-Span-1156"><span class="mrow" id="MathJax-Span-1157"><span class="munderover" id="MathJax-Span-1158"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.47em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1159" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.254em 1000.33em 3.626em -999.998em); top: -4.039em; left: 0.095em;"><span class="mo" id="MathJax-Span-1160" style="font-family: STIXGeneral-Regular;">¨</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-1161" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="texatom" id="MathJax-Span-1162" style="padding-left: 0.327em;"><span class="mrow" id="MathJax-Span-1163"><span class="mrow" id="MathJax-Span-1164"><span class="mo" id="MathJax-Span-1165" style="vertical-align: 2.186em;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.296em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.416em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.32em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.391em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mtable" id="MathJax-Span-1166" style="padding-right: 0.188em; padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.907em; height: 0px;"><span style="position: absolute; clip: rect(2.557em 1001.86em 6.645em -999.998em); top: -4.782em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.907em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.47em 4.136em -999.998em); top: -5.386em; left: 50%; margin-left: -0.23em;"><span class="mtd" id="MathJax-Span-1167"><span class="mrow" id="MathJax-Span-1168"><span class="mn" id="MathJax-Span-1169" style="font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em 1000.47em 4.136em -999.998em); top: -3.946em; left: 50%; margin-left: -0.23em;"><span class="mtd" id="MathJax-Span-1170"><span class="mrow" id="MathJax-Span-1171"><span class="mn" id="MathJax-Span-1172" style="font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.3em 1001.86em 4.322em -999.998em); top: -2.506em; left: 50%; margin-left: -0.973em;"><span class="mtd" id="MathJax-Span-1173"><span class="mrow" id="MathJax-Span-1174"><span class="mo" id="MathJax-Span-1175" style="font-family: STIXGeneral-Regular;">−</span><span class="mi" id="MathJax-Span-1176" style="font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-1177" style="font-family: STIXGeneral-Italic;">g</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.787em;"></span></span></span></span><span class="mo" id="MathJax-Span-1178" style="vertical-align: 2.186em;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.296em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.416em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.32em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.391em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span></span><span class="mo" id="MathJax-Span-1179" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">+</span><span class="mi" id="MathJax-Span-1180" style="font-family: STIXGeneral-Italic; padding-left: 0.235em;">R</span><span class="msubsup" id="MathJax-Span-1181"><span style="display: inline-block; position: relative; width: 1.071em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1182" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.095em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.56em;"><span class="mi" id="MathJax-Span-1183" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">B</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-1184" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">+</span><span class="msubsup" id="MathJax-Span-1185" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 1.21em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1186" style="font-family: STIXGeneral-Italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.606em;"><span class="mi" id="MathJax-Span-1187" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">D</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.647em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.063em; border-left: 0px solid; width: 0px; height: 4.677em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>m</mi><mrow class="MJX-TeXAtom-ORD"><mover><mi>x</mi><mo>¨</mo></mover></mrow><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mo>−</mo><mi>m</mi><mi>g</mi></mtd></mtr></mtable><mo>]</mo></mrow></mrow><mo>+</mo><mi>R</mi><msub><mi>T</mi><mi>B</mi></msub><mo>+</mo><msub><mi>F</mi><mi>D</mi></msub></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-79">m\ddot{x} = {\begin{bmatrix} 0 \\ 0 \\ -mg\end{bmatrix}} + RT_B + F_D</script></span> where <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-80-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1188" style="width: 0.56em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.303em 1000.47em 2.371em -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-1189"><span class="texatom" id="MathJax-Span-1190"><span class="mrow" id="MathJax-Span-1191"><span class="munderover" id="MathJax-Span-1192"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.47em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1193" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.992em; left: 0.049em;"><span style="height: 0em; vertical-align: 0em; width: 0.467em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-1194" style="font-family: STIXGeneral-Regular;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.23em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 1.035em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mi>x</mi><mo stretchy="false">→</mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-80">\vec x</script></span> is the position of the quadcopter, <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-81-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1195" style="width: 0.606em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.513em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(2em 1000.47em 2.882em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-1196"><span class="mi" id="MathJax-Span-1197" style="font-family: STIXGeneral-Italic;">g</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.269em; border-left: 0px solid; width: 0px; height: 0.872em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi></math></span></span><script type="math/tex" id="MathJax-Element-81">g</script></span> is the acceleration due to gravity, <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-82-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1198" style="width: 1.442em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.21em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.442em 1001.21em 2.511em -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-1199"><span class="msubsup" id="MathJax-Span-1200"><span style="display: inline-block; position: relative; width: 1.21em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1201" style="font-family: STIXGeneral-Italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.606em;"><span class="mi" id="MathJax-Span-1202" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">D</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.215em; border-left: 0px solid; width: 0px; height: 1.035em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>F</mi><mi>D</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-82">F_D</script></span> is the drag force, and <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-83-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1203" style="width: 1.257em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.071em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.442em 1001.07em 2.511em -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-1204"><span class="msubsup" id="MathJax-Span-1205"><span style="display: inline-block; position: relative; width: 1.071em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1206" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.095em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.56em;"><span class="mi" id="MathJax-Span-1207" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">B</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.215em; border-left: 0px solid; width: 0px; height: 1.035em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mi>B</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-83">T_B</script></span> is the thrust vector in the body frame. While it is convenient to have the linear equations of motion in the inertial frame, the rotational equations of motion are useful to us in the body frame, so that we can express rotations about the center of the quadcopter instead of about our inertial center. We derive the rotational equations of motion from Euler’s equations for rigid body dynamics. Expressed in vector form, Euler’s equations are written as <span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-84-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1208" style="width: 8.782em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.481em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.721em 1007.48em 2.882em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-1209"><span class="mi" id="MathJax-Span-1210" style="font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="texatom" id="MathJax-Span-1211"><span class="mrow" id="MathJax-Span-1212"><span class="munderover" id="MathJax-Span-1213"><span style="display: inline-block; position: relative; width: 0.699em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1214" style="font-family: STIXGeneral-Italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.254em 1000.24em 3.626em -999.998em); top: -4.039em; left: 0.188em;"><span class="mo" id="MathJax-Span-1215" style="font-family: STIXGeneral-Regular;">˙</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-1216" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">+</span><span class="mi" id="MathJax-Span-1217" style="font-family: STIXGeneral-Italic; padding-left: 0.235em;">ω</span><span class="mo" id="MathJax-Span-1218" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">×</span><span class="mo" id="MathJax-Span-1219" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">(</span><span class="mi" id="MathJax-Span-1220" style="font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mi" id="MathJax-Span-1221" style="font-family: STIXGeneral-Italic;">ω</span><span class="mo" id="MathJax-Span-1222" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1223" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="mi" id="MathJax-Span-1224" style="font-family: STIXGeneral-Italic; padding-left: 0.327em;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.269em; border-left: 0px solid; width: 0px; height: 1.09em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mover><mi>ω</mi><mo>˙</mo></mover></mrow><mo>+</mo><mi>ω</mi><mo>×</mo><mo stretchy="false">(</mo><mi>I</mi><mi>ω</mi><mo stretchy="false">)</mo><mo>=</mo><mi>τ</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-84">I\dot\omega + \omega\times (I\omega) = \tau</script></span> where <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-85-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1225" style="width: 0.838em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.699em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(2em 1000.65em 2.696em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-1226"><span class="mi" id="MathJax-Span-1227" style="font-family: STIXGeneral-Italic;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.655em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ω</mi></math></span></span><script type="math/tex" id="MathJax-Element-85">\omega</script></span> is the angular velocity vector, <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-86-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1228" style="width: 0.467em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.374em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.767em 1000.37em 2.696em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-1229"><span class="mi" id="MathJax-Span-1230" style="font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.872em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>I</mi></math></span></span><script type="math/tex" id="MathJax-Element-86">I</script></span> is the inertia matrix, and <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-87-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1231" style="width: 0.513em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(2em 1000.42em 2.696em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-1232"><span class="mi" id="MathJax-Span-1233" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.601em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>τ</mi></math></span></span><script type="math/tex" id="MathJax-Element-87">\tau</script></span> is a vector of external torques. We can rewrite this as <span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-88-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1234" style="width: 15.796em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.473em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(2.325em 1013.43em 6.598em -999.998em); top: -4.689em; left: 0em;"><span class="mrow" id="MathJax-Span-1235"><span class="texatom" id="MathJax-Span-1236"><span class="mrow" id="MathJax-Span-1237"><span class="munderover" id="MathJax-Span-1238"><span style="display: inline-block; position: relative; width: 0.699em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1239" style="font-family: STIXGeneral-Italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.254em 1000.24em 3.626em -999.998em); top: -4.039em; left: 0.188em;"><span class="mo" id="MathJax-Span-1240" style="font-family: STIXGeneral-Regular;">˙</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-1241" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="texatom" id="MathJax-Span-1242" style="padding-left: 0.327em;"><span class="mrow" id="MathJax-Span-1243"><span class="mrow" id="MathJax-Span-1244"><span class="mo" id="MathJax-Span-1245" style="vertical-align: 2.232em;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.296em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.323em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.552em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.809em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.066em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mtable" id="MathJax-Span-1246" style="padding-right: 0.188em; padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.071em; height: 0px;"><span style="position: absolute; clip: rect(2.65em 1001.07em 6.784em -999.998em); top: -4.875em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.071em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1001.07em 4.276em -999.998em); top: -5.432em; left: 50%; margin-left: -0.555em;"><span class="mtd" id="MathJax-Span-1247"><span class="mrow" id="MathJax-Span-1248"><span class="msubsup" id="MathJax-Span-1249"><span style="display: inline-block; position: relative; width: 1.071em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1250"><span class="mrow" id="MathJax-Span-1251"><span class="munderover" id="MathJax-Span-1252"><span style="display: inline-block; position: relative; width: 0.699em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1253" style="font-family: STIXGeneral-Italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.254em 1000.24em 3.626em -999.998em); top: -4.039em; left: 0.188em;"><span class="mo" id="MathJax-Span-1254" style="font-family: STIXGeneral-Regular;">˙</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.699em;"><span class="mi" id="MathJax-Span-1255" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.207em 1001.07em 4.415em -999.998em); top: -3.992em; left: 50%; margin-left: -0.555em;"><span class="mtd" id="MathJax-Span-1256"><span class="mrow" id="MathJax-Span-1257"><span class="msubsup" id="MathJax-Span-1258"><span style="display: inline-block; position: relative; width: 1.071em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1259"><span class="mrow" id="MathJax-Span-1260"><span class="munderover" id="MathJax-Span-1261"><span style="display: inline-block; position: relative; width: 0.699em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1262" style="font-family: STIXGeneral-Italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.254em 1000.24em 3.626em -999.998em); top: -4.039em; left: 0.188em;"><span class="mo" id="MathJax-Span-1263" style="font-family: STIXGeneral-Regular;">˙</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.699em;"><span class="mi" id="MathJax-Span-1264" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.207em 1001.02em 4.322em -999.998em); top: -2.46em; left: 50%; margin-left: -0.509em;"><span class="mtd" id="MathJax-Span-1265"><span class="mrow" id="MathJax-Span-1266"><span class="msubsup" id="MathJax-Span-1267"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1268"><span class="mrow" id="MathJax-Span-1269"><span class="munderover" id="MathJax-Span-1270"><span style="display: inline-block; position: relative; width: 0.699em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1271" style="font-family: STIXGeneral-Italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.254em 1000.24em 3.626em -999.998em); top: -4.039em; left: 0.188em;"><span class="mo" id="MathJax-Span-1272" style="font-family: STIXGeneral-Regular;">˙</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.699em;"><span class="mi" id="MathJax-Span-1273" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.88em;"></span></span></span></span><span class="mo" id="MathJax-Span-1274" style="vertical-align: 2.232em;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.296em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.323em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.552em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.809em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.066em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span></span><span class="mo" id="MathJax-Span-1275" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="msubsup" id="MathJax-Span-1276" style="padding-left: 0.327em;"><span style="display: inline-block; position: relative; width: 1.349em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.37em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1277" style="font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.411em; left: 0.467em;"><span class="texatom" id="MathJax-Span-1278"><span class="mrow" id="MathJax-Span-1279"><span class="mo" id="MathJax-Span-1280" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-1281" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mrow" id="MathJax-Span-1282" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-1283" style="font-family: STIXGeneral-Regular;">(</span><span class="mrow" id="MathJax-Span-1284"><span class="mi" id="MathJax-Span-1285" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1286" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">−</span><span class="mi" id="MathJax-Span-1287" style="font-family: STIXGeneral-Italic; padding-left: 0.235em;">ω</span><span class="mo" id="MathJax-Span-1288" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">×</span><span class="mo" id="MathJax-Span-1289" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">(</span><span class="mi" id="MathJax-Span-1290" style="font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mi" id="MathJax-Span-1291" style="font-family: STIXGeneral-Italic;">ω</span><span class="mo" id="MathJax-Span-1292" style="font-family: STIXGeneral-Regular;">)</span></span><span class="mo" id="MathJax-Span-1293" style="font-family: STIXGeneral-Regular;">)</span></span><span class="mo" id="MathJax-Span-1294" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">.</span></span><span style="display: inline-block; width: 0px; height: 4.694em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.117em; border-left: 0px solid; width: 0px; height: 4.785em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mover><mi>ω</mi><mo>˙</mo></mover></mrow><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>ω</mi><mo>˙</mo></mover></mrow><mi>x</mi></msub></mtd></mtr><mtr><mtd><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>ω</mi><mo>˙</mo></mover></mrow><mi>y</mi></msub></mtd></mtr><mtr><mtd><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>ω</mi><mo>˙</mo></mover></mrow><mi>z</mi></msub></mtd></mtr></mtable><mo>]</mo></mrow></mrow><mo>=</mo><msup><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup><mrow><mo>(</mo><mrow><mi>τ</mi><mo>−</mo><mi>ω</mi><mo>×</mo><mo stretchy="false">(</mo><mi>I</mi><mi>ω</mi><mo stretchy="false">)</mo></mrow><mo>)</mo></mrow><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-88">\dot\omega = {\begin{bmatrix} \dot \omega_x \\ \dot \omega_y \\ \dot \omega_z\end{bmatrix}} = I^{-1}\left(\tau - \omega\times (I\omega)\right).</script></span> We can model our quadcopter as two thin uniform rods crossed at the origin with a point mass (motor) at the end of each. With this in mind, it’s clear that the symmetries result in a diagonal inertia matrix of the form <span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-89-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1295" style="width: 10.036em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.549em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(2.325em 1008.5em 6.598em -999.998em); top: -4.689em; left: 0em;"><span class="mrow" id="MathJax-Span-1296"><span class="mi" id="MathJax-Span-1297" style="font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mo" id="MathJax-Span-1298" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="texatom" id="MathJax-Span-1299" style="padding-left: 0.327em;"><span class="mrow" id="MathJax-Span-1300"><span class="mrow" id="MathJax-Span-1301"><span class="mo" id="MathJax-Span-1302" style="vertical-align: 2.232em;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.296em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.323em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.552em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.809em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.066em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mtable" id="MathJax-Span-1303" style="padding-right: 0.188em; padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 5.298em; height: 0px;"><span style="position: absolute; clip: rect(2.418em 1001.02em 6.366em -999.998em); top: -4.643em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1001.02em 4.276em -999.998em); top: -5.432em; left: 50%; margin-left: -0.509em;"><span class="mtd" id="MathJax-Span-1304"><span class="mrow" id="MathJax-Span-1305"><span class="msubsup" id="MathJax-Span-1306"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.37em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1307" style="font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.327em;"><span class="texatom" id="MathJax-Span-1308"><span class="mrow" id="MathJax-Span-1309"><span class="mi" id="MathJax-Span-1310" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1311" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em 1000.47em 4.136em -999.998em); top: -3.992em; left: 50%; margin-left: -0.23em;"><span class="mtd" id="MathJax-Span-1318"><span class="mrow" id="MathJax-Span-1319"><span class="mn" id="MathJax-Span-1320" style="font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em 1000.47em 4.136em -999.998em); top: -2.46em; left: 50%; margin-left: -0.23em;"><span class="mtd" id="MathJax-Span-1332"><span class="mrow" id="MathJax-Span-1333"><span class="mn" id="MathJax-Span-1334" style="font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.647em;"></span></span><span style="position: absolute; clip: rect(2.418em 1001.02em 6.413em -999.998em); top: -4.689em; left: 2.186em;"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.47em 4.136em -999.998em); top: -5.432em; left: 50%; margin-left: -0.23em;"><span class="mtd" id="MathJax-Span-1312"><span class="mrow" id="MathJax-Span-1313"><span class="mn" id="MathJax-Span-1314" style="font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.207em 1001.02em 4.415em -999.998em); top: -3.992em; left: 50%; margin-left: -0.509em;"><span class="mtd" id="MathJax-Span-1321"><span class="mrow" id="MathJax-Span-1322"><span class="msubsup" id="MathJax-Span-1323"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.37em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1324" style="font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.327em;"><span class="texatom" id="MathJax-Span-1325"><span class="mrow" id="MathJax-Span-1326"><span class="mi" id="MathJax-Span-1327" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">y</span><span class="mi" id="MathJax-Span-1328" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">y</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em 1000.47em 4.136em -999.998em); top: -2.46em; left: 50%; margin-left: -0.23em;"><span class="mtd" id="MathJax-Span-1335"><span class="mrow" id="MathJax-Span-1336"><span class="mn" id="MathJax-Span-1337" style="font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.694em;"></span></span><span style="position: absolute; clip: rect(2.604em 1000.98em 6.784em -999.998em); top: -4.875em; left: 4.322em;"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.47em 4.136em -999.998em); top: -5.432em; left: 50%; margin-left: -0.23em;"><span class="mtd" id="MathJax-Span-1315"><span class="mrow" id="MathJax-Span-1316"><span class="mn" id="MathJax-Span-1317" style="font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em 1000.47em 4.136em -999.998em); top: -3.992em; left: 50%; margin-left: -0.23em;"><span class="mtd" id="MathJax-Span-1329"><span class="mrow" id="MathJax-Span-1330"><span class="mn" id="MathJax-Span-1331" style="font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.207em 1000.98em 4.322em -999.998em); top: -2.46em; left: 50%; margin-left: -0.462em;"><span class="mtd" id="MathJax-Span-1338"><span class="mrow" id="MathJax-Span-1339"><span class="msubsup" id="MathJax-Span-1340"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.37em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1341" style="font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.327em;"><span class="texatom" id="MathJax-Span-1342"><span class="mrow" id="MathJax-Span-1343"><span class="mi" id="MathJax-Span-1344" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">z</span><span class="mi" id="MathJax-Span-1345" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">z</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.88em;"></span></span></span></span><span class="mo" id="MathJax-Span-1346" style="vertical-align: 2.232em;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.296em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.323em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.552em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.809em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.066em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span></span><span class="mo" id="MathJax-Span-1347" style="font-family: STIXGeneral-Regular;">.</span></span><span style="display: inline-block; width: 0px; height: 4.694em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.117em; border-left: 0px solid; width: 0px; height: 4.785em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>I</mi><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mi>x</mi></mrow></msub></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><msub><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi><mi>y</mi></mrow></msub></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><msub><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mi>z</mi><mi>z</mi></mrow></msub></mtd></mtr></mtable><mo>]</mo></mrow></mrow><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-89">I = {\begin{bmatrix} I_{xx} & 0 & 0 \\ 0 & I_{yy} & 0 \\ 0 & 0 & I_{zz}\end{bmatrix}}.</script></span> Therefore, we obtain our final result for the body frame rotational equations of motion <span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-90-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mi&gt;&amp;#x03C8;&lt;/mi&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mfrac&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mfrac&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mfrac&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1348" style="width: 15.378em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.148em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(2.325em 1013.1em 8.178em -999.998em); top: -5.479em; left: 0em;"><span class="mrow" id="MathJax-Span-1349"><span class="texatom" id="MathJax-Span-1350"><span class="mrow" id="MathJax-Span-1351"><span class="munderover" id="MathJax-Span-1352"><span style="display: inline-block; position: relative; width: 0.699em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1353" style="font-family: STIXGeneral-Italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.254em 1000.24em 3.626em -999.998em); top: -4.039em; left: 0.188em;"><span class="mo" id="MathJax-Span-1354" style="font-family: STIXGeneral-Regular;">˙</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-1355" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="texatom" id="MathJax-Span-1356" style="padding-left: 0.327em;"><span class="mrow" id="MathJax-Span-1357"><span class="mrow" id="MathJax-Span-1358"><span class="mo" id="MathJax-Span-1359" style="vertical-align: 2.418em;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.296em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: 0.049em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.46em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.623em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -0.787em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mtable" id="MathJax-Span-1360" style="padding-right: 0.188em; padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 2.882em; height: 0px;"><span style="position: absolute; clip: rect(2.789em 1002.88em 7.435em -999.998em); top: -5.34em; left: 0em;"><span style="display: inline-block; position: relative; width: 2.882em; height: 0px;"><span style="position: absolute; clip: rect(3.022em 1002.88em 4.415em -999.998em); top: -5.572em; left: 50%; margin-left: -1.438em;"><span class="mtd" id="MathJax-Span-1361"><span class="mrow" id="MathJax-Span-1362"><span class="msubsup" id="MathJax-Span-1363"><span style="display: inline-block; position: relative; width: 0.931em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1364" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.42em;"><span class="mi" id="MathJax-Span-1365" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1366"><span style="display: inline-block; position: relative; width: 1.953em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1001.02em 4.276em -999.998em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1367"><span class="mrow" id="MathJax-Span-1368"><span class="msubsup" id="MathJax-Span-1369"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.37em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1370" style="font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.327em;"><span class="texatom" id="MathJax-Span-1371"><span class="mrow" id="MathJax-Span-1372"><span class="mi" id="MathJax-Span-1373" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1374" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.364em; left: 1.024em;"><span class="texatom" id="MathJax-Span-1375"><span class="mrow" id="MathJax-Span-1376"><span class="mo" id="MathJax-Span-1377" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-1378" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.022em 1002.79em 4.415em -999.998em); top: -3.946em; left: 50%; margin-left: -1.391em;"><span class="mtd" id="MathJax-Span-1379"><span class="mrow" id="MathJax-Span-1380"><span class="msubsup" id="MathJax-Span-1381"><span style="display: inline-block; position: relative; width: 0.838em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1382" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.42em;"><span class="mi" id="MathJax-Span-1383" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1384"><span style="display: inline-block; position: relative; width: 1.953em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1001.02em 4.415em -999.998em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1385"><span class="mrow" id="MathJax-Span-1386"><span class="msubsup" id="MathJax-Span-1387"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.37em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1388" style="font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.327em;"><span class="texatom" id="MathJax-Span-1389"><span class="mrow" id="MathJax-Span-1390"><span class="mi" id="MathJax-Span-1391" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">y</span><span class="mi" id="MathJax-Span-1392" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">y</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.364em; left: 1.024em;"><span class="texatom" id="MathJax-Span-1393"><span class="mrow" id="MathJax-Span-1394"><span class="mo" id="MathJax-Span-1395" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-1396" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.022em 1002.84em 4.415em -999.998em); top: -2.367em; left: 50%; margin-left: -1.391em;"><span class="mtd" id="MathJax-Span-1397"><span class="mrow" id="MathJax-Span-1398"><span class="msubsup" id="MathJax-Span-1399"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1400" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.42em;"><span class="mi" id="MathJax-Span-1401" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1402"><span style="display: inline-block; position: relative; width: 1.86em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.98em 4.322em -999.998em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1403"><span class="mrow" id="MathJax-Span-1404"><span class="msubsup" id="MathJax-Span-1405"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.37em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1406" style="font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.327em;"><span class="texatom" id="MathJax-Span-1407"><span class="mrow" id="MathJax-Span-1408"><span class="mi" id="MathJax-Span-1409" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">z</span><span class="mi" id="MathJax-Span-1410" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">z</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.364em; left: 0.978em;"><span class="texatom" id="MathJax-Span-1411"><span class="mrow" id="MathJax-Span-1412"><span class="mo" id="MathJax-Span-1413" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-1414" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.344em;"></span></span></span></span><span class="mo" id="MathJax-Span-1415" style="vertical-align: 2.418em;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.296em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: 0.049em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.46em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.623em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -0.787em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span></span><span class="mo" id="MathJax-Span-1416" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">−</span><span class="texatom" id="MathJax-Span-1417" style="padding-left: 0.235em;"><span class="mrow" id="MathJax-Span-1418"><span class="mrow" id="MathJax-Span-1419"><span class="mo" id="MathJax-Span-1420" style="vertical-align: 3.022em;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.296em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: 1.257em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.413em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.484em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -0.555em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: 0.374em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mtable" id="MathJax-Span-1421" style="padding-right: 0.188em; padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 4.462em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1004.46em 9.293em -999.998em); top: -6.594em; left: 0em;"><span style="display: inline-block; position: relative; width: 4.462em; height: 0px;"><span style="position: absolute; clip: rect(2.789em 1004.37em 4.601em -999.998em); top: -5.99em; left: 50%; margin-left: -2.181em;"><span class="mtd" id="MathJax-Span-1422"><span class="mrow" id="MathJax-Span-1423"><span class="mfrac" id="MathJax-Span-1424"><span style="display: inline-block; position: relative; width: 2em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.393em 1001.91em 4.369em -999.998em); top: -4.596em; left: 50%; margin-left: -0.927em;"><span class="mrow" id="MathJax-Span-1425"><span class="msubsup" id="MathJax-Span-1426"><span style="display: inline-block; position: relative; width: 0.746em; height: 0px;"><span style="position: absolute; clip: rect(3.393em 1000.28em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1427" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.9em; left: 0.235em;"><span class="texatom" id="MathJax-Span-1428"><span class="mrow" id="MathJax-Span-1429"><span class="mi" id="MathJax-Span-1430" style="font-size: 50%; font-family: STIXGeneral-Italic;">y</span><span class="mi" id="MathJax-Span-1431" style="font-size: 50%; font-family: STIXGeneral-Italic;">y</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-1432" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="msubsup" id="MathJax-Span-1433"><span style="display: inline-block; position: relative; width: 0.699em; height: 0px;"><span style="position: absolute; clip: rect(3.393em 1000.28em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1434" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.9em; left: 0.235em;"><span class="texatom" id="MathJax-Span-1435"><span class="mrow" id="MathJax-Span-1436"><span class="mi" id="MathJax-Span-1437" style="font-size: 50%; font-family: STIXGeneral-Italic;">z</span><span class="mi" id="MathJax-Span-1438" style="font-size: 50%; font-family: STIXGeneral-Italic;">z</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.393em 1000.75em 4.229em -999.998em); top: -3.621em; left: 50%; margin-left: -0.369em;"><span class="msubsup" id="MathJax-Span-1439"><span style="display: inline-block; position: relative; width: 0.746em; height: 0px;"><span style="position: absolute; clip: rect(3.393em 1000.28em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1440" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.9em; left: 0.235em;"><span class="texatom" id="MathJax-Span-1441"><span class="mrow" id="MathJax-Span-1442"><span class="mi" id="MathJax-Span-1443" style="font-size: 50%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1444" style="font-size: 50%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em 1002em 1.21em -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1445"><span style="display: inline-block; position: relative; width: 1.071em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1446" style="font-family: STIXGeneral-Italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.699em;"><span class="mi" id="MathJax-Span-1447" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1448"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1449" style="font-family: STIXGeneral-Italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.699em;"><span class="mi" id="MathJax-Span-1450" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(2.836em 1004.37em 4.694em -999.998em); top: -4.039em; left: 50%; margin-left: -2.181em;"><span class="mtd" id="MathJax-Span-1451"><span class="mrow" id="MathJax-Span-1452"><span class="mfrac" id="MathJax-Span-1453"><span style="display: inline-block; position: relative; width: 2em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.393em 1001.91em 4.276em -999.998em); top: -4.55em; left: 50%; margin-left: -0.927em;"><span class="mrow" id="MathJax-Span-1454"><span class="msubsup" id="MathJax-Span-1455"><span style="display: inline-block; position: relative; width: 0.699em; height: 0px;"><span style="position: absolute; clip: rect(3.393em 1000.28em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1456" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.9em; left: 0.235em;"><span class="texatom" id="MathJax-Span-1457"><span class="mrow" id="MathJax-Span-1458"><span class="mi" id="MathJax-Span-1459" style="font-size: 50%; font-family: STIXGeneral-Italic;">z</span><span class="mi" id="MathJax-Span-1460" style="font-size: 50%; font-family: STIXGeneral-Italic;">z</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-1461" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="msubsup" id="MathJax-Span-1462"><span style="display: inline-block; position: relative; width: 0.746em; height: 0px;"><span style="position: absolute; clip: rect(3.393em 1000.28em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1463" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.9em; left: 0.235em;"><span class="texatom" id="MathJax-Span-1464"><span class="mrow" id="MathJax-Span-1465"><span class="mi" id="MathJax-Span-1466" style="font-size: 50%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1467" style="font-size: 50%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.393em 1000.75em 4.369em -999.998em); top: -3.621em; left: 50%; margin-left: -0.369em;"><span class="msubsup" id="MathJax-Span-1468"><span style="display: inline-block; position: relative; width: 0.746em; height: 0px;"><span style="position: absolute; clip: rect(3.393em 1000.28em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1469" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.9em; left: 0.235em;"><span class="texatom" id="MathJax-Span-1470"><span class="mrow" id="MathJax-Span-1471"><span class="mi" id="MathJax-Span-1472" style="font-size: 50%; font-family: STIXGeneral-Italic;">y</span><span class="mi" id="MathJax-Span-1473" style="font-size: 50%; font-family: STIXGeneral-Italic;">y</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em 1002em 1.21em -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1474"><span style="display: inline-block; position: relative; width: 1.071em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1475" style="font-family: STIXGeneral-Italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.699em;"><span class="mi" id="MathJax-Span-1476" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1477"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1478" style="font-family: STIXGeneral-Italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.699em;"><span class="mi" id="MathJax-Span-1479" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(2.789em 1004.46em 4.647em -999.998em); top: -1.949em; left: 50%; margin-left: -2.227em;"><span class="mtd" id="MathJax-Span-1480"><span class="mrow" id="MathJax-Span-1481"><span class="mfrac" id="MathJax-Span-1482"><span style="display: inline-block; position: relative; width: 2.093em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.393em 1001.95em 4.369em -999.998em); top: -4.596em; left: 50%; margin-left: -0.973em;"><span class="mrow" id="MathJax-Span-1483"><span class="msubsup" id="MathJax-Span-1484"><span style="display: inline-block; position: relative; width: 0.746em; height: 0px;"><span style="position: absolute; clip: rect(3.393em 1000.28em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1485" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.9em; left: 0.235em;"><span class="texatom" id="MathJax-Span-1486"><span class="mrow" id="MathJax-Span-1487"><span class="mi" id="MathJax-Span-1488" style="font-size: 50%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1489" style="font-size: 50%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-1490" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="msubsup" id="MathJax-Span-1491"><span style="display: inline-block; position: relative; width: 0.746em; height: 0px;"><span style="position: absolute; clip: rect(3.393em 1000.28em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1492" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.9em; left: 0.235em;"><span class="texatom" id="MathJax-Span-1493"><span class="mrow" id="MathJax-Span-1494"><span class="mi" id="MathJax-Span-1495" style="font-size: 50%; font-family: STIXGeneral-Italic;">y</span><span class="mi" id="MathJax-Span-1496" style="font-size: 50%; font-family: STIXGeneral-Italic;">y</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.393em 1000.7em 4.276em -999.998em); top: -3.621em; left: 50%; margin-left: -0.323em;"><span class="msubsup" id="MathJax-Span-1497"><span style="display: inline-block; position: relative; width: 0.699em; height: 0px;"><span style="position: absolute; clip: rect(3.393em 1000.28em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1498" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.9em; left: 0.235em;"><span class="texatom" id="MathJax-Span-1499"><span class="mrow" id="MathJax-Span-1500"><span class="mi" id="MathJax-Span-1501" style="font-size: 50%; font-family: STIXGeneral-Italic;">z</span><span class="mi" id="MathJax-Span-1502" style="font-size: 50%; font-family: STIXGeneral-Italic;">z</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em 1002.09em 1.21em -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.093em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1503"><span style="display: inline-block; position: relative; width: 1.071em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1504" style="font-family: STIXGeneral-Italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.699em;"><span class="mi" id="MathJax-Span-1505" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1506"><span style="display: inline-block; position: relative; width: 1.071em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1507" style="font-family: STIXGeneral-Italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.699em;"><span class="mi" id="MathJax-Span-1508" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.598em;"></span></span></span></span><span class="mo" id="MathJax-Span-1509" style="vertical-align: 3.022em;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.296em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: 1.257em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.413em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.484em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -0.555em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: 0.374em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 5.484em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -3.041em; border-left: 0px solid; width: 0px; height: 6.633em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mover><mi>ω</mi><mo>˙</mo></mover></mrow><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>τ</mi><mi>ϕ</mi></msub><msup><mrow class="MJX-TeXAtom-ORD"><msub><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mi>x</mi></mrow></msub></mrow><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup></mtd></mtr><mtr><mtd><msub><mi>τ</mi><mi>θ</mi></msub><msup><mrow class="MJX-TeXAtom-ORD"><msub><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi><mi>y</mi></mrow></msub></mrow><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup></mtd></mtr><mtr><mtd><msub><mi>τ</mi><mi>ψ</mi></msub><msup><mrow class="MJX-TeXAtom-ORD"><msub><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mi>z</mi><mi>z</mi></mrow></msub></mrow><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup></mtd></mtr></mtable><mo>]</mo></mrow></mrow><mo>−</mo><mrow class="MJX-TeXAtom-ORD"><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mfrac><mrow><msub><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi><mi>y</mi></mrow></msub><mo>−</mo><msub><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mi>z</mi><mi>z</mi></mrow></msub></mrow><msub><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mi>x</mi></mrow></msub></mfrac><msub><mi>ω</mi><mi>y</mi></msub><msub><mi>ω</mi><mi>z</mi></msub></mtd></mtr><mtr><mtd><mfrac><mrow><msub><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mi>z</mi><mi>z</mi></mrow></msub><mo>−</mo><msub><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mi>x</mi></mrow></msub></mrow><msub><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi><mi>y</mi></mrow></msub></mfrac><msub><mi>ω</mi><mi>x</mi></msub><msub><mi>ω</mi><mi>z</mi></msub></mtd></mtr><mtr><mtd><mfrac><mrow><msub><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mi>x</mi></mrow></msub><mo>−</mo><msub><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi><mi>y</mi></mrow></msub></mrow><msub><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mi>z</mi><mi>z</mi></mrow></msub></mfrac><msub><mi>ω</mi><mi>x</mi></msub><msub><mi>ω</mi><mi>y</mi></msub></mtd></mtr></mtable><mo>]</mo></mrow></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-90">\dot\omega = {\begin{bmatrix} 
    \tau_\phi {I_{xx}}^{-1} \\
    \tau_\theta {I_{yy}}^{-1} \\
    \tau_\psi {I_{zz}}^{-1}
\end{bmatrix}} - {\begin{bmatrix} 
    \frac{I_{yy} - I_{zz}}{I_{xx}} \omega_y\omega_z \\ 
    \frac{I_{zz} - I_{xx}}{I_{yy}} \omega_x\omega_z  \\
    \frac{I_{xx} - I_{yy}}{I_{zz}} \omega_x\omega_y
\end{bmatrix}}</script></span></p>
<h1 id="simulation" class="unnumbered">Simulation</h1>
<p>Now that we have complete equations of motion describing the dynamics of the system, we can create a simulation environment in which to test and view the results of various inputs and controllers. Although more advanced methods are available, we can quickly write a simulator which utilizes Euler’s method for solving differential equations to evolve the system state. In MATLAB, this simulator would be written as follows.</p>
<div class="sourceCode"><pre class="sourceCode matlab"><code class="sourceCode matlab"><span class="co">% Simulation times, in seconds.</span>
start_time = <span class="fl">0</span>;
end_time = <span class="fl">10</span>;
dt = <span class="fl">0.005</span>;
times = start_time:dt:end_time;

<span class="co">% Number of points in the simulation.</span>
N = numel(times);

<span class="co">% Initial simulation state.</span>
x = [<span class="fl">0</span>; <span class="fl">0</span>; <span class="fl">10</span>];
xdot = zeros(<span class="fl">3</span>, <span class="fl">1</span>);
theta = zeros(<span class="fl">3</span>, <span class="fl">1</span>);

<span class="co">% Simulate some disturbance in the angular velocity.</span>
<span class="co">% The magnitude of the deviation is in radians / second.</span>
deviation = <span class="fl">100</span>;
thetadot = deg2rad(<span class="fl">2</span> * deviation * rand(<span class="fl">3</span>, <span class="fl">1</span>) - deviation);

<span class="co">% Step through the simulation, updating the state.</span>
for t = times
    <span class="co">% Take input from our controller.</span>
    i = input(t);

    omega = thetadot2omega(thetadot, theta);

    <span class="co">% Compute linear and angular accelerations.</span>
    a = acceleration(i, theta, xdot, m, g, k, kd);
    omegadot = angular_acceleration(i, omega, I, L, b, k);

    omega = omega + dt * omegadot;
    thetadot = omega2thetadot(omega, theta); 
    theta = theta + dt * thetadot;
    xdot = xdot + dt * a;
    x = x + dt * xdot;
end</code></pre></div>
<p>We would then need functions to compute all of the physical forces and torques.</p>
<div class="sourceCode"><pre class="sourceCode matlab"><code class="sourceCode matlab"><span class="co">% Compute thrust given current inputs and thrust coefficient.</span>
function T = thrust(inputs, k)
    <span class="co">% Inputs are values for ${\omega_i}^2$</span>
    T = [<span class="fl">0</span>; <span class="fl">0</span>; k * sum(inputs)];
end

<span class="co">% Compute torques, given current inputs, length, drag coefficient, and thrust coefficient.</span>
function tau = torques(inputs, L, b, k)
    <span class="co">% Inputs are values for ${\omega_i}^2$</span>
    tau = [
        L * k * (inputs(<span class="fl">1</span>) - inputs(<span class="fl">3</span>))
        L * k * (inputs(<span class="fl">2</span>) - inputs(<span class="fl">4</span>))
        b * (inputs(<span class="fl">1</span>) - inputs(<span class="fl">2</span>) + inputs(<span class="fl">3</span>) - inputs(<span class="fl">4</span>))
    ];
end

function a = acceleration(inputs, angles, xdot, m, g, k, kd)
    gravity = [<span class="fl">0</span>; <span class="fl">0</span>; -g];
    R = rotation(angles);
    T = R * thrust(inputs, k);
    Fd = -kd * xdot;
    a = gravity + <span class="fl">1</span> / m * T + Fd;
end

function omegadot = angular_acceleration(inputs, omega, I, L, b, k)
    tau = torques(inputs, L, b, k);
    omegaddot = inv(I) * (tau - cross(omega, I * omega));
end</code></pre></div>
<p>We would also need values for all of our physical constants, a function to compute the rotation matrix <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-91-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1510" style="width: 0.746em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.606em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.767em 1000.61em 2.696em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-1511"><span class="mi" id="MathJax-Span-1512" style="font-family: STIXGeneral-Italic;">R</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.872em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>R</mi></math></span></span><script type="math/tex" id="MathJax-Element-91">R</script></span>, and functions to convert from an angular velocity vector <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-92-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1513" style="width: 0.838em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.699em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(2em 1000.65em 2.696em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-1514"><span class="mi" id="MathJax-Span-1515" style="font-family: STIXGeneral-Italic;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.655em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ω</mi></math></span></span><script type="math/tex" id="MathJax-Element-92">\omega</script></span> to the derivatives of roll, pitch, and yaw and vice-versa. These are not shown. We can then draw the quadcopter in a three-dimensional visualization which is updated as the simulation is running.</p>
<p><img src="./Quadcopter_Dynamics_and_Simulation_files/simulation.png" alt="image"><br>
<span> Quadcopter Simulation. Bars above each propeller represent, roughly, relative thrust magnitudes. </span></p>
<h1 id="control" class="unnumbered">Control</h1>
<p>The purpose of deriving a mathematical model of a quadcopter is to assist in developing controllers for physical quadcopters. The inputs to our system consist of the angular velocities of each rotor, since all we can control is the voltages across the motors. Note that in our simplified model, we only use the square of the angular velocities, <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-93-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1516" style="width: 1.628em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.396em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.257em 1001.4em 2.511em -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-1517"><span class="msubsup" id="MathJax-Span-1518"><span style="display: inline-block; position: relative; width: 1.396em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.98em 4.276em -999.998em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1519"><span class="mrow" id="MathJax-Span-1520"><span class="msubsup" id="MathJax-Span-1521"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1522" style="font-family: STIXGeneral-Italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.699em;"><span class="mi" id="MathJax-Span-1523" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.364em; left: 0.978em;"><span class="mn" id="MathJax-Span-1524" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.215em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><msub><mi>ω</mi><mi>i</mi></msub></mrow><mn>2</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-93">{\omega_i}^2</script></span>, and never the angular velocity itself, <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-94-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1525" style="width: 1.164em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.675em 1000.98em 2.511em -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-1526"><span class="msubsup" id="MathJax-Span-1527"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1528" style="font-family: STIXGeneral-Italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.699em;"><span class="mi" id="MathJax-Span-1529" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.215em; border-left: 0px solid; width: 0px; height: 0.818em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>ω</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-94">\omega_i</script></span>. For notational simplicity, let us introduce the inputs <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-95-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1530" style="width: 4.044em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.44em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.582em 1003.44em 2.882em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-1531"><span class="msubsup" id="MathJax-Span-1532"><span style="display: inline-block; position: relative; width: 0.699em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.322em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1533" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.42em;"><span class="mi" id="MathJax-Span-1534" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-1535" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="msubsup" id="MathJax-Span-1536" style="padding-left: 0.327em;"><span style="display: inline-block; position: relative; width: 1.396em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.98em 4.276em -999.998em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1537"><span class="mrow" id="MathJax-Span-1538"><span class="msubsup" id="MathJax-Span-1539"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1540" style="font-family: STIXGeneral-Italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.699em;"><span class="mi" id="MathJax-Span-1541" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.364em; left: 0.978em;"><span class="mn" id="MathJax-Span-1542" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.269em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>γ</mi><mi>i</mi></msub><mo>=</mo><msup><mrow class="MJX-TeXAtom-ORD"><msub><mi>ω</mi><mi>i</mi></msub></mrow><mn>2</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-95">\gamma_i = {\omega_i}^2</script></span>. Since we can set <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-96-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1543" style="width: 1.164em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.675em 1000.98em 2.511em -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-1544"><span class="msubsup" id="MathJax-Span-1545"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1546" style="font-family: STIXGeneral-Italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.699em;"><span class="mi" id="MathJax-Span-1547" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.215em; border-left: 0px solid; width: 0px; height: 0.818em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>ω</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-96">\omega_i</script></span>, we can clearly set <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-97-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1548" style="width: 0.838em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.699em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.675em 1000.7em 2.557em -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-1549"><span class="msubsup" id="MathJax-Span-1550"><span style="display: inline-block; position: relative; width: 0.699em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.322em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1551" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.42em;"><span class="mi" id="MathJax-Span-1552" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.269em; border-left: 0px solid; width: 0px; height: 0.872em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>γ</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-97">\gamma_i</script></span> as well. With this, we can write our system as a first order differential equation in state space. Let <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-98-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1553" style="width: 1.071em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.675em 1000.88em 2.511em -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-1554"><span class="msubsup" id="MathJax-Span-1555"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.47em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1556" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mn" id="MathJax-Span-1557" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.215em; border-left: 0px solid; width: 0px; height: 0.818em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>x</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-98">x_1</script></span> be the position in space of the quadcopter, <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-99-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1558" style="width: 1.071em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.675em 1000.88em 2.511em -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-1559"><span class="msubsup" id="MathJax-Span-1560"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.47em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1561" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mn" id="MathJax-Span-1562" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.215em; border-left: 0px solid; width: 0px; height: 0.818em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>x</mi><mn>2</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-99">x_2</script></span> be the quadcopter linear velocity, <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-100-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1563" style="width: 1.071em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.675em 1000.88em 2.511em -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-1564"><span class="msubsup" id="MathJax-Span-1565"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.47em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1566" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mn" id="MathJax-Span-1567" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">3</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.215em; border-left: 0px solid; width: 0px; height: 0.818em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>x</mi><mn>3</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-100">x_3</script></span> be the roll, pitch, and yaw angles, and <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-101-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1568" style="width: 1.071em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.675em 1000.88em 2.511em -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-1569"><span class="msubsup" id="MathJax-Span-1570"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.47em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1571" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mn" id="MathJax-Span-1572" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">4</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.215em; border-left: 0px solid; width: 0px; height: 0.818em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>x</mi><mn>4</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-101">x_4</script></span> be the angular velocity vector. (Note that all of these are 3-vectors.) With these being our state, we can write the state space equations for the evolution of our state. <span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-102-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/mfrac&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/mfrac&gt;&lt;msub&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mi&gt;&amp;#x03C8;&lt;/mi&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mfrac&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mfrac&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mfrac&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1573" style="width: 15.982em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.659em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(-6.036em 1013.43em 10.036em -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-1574"><span class="mtable" id="MathJax-Span-1575" style="padding-right: 0.188em; padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 13.287em; height: 0px;"><span style="position: absolute; clip: rect(6.134em 1000.88em 19.651em -999.998em); top: -14.258em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.88em 4.276em -999.998em); top: -11.332em; right: 0em;"><span class="mtd" id="MathJax-Span-1576"><span class="mrow" id="MathJax-Span-1577"><span class="texatom" id="MathJax-Span-1578"><span class="mrow" id="MathJax-Span-1579"><span class="munderover" id="MathJax-Span-1580"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.88em 4.276em -999.998em); top: -3.992em; left: 0em;"><span class="msubsup" id="MathJax-Span-1581"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.47em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1582" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mn" id="MathJax-Span-1583" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.254em 1000.24em 3.626em -999.998em); top: -4.039em; left: 0.281em;"><span class="mo" id="MathJax-Span-1584" style="font-family: STIXGeneral-Regular;">˙</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.207em 1000.88em 4.276em -999.998em); top: -8.591em; right: 0em;"><span class="mtd" id="MathJax-Span-1592"><span class="mrow" id="MathJax-Span-1593"><span class="texatom" id="MathJax-Span-1594"><span class="mrow" id="MathJax-Span-1595"><span class="munderover" id="MathJax-Span-1596"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.88em 4.276em -999.998em); top: -3.992em; left: 0em;"><span class="msubsup" id="MathJax-Span-1597"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.47em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1598" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mn" id="MathJax-Span-1599" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.254em 1000.24em 3.626em -999.998em); top: -4.039em; left: 0.281em;"><span class="mo" id="MathJax-Span-1600" style="font-family: STIXGeneral-Regular;">˙</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.207em 1000.88em 4.276em -999.998em); top: -4.039em; right: 0em;"><span class="mtd" id="MathJax-Span-1636"><span class="mrow" id="MathJax-Span-1637"><span class="texatom" id="MathJax-Span-1638"><span class="mrow" id="MathJax-Span-1639"><span class="munderover" id="MathJax-Span-1640"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.88em 4.276em -999.998em); top: -3.992em; left: 0em;"><span class="msubsup" id="MathJax-Span-1641"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.47em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1642" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mn" id="MathJax-Span-1643" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">3</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.254em 1000.24em 3.626em -999.998em); top: -4.039em; left: 0.281em;"><span class="mo" id="MathJax-Span-1644" style="font-family: STIXGeneral-Regular;">˙</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.207em 1000.88em 4.276em -999.998em); top: 1.117em; right: 0em;"><span class="mtd" id="MathJax-Span-1708"><span class="mrow" id="MathJax-Span-1709"><span class="texatom" id="MathJax-Span-1710"><span class="mrow" id="MathJax-Span-1711"><span class="munderover" id="MathJax-Span-1712"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.88em 4.276em -999.998em); top: -3.992em; left: 0em;"><span class="msubsup" id="MathJax-Span-1713"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.47em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1714" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mn" id="MathJax-Span-1715" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">4</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.254em 1000.24em 3.626em -999.998em); top: -4.039em; left: 0.281em;"><span class="mo" id="MathJax-Span-1716" style="font-family: STIXGeneral-Regular;">˙</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span><span style="display: inline-block; width: 0px; height: 14.263em;"></span></span><span style="position: absolute; clip: rect(8.503em 1012.36em 24.25em -999.998em); top: -16.441em; left: 0.885em;"><span style="display: inline-block; position: relative; width: 12.405em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1002.23em 4.276em -999.998em); top: -11.332em; left: 0em;"><span class="mtd" id="MathJax-Span-1585"><span class="mrow" id="MathJax-Span-1586"><span class="mi" id="MathJax-Span-1587"></span><span class="mo" id="MathJax-Span-1588" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="msubsup" id="MathJax-Span-1589" style="padding-left: 0.327em;"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.47em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1590" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mn" id="MathJax-Span-1591" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(2.604em 1011.15em 6.784em -999.998em); top: -9.52em; left: 0em;"><span class="mtd" id="MathJax-Span-1601"><span class="mrow" id="MathJax-Span-1602"><span class="mi" id="MathJax-Span-1603"></span><span class="mo" id="MathJax-Span-1604" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="texatom" id="MathJax-Span-1605" style="padding-left: 0.327em;"><span class="mrow" id="MathJax-Span-1606"><span class="mrow" id="MathJax-Span-1607"><span class="mo" id="MathJax-Span-1608" style="vertical-align: 2.186em;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.296em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.416em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.32em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.391em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mtable" id="MathJax-Span-1609" style="padding-right: 0.188em; padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.21em; height: 0px;"><span style="position: absolute; clip: rect(2.557em 1001.16em 6.645em -999.998em); top: -4.782em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.21em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.47em 4.136em -999.998em); top: -5.386em; left: 50%; margin-left: -0.23em;"><span class="mtd" id="MathJax-Span-1610"><span class="mrow" id="MathJax-Span-1611"><span class="mn" id="MathJax-Span-1612" style="font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em 1000.47em 4.136em -999.998em); top: -3.946em; left: 50%; margin-left: -0.23em;"><span class="mtd" id="MathJax-Span-1613"><span class="mrow" id="MathJax-Span-1614"><span class="mn" id="MathJax-Span-1615" style="font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.3em 1001.16em 4.322em -999.998em); top: -2.506em; left: 50%; margin-left: -0.602em;"><span class="mtd" id="MathJax-Span-1616"><span class="mrow" id="MathJax-Span-1617"><span class="mo" id="MathJax-Span-1618" style="font-family: STIXGeneral-Regular;">−</span><span class="mi" id="MathJax-Span-1619" style="font-family: STIXGeneral-Italic;">g</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.787em;"></span></span></span></span><span class="mo" id="MathJax-Span-1620" style="vertical-align: 2.186em;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.296em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.416em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.32em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.391em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span></span><span class="mo" id="MathJax-Span-1621" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">+</span><span class="mfrac" id="MathJax-Span-1622" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 0.838em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.161em 1000.37em 4.136em -999.998em); top: -4.689em; left: 50%; margin-left: -0.23em;"><span class="mn" id="MathJax-Span-1623" style="font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.44em 1000.7em 4.136em -999.998em); top: -3.296em; left: 50%; margin-left: -0.369em;"><span class="mi" id="MathJax-Span-1624" style="font-family: STIXGeneral-Italic;">m</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.84em 1.21em -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.838em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mi" id="MathJax-Span-1625" style="font-family: STIXGeneral-Italic;">R</span><span class="msubsup" id="MathJax-Span-1626"><span style="display: inline-block; position: relative; width: 1.071em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1627" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.095em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.56em;"><span class="mi" id="MathJax-Span-1628" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">B</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-1629" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">+</span><span class="mfrac" id="MathJax-Span-1630" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 0.838em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.161em 1000.37em 4.136em -999.998em); top: -4.689em; left: 50%; margin-left: -0.23em;"><span class="mn" id="MathJax-Span-1631" style="font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.44em 1000.7em 4.136em -999.998em); top: -3.296em; left: 50%; margin-left: -0.369em;"><span class="mi" id="MathJax-Span-1632" style="font-family: STIXGeneral-Italic;">m</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.84em 1.21em -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.838em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1633"><span style="display: inline-block; position: relative; width: 1.21em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1634" style="font-family: STIXGeneral-Italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.606em;"><span class="mi" id="MathJax-Span-1635" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">D</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.926em;"></span></span><span style="position: absolute; clip: rect(2.65em 1010.59em 7.249em -999.998em); top: -5.34em; left: 0em;"><span class="mtd" id="MathJax-Span-1645"><span class="mrow" id="MathJax-Span-1646"><span class="mi" id="MathJax-Span-1647"></span><span class="mo" id="MathJax-Span-1648" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="msubsup" id="MathJax-Span-1649" style="padding-left: 0.327em;"><span style="display: inline-block; position: relative; width: 8.364em; height: 0px;"><span style="position: absolute; clip: rect(2.696em 1007.39em 7.063em -999.998em); top: -5.107em; left: 0em;"><span class="texatom" id="MathJax-Span-1650"><span class="mrow" id="MathJax-Span-1651"><span class="mrow" id="MathJax-Span-1652"><span class="mo" id="MathJax-Span-1653" style="vertical-align: 2.278em;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.296em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.23em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.552em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.763em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -0.973em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mtable" id="MathJax-Span-1654" style="padding-right: 0.188em; padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 6.18em; height: 0px;"><span style="position: absolute; clip: rect(2.371em 1000.47em 6.366em -999.998em); top: -4.689em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.513em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.37em 4.136em -999.998em); top: -5.479em; left: 50%; margin-left: -0.23em;"><span class="mtd" id="MathJax-Span-1655"><span class="mrow" id="MathJax-Span-1656"><span class="mn" id="MathJax-Span-1657" style="font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em 1000.47em 4.136em -999.998em); top: -4.039em; left: 50%; margin-left: -0.23em;"><span class="mtd" id="MathJax-Span-1667"><span class="mrow" id="MathJax-Span-1668"><span class="mn" id="MathJax-Span-1669" style="font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em 1000.47em 4.136em -999.998em); top: -2.506em; left: 50%; margin-left: -0.23em;"><span class="mtd" id="MathJax-Span-1683"><span class="mrow" id="MathJax-Span-1684"><span class="mn" id="MathJax-Span-1685" style="font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.694em;"></span></span><span style="position: absolute; clip: rect(2.65em 1001.58em 6.924em -999.998em); top: -4.968em; left: 1.628em;"><span style="display: inline-block; position: relative; width: 1.582em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.47em 4.136em -999.998em); top: -5.479em; left: 50%; margin-left: -0.23em;"><span class="mtd" id="MathJax-Span-1658"><span class="mrow" id="MathJax-Span-1659"><span class="mn" id="MathJax-Span-1660" style="font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.44em 1000.98em 4.415em -999.998em); top: -4.039em; left: 50%; margin-left: -0.462em;"><span class="mtd" id="MathJax-Span-1670"><span class="mrow" id="MathJax-Span-1671"><span class="msubsup" id="MathJax-Span-1672"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1673" style="font-family: STIXGeneral-Italic;">c</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-1674" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.3em 1001.58em 4.415em -999.998em); top: -2.506em; left: 50%; margin-left: -0.787em;"><span class="mtd" id="MathJax-Span-1686"><span class="mrow" id="MathJax-Span-1687"><span class="mo" id="MathJax-Span-1688" style="font-family: STIXGeneral-Regular;">−</span><span class="msubsup" id="MathJax-Span-1689"><span style="display: inline-block; position: relative; width: 0.931em; height: 0px;"><span style="position: absolute; clip: rect(3.393em 1000.37em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1690" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.374em;"><span class="mi" id="MathJax-Span-1691" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.973em;"></span></span><span style="position: absolute; clip: rect(2.65em 1001.81em 6.784em -999.998em); top: -4.829em; left: 4.322em;"><span style="display: inline-block; position: relative; width: 1.814em; height: 0px;"><span style="position: absolute; clip: rect(3.3em 1001.49em 4.276em -999.998em); top: -5.479em; left: 50%; margin-left: -0.741em;"><span class="mtd" id="MathJax-Span-1661"><span class="mrow" id="MathJax-Span-1662"><span class="mo" id="MathJax-Span-1663" style="font-family: STIXGeneral-Regular;">−</span><span class="msubsup" id="MathJax-Span-1664"><span style="display: inline-block; position: relative; width: 0.838em; height: 0px;"><span style="position: absolute; clip: rect(3.393em 1000.37em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1665" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.374em;"><span class="mi" id="MathJax-Span-1666" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.393em 1001.77em 4.415em -999.998em); top: -4.039em; left: 50%; margin-left: -0.88em;"><span class="mtd" id="MathJax-Span-1675"><span class="mrow" id="MathJax-Span-1676"><span class="msubsup" id="MathJax-Span-1677"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1678" style="font-family: STIXGeneral-Italic;">c</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-1679" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1680"><span style="display: inline-block; position: relative; width: 0.931em; height: 0px;"><span style="position: absolute; clip: rect(3.393em 1000.37em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1681" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.374em;"><span class="mi" id="MathJax-Span-1682" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.44em 1001.81em 4.415em -999.998em); top: -2.506em; left: 50%; margin-left: -0.927em;"><span class="mtd" id="MathJax-Span-1692"><span class="mrow" id="MathJax-Span-1693"><span class="msubsup" id="MathJax-Span-1694"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1695" style="font-family: STIXGeneral-Italic;">c</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-1696" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1697"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1698" style="font-family: STIXGeneral-Italic;">c</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-1699" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.833em;"></span></span></span></span><span class="mo" id="MathJax-Span-1700" style="vertical-align: 2.278em;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.296em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.23em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.552em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.763em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -0.973em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 5.112em;"></span></span><span style="position: absolute; top: -6.036em; left: 7.435em;"><span class="texatom" id="MathJax-Span-1701"><span class="mrow" id="MathJax-Span-1702"><span class="mo" id="MathJax-Span-1703" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-1704" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1705"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.47em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1706" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mn" id="MathJax-Span-1707" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">4</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 5.298em;"></span></span><span style="position: absolute; clip: rect(3.44em 1012.36em 9.293em -999.998em); top: -1.484em; left: 0em;"><span class="mtd" id="MathJax-Span-1717"><span class="mrow" id="MathJax-Span-1718"><span class="mi" id="MathJax-Span-1719"></span><span class="mo" id="MathJax-Span-1720" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="texatom" id="MathJax-Span-1721" style="padding-left: 0.327em;"><span class="mrow" id="MathJax-Span-1722"><span class="mrow" id="MathJax-Span-1723"><span class="mo" id="MathJax-Span-1724" style="vertical-align: 2.418em;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.296em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: 0.049em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.46em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.623em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -0.787em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mtable" id="MathJax-Span-1725" style="padding-right: 0.188em; padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 2.882em; height: 0px;"><span style="position: absolute; clip: rect(2.789em 1002.88em 7.435em -999.998em); top: -5.34em; left: 0em;"><span style="display: inline-block; position: relative; width: 2.882em; height: 0px;"><span style="position: absolute; clip: rect(3.022em 1002.88em 4.415em -999.998em); top: -5.572em; left: 50%; margin-left: -1.438em;"><span class="mtd" id="MathJax-Span-1726"><span class="mrow" id="MathJax-Span-1727"><span class="msubsup" id="MathJax-Span-1728"><span style="display: inline-block; position: relative; width: 0.931em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1729" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.42em;"><span class="mi" id="MathJax-Span-1730" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1731"><span style="display: inline-block; position: relative; width: 1.953em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1001.02em 4.276em -999.998em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1732"><span class="mrow" id="MathJax-Span-1733"><span class="msubsup" id="MathJax-Span-1734"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.37em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1735" style="font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.327em;"><span class="texatom" id="MathJax-Span-1736"><span class="mrow" id="MathJax-Span-1737"><span class="mi" id="MathJax-Span-1738" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1739" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.364em; left: 1.024em;"><span class="texatom" id="MathJax-Span-1740"><span class="mrow" id="MathJax-Span-1741"><span class="mo" id="MathJax-Span-1742" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-1743" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.022em 1002.79em 4.415em -999.998em); top: -3.946em; left: 50%; margin-left: -1.391em;"><span class="mtd" id="MathJax-Span-1744"><span class="mrow" id="MathJax-Span-1745"><span class="msubsup" id="MathJax-Span-1746"><span style="display: inline-block; position: relative; width: 0.838em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1747" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.42em;"><span class="mi" id="MathJax-Span-1748" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1749"><span style="display: inline-block; position: relative; width: 1.953em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1001.02em 4.415em -999.998em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1750"><span class="mrow" id="MathJax-Span-1751"><span class="msubsup" id="MathJax-Span-1752"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.37em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1753" style="font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.327em;"><span class="texatom" id="MathJax-Span-1754"><span class="mrow" id="MathJax-Span-1755"><span class="mi" id="MathJax-Span-1756" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">y</span><span class="mi" id="MathJax-Span-1757" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">y</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.364em; left: 1.024em;"><span class="texatom" id="MathJax-Span-1758"><span class="mrow" id="MathJax-Span-1759"><span class="mo" id="MathJax-Span-1760" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-1761" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.022em 1002.84em 4.415em -999.998em); top: -2.367em; left: 50%; margin-left: -1.391em;"><span class="mtd" id="MathJax-Span-1762"><span class="mrow" id="MathJax-Span-1763"><span class="msubsup" id="MathJax-Span-1764"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1765" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.42em;"><span class="mi" id="MathJax-Span-1766" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1767"><span style="display: inline-block; position: relative; width: 1.86em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.98em 4.322em -999.998em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1768"><span class="mrow" id="MathJax-Span-1769"><span class="msubsup" id="MathJax-Span-1770"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.37em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1771" style="font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.327em;"><span class="texatom" id="MathJax-Span-1772"><span class="mrow" id="MathJax-Span-1773"><span class="mi" id="MathJax-Span-1774" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">z</span><span class="mi" id="MathJax-Span-1775" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">z</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.364em; left: 0.978em;"><span class="texatom" id="MathJax-Span-1776"><span class="mrow" id="MathJax-Span-1777"><span class="mo" id="MathJax-Span-1778" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-1779" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.344em;"></span></span></span></span><span class="mo" id="MathJax-Span-1780" style="vertical-align: 2.418em;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.296em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: 0.049em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.46em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.623em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -0.787em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span></span><span class="mo" id="MathJax-Span-1781" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">−</span><span class="texatom" id="MathJax-Span-1782" style="padding-left: 0.235em;"><span class="mrow" id="MathJax-Span-1783"><span class="mrow" id="MathJax-Span-1784"><span class="mo" id="MathJax-Span-1785" style="vertical-align: 3.022em;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.296em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: 1.257em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.413em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.484em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -0.555em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: 0.374em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mtable" id="MathJax-Span-1786" style="padding-right: 0.188em; padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 4.462em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1004.46em 9.293em -999.998em); top: -6.594em; left: 0em;"><span style="display: inline-block; position: relative; width: 4.462em; height: 0px;"><span style="position: absolute; clip: rect(2.789em 1004.37em 4.601em -999.998em); top: -5.99em; left: 50%; margin-left: -2.181em;"><span class="mtd" id="MathJax-Span-1787"><span class="mrow" id="MathJax-Span-1788"><span class="mfrac" id="MathJax-Span-1789"><span style="display: inline-block; position: relative; width: 2em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.393em 1001.91em 4.369em -999.998em); top: -4.596em; left: 50%; margin-left: -0.927em;"><span class="mrow" id="MathJax-Span-1790"><span class="msubsup" id="MathJax-Span-1791"><span style="display: inline-block; position: relative; width: 0.746em; height: 0px;"><span style="position: absolute; clip: rect(3.393em 1000.28em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1792" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.9em; left: 0.235em;"><span class="texatom" id="MathJax-Span-1793"><span class="mrow" id="MathJax-Span-1794"><span class="mi" id="MathJax-Span-1795" style="font-size: 50%; font-family: STIXGeneral-Italic;">y</span><span class="mi" id="MathJax-Span-1796" style="font-size: 50%; font-family: STIXGeneral-Italic;">y</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-1797" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="msubsup" id="MathJax-Span-1798"><span style="display: inline-block; position: relative; width: 0.699em; height: 0px;"><span style="position: absolute; clip: rect(3.393em 1000.28em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1799" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.9em; left: 0.235em;"><span class="texatom" id="MathJax-Span-1800"><span class="mrow" id="MathJax-Span-1801"><span class="mi" id="MathJax-Span-1802" style="font-size: 50%; font-family: STIXGeneral-Italic;">z</span><span class="mi" id="MathJax-Span-1803" style="font-size: 50%; font-family: STIXGeneral-Italic;">z</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.393em 1000.75em 4.229em -999.998em); top: -3.621em; left: 50%; margin-left: -0.369em;"><span class="msubsup" id="MathJax-Span-1804"><span style="display: inline-block; position: relative; width: 0.746em; height: 0px;"><span style="position: absolute; clip: rect(3.393em 1000.28em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1805" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.9em; left: 0.235em;"><span class="texatom" id="MathJax-Span-1806"><span class="mrow" id="MathJax-Span-1807"><span class="mi" id="MathJax-Span-1808" style="font-size: 50%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1809" style="font-size: 50%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em 1002em 1.21em -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1810"><span style="display: inline-block; position: relative; width: 1.071em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1811" style="font-family: STIXGeneral-Italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.699em;"><span class="mi" id="MathJax-Span-1812" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1813"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1814" style="font-family: STIXGeneral-Italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.699em;"><span class="mi" id="MathJax-Span-1815" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(2.836em 1004.37em 4.694em -999.998em); top: -4.039em; left: 50%; margin-left: -2.181em;"><span class="mtd" id="MathJax-Span-1816"><span class="mrow" id="MathJax-Span-1817"><span class="mfrac" id="MathJax-Span-1818"><span style="display: inline-block; position: relative; width: 2em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.393em 1001.91em 4.276em -999.998em); top: -4.55em; left: 50%; margin-left: -0.927em;"><span class="mrow" id="MathJax-Span-1819"><span class="msubsup" id="MathJax-Span-1820"><span style="display: inline-block; position: relative; width: 0.699em; height: 0px;"><span style="position: absolute; clip: rect(3.393em 1000.28em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1821" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.9em; left: 0.235em;"><span class="texatom" id="MathJax-Span-1822"><span class="mrow" id="MathJax-Span-1823"><span class="mi" id="MathJax-Span-1824" style="font-size: 50%; font-family: STIXGeneral-Italic;">z</span><span class="mi" id="MathJax-Span-1825" style="font-size: 50%; font-family: STIXGeneral-Italic;">z</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-1826" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="msubsup" id="MathJax-Span-1827"><span style="display: inline-block; position: relative; width: 0.746em; height: 0px;"><span style="position: absolute; clip: rect(3.393em 1000.28em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1828" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.9em; left: 0.235em;"><span class="texatom" id="MathJax-Span-1829"><span class="mrow" id="MathJax-Span-1830"><span class="mi" id="MathJax-Span-1831" style="font-size: 50%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1832" style="font-size: 50%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.393em 1000.75em 4.369em -999.998em); top: -3.621em; left: 50%; margin-left: -0.369em;"><span class="msubsup" id="MathJax-Span-1833"><span style="display: inline-block; position: relative; width: 0.746em; height: 0px;"><span style="position: absolute; clip: rect(3.393em 1000.28em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1834" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.9em; left: 0.235em;"><span class="texatom" id="MathJax-Span-1835"><span class="mrow" id="MathJax-Span-1836"><span class="mi" id="MathJax-Span-1837" style="font-size: 50%; font-family: STIXGeneral-Italic;">y</span><span class="mi" id="MathJax-Span-1838" style="font-size: 50%; font-family: STIXGeneral-Italic;">y</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em 1002em 1.21em -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1839"><span style="display: inline-block; position: relative; width: 1.071em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1840" style="font-family: STIXGeneral-Italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.699em;"><span class="mi" id="MathJax-Span-1841" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1842"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1843" style="font-family: STIXGeneral-Italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.699em;"><span class="mi" id="MathJax-Span-1844" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(2.789em 1004.46em 4.647em -999.998em); top: -1.949em; left: 50%; margin-left: -2.227em;"><span class="mtd" id="MathJax-Span-1845"><span class="mrow" id="MathJax-Span-1846"><span class="mfrac" id="MathJax-Span-1847"><span style="display: inline-block; position: relative; width: 2.093em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.393em 1001.95em 4.369em -999.998em); top: -4.596em; left: 50%; margin-left: -0.973em;"><span class="mrow" id="MathJax-Span-1848"><span class="msubsup" id="MathJax-Span-1849"><span style="display: inline-block; position: relative; width: 0.746em; height: 0px;"><span style="position: absolute; clip: rect(3.393em 1000.28em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1850" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.9em; left: 0.235em;"><span class="texatom" id="MathJax-Span-1851"><span class="mrow" id="MathJax-Span-1852"><span class="mi" id="MathJax-Span-1853" style="font-size: 50%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1854" style="font-size: 50%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-1855" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="msubsup" id="MathJax-Span-1856"><span style="display: inline-block; position: relative; width: 0.746em; height: 0px;"><span style="position: absolute; clip: rect(3.393em 1000.28em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1857" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.9em; left: 0.235em;"><span class="texatom" id="MathJax-Span-1858"><span class="mrow" id="MathJax-Span-1859"><span class="mi" id="MathJax-Span-1860" style="font-size: 50%; font-family: STIXGeneral-Italic;">y</span><span class="mi" id="MathJax-Span-1861" style="font-size: 50%; font-family: STIXGeneral-Italic;">y</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.393em 1000.7em 4.276em -999.998em); top: -3.621em; left: 50%; margin-left: -0.323em;"><span class="msubsup" id="MathJax-Span-1862"><span style="display: inline-block; position: relative; width: 0.699em; height: 0px;"><span style="position: absolute; clip: rect(3.393em 1000.28em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1863" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.9em; left: 0.235em;"><span class="texatom" id="MathJax-Span-1864"><span class="mrow" id="MathJax-Span-1865"><span class="mi" id="MathJax-Span-1866" style="font-size: 50%; font-family: STIXGeneral-Italic;">z</span><span class="mi" id="MathJax-Span-1867" style="font-size: 50%; font-family: STIXGeneral-Italic;">z</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em 1002.09em 1.21em -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.093em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1868"><span style="display: inline-block; position: relative; width: 1.071em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1869" style="font-family: STIXGeneral-Italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.699em;"><span class="mi" id="MathJax-Span-1870" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1871"><span style="display: inline-block; position: relative; width: 1.071em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1872" style="font-family: STIXGeneral-Italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.699em;"><span class="mi" id="MathJax-Span-1873" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.598em;"></span></span></span></span><span class="mo" id="MathJax-Span-1874" style="vertical-align: 3.022em;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.296em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: 1.257em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.413em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.484em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -0.555em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: 0.374em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 6.598em;"></span></span></span><span style="display: inline-block; width: 0px; height: 16.446em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -9.019em; border-left: 0px solid; width: 0px; height: 18.59em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mover><msub><mi>x</mi><mn>1</mn></msub><mo>˙</mo></mover></mrow></mtd><mtd><mi></mi><mo>=</mo><msub><mi>x</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mover><msub><mi>x</mi><mn>2</mn></msub><mo>˙</mo></mover></mrow></mtd><mtd><mi></mi><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mo>−</mo><mi>g</mi></mtd></mtr></mtable><mo>]</mo></mrow></mrow><mo>+</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><mi>R</mi><msub><mi>T</mi><mi>B</mi></msub><mo>+</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><msub><mi>F</mi><mi>D</mi></msub></mtd></mtr><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mover><msub><mi>x</mi><mn>3</mn></msub><mo>˙</mo></mover></mrow></mtd><mtd><mi></mi><mo>=</mo><msup><mrow class="MJX-TeXAtom-ORD"><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mo>−</mo><msub><mi>s</mi><mi>θ</mi></msub></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><msub><mi>c</mi><mi>ϕ</mi></msub></mtd><mtd><msub><mi>c</mi><mi>θ</mi></msub><msub><mi>s</mi><mi>ϕ</mi></msub></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mo>−</mo><msub><mi>s</mi><mi>ϕ</mi></msub></mtd><mtd><msub><mi>c</mi><mi>θ</mi></msub><msub><mi>c</mi><mi>ϕ</mi></msub></mtd></mtr></mtable><mo>]</mo></mrow></mrow><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup><msub><mi>x</mi><mn>4</mn></msub></mtd></mtr><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mover><msub><mi>x</mi><mn>4</mn></msub><mo>˙</mo></mover></mrow></mtd><mtd><mi></mi><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>τ</mi><mi>ϕ</mi></msub><msup><mrow class="MJX-TeXAtom-ORD"><msub><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mi>x</mi></mrow></msub></mrow><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup></mtd></mtr><mtr><mtd><msub><mi>τ</mi><mi>θ</mi></msub><msup><mrow class="MJX-TeXAtom-ORD"><msub><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi><mi>y</mi></mrow></msub></mrow><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup></mtd></mtr><mtr><mtd><msub><mi>τ</mi><mi>ψ</mi></msub><msup><mrow class="MJX-TeXAtom-ORD"><msub><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mi>z</mi><mi>z</mi></mrow></msub></mrow><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup></mtd></mtr></mtable><mo>]</mo></mrow></mrow><mo>−</mo><mrow class="MJX-TeXAtom-ORD"><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mfrac><mrow><msub><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi><mi>y</mi></mrow></msub><mo>−</mo><msub><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mi>z</mi><mi>z</mi></mrow></msub></mrow><msub><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mi>x</mi></mrow></msub></mfrac><msub><mi>ω</mi><mi>y</mi></msub><msub><mi>ω</mi><mi>z</mi></msub></mtd></mtr><mtr><mtd><mfrac><mrow><msub><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mi>z</mi><mi>z</mi></mrow></msub><mo>−</mo><msub><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mi>x</mi></mrow></msub></mrow><msub><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi><mi>y</mi></mrow></msub></mfrac><msub><mi>ω</mi><mi>x</mi></msub><msub><mi>ω</mi><mi>z</mi></msub></mtd></mtr><mtr><mtd><mfrac><mrow><msub><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mi>x</mi></mrow></msub><mo>−</mo><msub><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi><mi>y</mi></mrow></msub></mrow><msub><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mi>z</mi><mi>z</mi></mrow></msub></mfrac><msub><mi>ω</mi><mi>x</mi></msub><msub><mi>ω</mi><mi>y</mi></msub></mtd></mtr></mtable><mo>]</mo></mrow></mrow></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-102">\begin{aligned}
    \dot{x_1} &= x_2 \\
    \dot{x_2} &= {\begin{bmatrix} 0 \\ 0 \\ -g\end{bmatrix}} + \frac{1}{m} RT_B + \frac{1}{m} F_D \\
    \dot{x_3} &= {\begin{bmatrix} 
        1 &0 & -s_\theta \\
        0 & c_\phi & c_\theta s_\phi \\
        0 & -s_\phi & c_\theta c_\phi
    \end{bmatrix}}^{-1} x_4 \\
    \dot{x_4} &=  {\begin{bmatrix} 
        \tau_\phi {I_{xx}}^{-1} \\
        \tau_\theta {I_{yy}}^{-1} \\
        \tau_\psi {I_{zz}}^{-1}
    \end{bmatrix}} - {\begin{bmatrix} 
        \frac{I_{yy} - I_{zz}}{I_{xx}} \omega_y\omega_z \\ 
        \frac{I_{zz} - I_{xx}}{I_{yy}} \omega_x\omega_z  \\
        \frac{I_{xx} - I_{yy}}{I_{zz}} \omega_x\omega_y
    \end{bmatrix}}\end{aligned}</script></span> Note that our inputs are not used in these equations directly. However, as we will see, we can choose values for <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-103-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1875" style="width: 0.513em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(2em 1000.42em 2.696em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-1876"><span class="mi" id="MathJax-Span-1877" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.601em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>τ</mi></math></span></span><script type="math/tex" id="MathJax-Element-103">\tau</script></span> and <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-104-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1878" style="width: 0.792em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.767em 1000.65em 2.696em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-1879"><span class="mi" id="MathJax-Span-1880" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.095em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.872em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-104">T</script></span>, and then solve for values of <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-105-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1881" style="width: 0.838em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.699em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.675em 1000.7em 2.557em -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-1882"><span class="msubsup" id="MathJax-Span-1883"><span style="display: inline-block; position: relative; width: 0.699em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.322em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1884" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.42em;"><span class="mi" id="MathJax-Span-1885" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.269em; border-left: 0px solid; width: 0px; height: 0.872em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>γ</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-105">\gamma_i</script></span>.</p>
<h2 id="pd-control" class="unnumbered">PD Control</h2>
<p>In order to control the quadcopter, we will use a PD control, with a component proportional to the error between our desired trajectory and the observed trajectory, and a component proportional to the derivative of the error. Our quadcopter will only have a gyro, so we will only be able to use the angle derivatives <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-106-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1886" style="width: 0.746em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.606em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.21em 1000.56em 2.557em -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-1887"><span class="texatom" id="MathJax-Span-1888"><span class="mrow" id="MathJax-Span-1889"><span class="munderover" id="MathJax-Span-1890"><span style="display: inline-block; position: relative; width: 0.606em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.61em 4.322em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1891" style="font-family: STIXGeneral-Italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.254em 1000.24em 3.626em -999.998em); top: -4.271em; left: 0.142em;"><span class="mo" id="MathJax-Span-1892" style="font-family: STIXGeneral-Regular;">˙</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.269em; border-left: 0px solid; width: 0px; height: 1.416em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mi>ϕ</mi><mo>˙</mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-106">\dot\phi</script></span>, <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-107-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1893" style="width: 0.606em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.513em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.21em 1000.51em 2.371em -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-1894"><span class="texatom" id="MathJax-Span-1895"><span class="mrow" id="MathJax-Span-1896"><span class="munderover" id="MathJax-Span-1897"><span style="display: inline-block; position: relative; width: 0.513em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.51em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1898" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.254em 1000.24em 3.626em -999.998em); top: -4.271em; left: 0.095em;"><span class="mo" id="MathJax-Span-1899" style="font-family: STIXGeneral-Regular;">˙</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 1.144em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mi>θ</mi><mo>˙</mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-107">\dot\theta</script></span>, and <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-108-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03C8;&lt;/mi&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1900" style="width: 0.792em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.442em 1000.65em 2.557em -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-1901"><span class="texatom" id="MathJax-Span-1902"><span class="mrow" id="MathJax-Span-1903"><span class="munderover" id="MathJax-Span-1904"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.322em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1905" style="font-family: STIXGeneral-Italic;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.095em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.254em 1000.24em 3.626em -999.998em); top: -4.039em; left: 0.235em;"><span class="mo" id="MathJax-Span-1906" style="font-family: STIXGeneral-Regular;">˙</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.269em; border-left: 0px solid; width: 0px; height: 1.144em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mi>ψ</mi><mo>˙</mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-108">\dot\psi</script></span> in our controller; these measured values will give us the derivative of our error, and their integral will provide us with the actual error. We would like to stabilize the helicopter in a horizontal position, so our desired velocities and angles will all be zero. Torques are related to our angular velocities by <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-109-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x00A8;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1907" style="width: 3.115em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.65em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.535em 1002.65em 2.696em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-1908"><span class="mi" id="MathJax-Span-1909" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1910" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="mi" id="MathJax-Span-1911" style="font-family: STIXGeneral-Italic; padding-left: 0.327em;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="texatom" id="MathJax-Span-1912"><span class="mrow" id="MathJax-Span-1913"><span class="munderover" id="MathJax-Span-1914"><span style="display: inline-block; position: relative; width: 0.513em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.51em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1915" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.254em 1000.33em 3.626em -999.998em); top: -4.271em; left: 0.095em;"><span class="mo" id="MathJax-Span-1916" style="font-family: STIXGeneral-Regular;">¨</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 1.144em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>τ</mi><mo>=</mo><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mover><mi>θ</mi><mo>¨</mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-109">\tau = I\ddot\theta</script></span>, so we would like to set the torques proportional to the output of our controller, with <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-110-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1917" style="width: 4.183em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.579em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.721em 1003.53em 2.882em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-1918"><span class="mi" id="MathJax-Span-1919" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1920" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="mi" id="MathJax-Span-1921" style="font-family: STIXGeneral-Italic; padding-left: 0.327em;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mi" id="MathJax-Span-1922" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-1923" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1924" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1925" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.269em; border-left: 0px solid; width: 0px; height: 1.09em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>τ</mi><mo>=</mo><mi>I</mi><mi>u</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-110">\tau = I u(t)</script></span>. Thus, <span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-111-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mi&gt;&amp;#x03C8;&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/msub&gt;&lt;msubsup&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;d&lt;/mtext&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;/mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/msub&gt;&lt;msubsup&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;d&lt;/mtext&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;/mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03C8;&lt;/mi&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/msub&gt;&lt;msubsup&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03C8;&lt;/mi&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;d&lt;/mtext&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;/mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1926" style="width: 18.072em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.424em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(2.325em 1015.38em 9.06em -999.998em); top: -5.943em; left: 0em;"><span class="mrow" id="MathJax-Span-1927"><span class="texatom" id="MathJax-Span-1928"><span class="mrow" id="MathJax-Span-1929"><span class="mrow" id="MathJax-Span-1930"><span class="mo" id="MathJax-Span-1931" style="vertical-align: 2.278em;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.296em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.23em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.552em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.763em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -0.973em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mtable" id="MathJax-Span-1932" style="padding-right: 0.188em; padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px;"><span style="position: absolute; clip: rect(2.696em 1000.98em 6.691em -999.998em); top: -4.736em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.93em 4.415em -999.998em); top: -5.479em; left: 50%; margin-left: -0.462em;"><span class="mtd" id="MathJax-Span-1933"><span class="mrow" id="MathJax-Span-1934"><span class="msubsup" id="MathJax-Span-1935"><span style="display: inline-block; position: relative; width: 0.931em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1936" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.42em;"><span class="mi" id="MathJax-Span-1937" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.44em 1000.84em 4.276em -999.998em); top: -3.946em; left: 50%; margin-left: -0.416em;"><span class="mtd" id="MathJax-Span-1938"><span class="mrow" id="MathJax-Span-1939"><span class="msubsup" id="MathJax-Span-1940"><span style="display: inline-block; position: relative; width: 0.838em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1941" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.42em;"><span class="mi" id="MathJax-Span-1942" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.44em 1000.98em 4.415em -999.998em); top: -2.506em; left: 50%; margin-left: -0.462em;"><span class="mtd" id="MathJax-Span-1943"><span class="mrow" id="MathJax-Span-1944"><span class="msubsup" id="MathJax-Span-1945"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1946" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.42em;"><span class="mi" id="MathJax-Span-1947" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.74em;"></span></span></span></span><span class="mo" id="MathJax-Span-1948" style="vertical-align: 2.278em;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.296em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.23em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.552em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.763em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -0.973em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span></span><span class="mo" id="MathJax-Span-1949" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="texatom" id="MathJax-Span-1950" style="padding-left: 0.327em;"><span class="mrow" id="MathJax-Span-1951"><span class="mrow" id="MathJax-Span-1952"><span class="mo" id="MathJax-Span-1953" style="vertical-align: 3.486em;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.296em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: 2.139em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.413em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.484em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -0.602em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: 0.327em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: 1.21em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mtable" id="MathJax-Span-1954" style="padding-right: 0.188em; padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 10.5em; height: 0px;"><span style="position: absolute; clip: rect(3.811em 1010.36em 10.547em -999.998em); top: -7.43em; left: 0em;"><span style="display: inline-block; position: relative; width: 10.5em; height: 0px;"><span style="position: absolute; clip: rect(2.696em 1010.36em 4.787em -999.998em); top: -6.269em; left: 50%; margin-left: -5.247em;"><span class="mtd" id="MathJax-Span-1955"><span class="mrow" id="MathJax-Span-1956"><span class="mo" id="MathJax-Span-1957" style="font-family: STIXGeneral-Regular;">−</span><span class="msubsup" id="MathJax-Span-1958"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.37em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1959" style="font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.327em;"><span class="texatom" id="MathJax-Span-1960"><span class="mrow" id="MathJax-Span-1961"><span class="mi" id="MathJax-Span-1962" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1963" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mrow" id="MathJax-Span-1964" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-1965" style="vertical-align: -0.369em;"><span style="font-family: STIXSizeTwoSym;">(</span></span><span class="mrow" id="MathJax-Span-1966"><span class="msubsup" id="MathJax-Span-1967"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.75em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1968" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.653em;"><span class="mi" id="MathJax-Span-1969" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1970"><span class="mrow" id="MathJax-Span-1971"><span class="munderover" id="MathJax-Span-1972"><span style="display: inline-block; position: relative; width: 0.606em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.61em 4.322em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1973" style="font-family: STIXGeneral-Italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.254em 1000.24em 3.626em -999.998em); top: -4.271em; left: 0.142em;"><span class="mo" id="MathJax-Span-1974" style="font-family: STIXGeneral-Regular;">˙</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-1975" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">+</span><span class="msubsup" id="MathJax-Span-1976" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.75em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1977" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.653em;"><span class="mi" id="MathJax-Span-1978" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1979" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(3.022em 1000.65em 4.462em -999.998em); top: -3.992em; left: 0em;"><span class="mo" id="MathJax-Span-1980" style="font-family: STIXGeneral-Regular; vertical-align: 0.002em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.188em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.393em 1000.51em 4.136em -999.998em); top: -4.55em; left: 0.746em;"><span class="mi" id="MathJax-Span-1981" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.393em 1000.42em 4.136em -999.998em); top: -3.621em; left: 0.467em;"><span class="mn" id="MathJax-Span-1982" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1983" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-1984"><span class="munderover" id="MathJax-Span-1985"><span style="display: inline-block; position: relative; width: 0.606em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.61em 4.322em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1986" style="font-family: STIXGeneral-Italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.254em 1000.24em 3.626em -999.998em); top: -4.271em; left: 0.142em;"><span class="mo" id="MathJax-Span-1987" style="font-family: STIXGeneral-Regular;">˙</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="texatom" id="MathJax-Span-1988"><span class="mrow" id="MathJax-Span-1989"><span class="mtext" id="MathJax-Span-1990" style="font-family: STIXGeneral-Regular;">d</span><span class="mspace" id="MathJax-Span-1991" style="height: 0em; vertical-align: 0em; width: 0.327em; display: inline-block; overflow: hidden;"></span></span></span><span class="mi" id="MathJax-Span-1992" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span class="mo" id="MathJax-Span-1993" style="vertical-align: -0.369em;"><span style="font-family: STIXSizeTwoSym;">)</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(2.696em 1010.08em 4.787em -999.998em); top: -3.992em; left: 50%; margin-left: -5.107em;"><span class="mtd" id="MathJax-Span-1994"><span class="mrow" id="MathJax-Span-1995"><span class="mo" id="MathJax-Span-1996" style="font-family: STIXGeneral-Regular;">−</span><span class="msubsup" id="MathJax-Span-1997"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.37em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1998" style="font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.327em;"><span class="texatom" id="MathJax-Span-1999"><span class="mrow" id="MathJax-Span-2000"><span class="mi" id="MathJax-Span-2001" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">y</span><span class="mi" id="MathJax-Span-2002" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">y</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mrow" id="MathJax-Span-2003" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-2004" style="vertical-align: -0.369em;"><span style="font-family: STIXSizeTwoSym;">(</span></span><span class="mrow" id="MathJax-Span-2005"><span class="msubsup" id="MathJax-Span-2006"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.75em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2007" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.653em;"><span class="mi" id="MathJax-Span-2008" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2009"><span class="mrow" id="MathJax-Span-2010"><span class="munderover" id="MathJax-Span-2011"><span style="display: inline-block; position: relative; width: 0.513em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.51em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2012" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.254em 1000.24em 3.626em -999.998em); top: -4.271em; left: 0.095em;"><span class="mo" id="MathJax-Span-2013" style="font-family: STIXGeneral-Regular;">˙</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-2014" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">+</span><span class="msubsup" id="MathJax-Span-2015" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.75em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2016" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.653em;"><span class="mi" id="MathJax-Span-2017" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2018" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(3.022em 1000.65em 4.462em -999.998em); top: -3.992em; left: 0em;"><span class="mo" id="MathJax-Span-2019" style="font-family: STIXGeneral-Regular; vertical-align: 0.002em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.188em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.393em 1000.51em 4.136em -999.998em); top: -4.55em; left: 0.746em;"><span class="mi" id="MathJax-Span-2020" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.393em 1000.42em 4.136em -999.998em); top: -3.621em; left: 0.467em;"><span class="mn" id="MathJax-Span-2021" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2022" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-2023"><span class="munderover" id="MathJax-Span-2024"><span style="display: inline-block; position: relative; width: 0.513em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.51em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2025" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.254em 1000.24em 3.626em -999.998em); top: -4.271em; left: 0.095em;"><span class="mo" id="MathJax-Span-2026" style="font-family: STIXGeneral-Regular;">˙</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="texatom" id="MathJax-Span-2027"><span class="mrow" id="MathJax-Span-2028"><span class="mtext" id="MathJax-Span-2029" style="font-family: STIXGeneral-Regular;">d</span><span class="mspace" id="MathJax-Span-2030" style="height: 0em; vertical-align: 0em; width: 0.327em; display: inline-block; overflow: hidden;"></span></span></span><span class="mi" id="MathJax-Span-2031" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span class="mo" id="MathJax-Span-2032" style="vertical-align: -0.369em;"><span style="font-family: STIXSizeTwoSym;">)</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(2.696em 1010.36em 4.787em -999.998em); top: -1.716em; left: 50%; margin-left: -5.247em;"><span class="mtd" id="MathJax-Span-2033"><span class="mrow" id="MathJax-Span-2034"><span class="mo" id="MathJax-Span-2035" style="font-family: STIXGeneral-Regular;">−</span><span class="msubsup" id="MathJax-Span-2036"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.37em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2037" style="font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.327em;"><span class="texatom" id="MathJax-Span-2038"><span class="mrow" id="MathJax-Span-2039"><span class="mi" id="MathJax-Span-2040" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">z</span><span class="mi" id="MathJax-Span-2041" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">z</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mrow" id="MathJax-Span-2042" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-2043" style="vertical-align: -0.369em;"><span style="font-family: STIXSizeTwoSym;">(</span></span><span class="mrow" id="MathJax-Span-2044"><span class="msubsup" id="MathJax-Span-2045"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.75em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2046" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.653em;"><span class="mi" id="MathJax-Span-2047" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2048"><span class="mrow" id="MathJax-Span-2049"><span class="munderover" id="MathJax-Span-2050"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.322em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2051" style="font-family: STIXGeneral-Italic;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.095em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.254em 1000.24em 3.626em -999.998em); top: -4.039em; left: 0.235em;"><span class="mo" id="MathJax-Span-2052" style="font-family: STIXGeneral-Regular;">˙</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-2053" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">+</span><span class="msubsup" id="MathJax-Span-2054" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.75em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2055" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.653em;"><span class="mi" id="MathJax-Span-2056" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2057" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(3.022em 1000.65em 4.462em -999.998em); top: -3.992em; left: 0em;"><span class="mo" id="MathJax-Span-2058" style="font-family: STIXGeneral-Regular; vertical-align: 0.002em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.188em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.393em 1000.51em 4.136em -999.998em); top: -4.55em; left: 0.746em;"><span class="mi" id="MathJax-Span-2059" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.393em 1000.42em 4.136em -999.998em); top: -3.621em; left: 0.467em;"><span class="mn" id="MathJax-Span-2060" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2061" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-2062"><span class="munderover" id="MathJax-Span-2063"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.322em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2064" style="font-family: STIXGeneral-Italic;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.095em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.254em 1000.24em 3.626em -999.998em); top: -4.039em; left: 0.235em;"><span class="mo" id="MathJax-Span-2065" style="font-family: STIXGeneral-Regular;">˙</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="texatom" id="MathJax-Span-2066"><span class="mrow" id="MathJax-Span-2067"><span class="mtext" id="MathJax-Span-2068" style="font-family: STIXGeneral-Regular;">d</span><span class="mspace" id="MathJax-Span-2069" style="height: 0em; vertical-align: 0em; width: 0.327em; display: inline-block; overflow: hidden;"></span></span></span><span class="mi" id="MathJax-Span-2070" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span class="mo" id="MathJax-Span-2071" style="vertical-align: -0.369em;"><span style="font-family: STIXSizeTwoSym;">)</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span><span style="display: inline-block; width: 0px; height: 7.435em;"></span></span></span></span><span class="mo" id="MathJax-Span-2072" style="vertical-align: 3.486em;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.296em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: 2.139em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.413em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.484em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -0.602em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: 0.327em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: 1.21em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 5.948em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -3.53em; border-left: 0px solid; width: 0px; height: 7.666em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>τ</mi><mi>ϕ</mi></msub></mtd></mtr><mtr><mtd><msub><mi>τ</mi><mi>θ</mi></msub></mtd></mtr><mtr><mtd><msub><mi>τ</mi><mi>ψ</mi></msub></mtd></mtr></mtable><mo>]</mo></mrow></mrow><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mo>−</mo><msub><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mi>x</mi></mrow></msub><mrow><mo>(</mo><mrow><msub><mi>K</mi><mi>d</mi></msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>ϕ</mi><mo>˙</mo></mover></mrow><mo>+</mo><msub><mi>K</mi><mi>p</mi></msub><msubsup><mo>∫</mo><mn>0</mn><mi>T</mi></msubsup><mrow class="MJX-TeXAtom-ORD"><mover><mi>ϕ</mi><mo>˙</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mtext>d</mtext><mspace width="thickmathspace"></mspace></mrow><mi>t</mi></mrow><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mo>−</mo><msub><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi><mi>y</mi></mrow></msub><mrow><mo>(</mo><mrow><msub><mi>K</mi><mi>d</mi></msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>θ</mi><mo>˙</mo></mover></mrow><mo>+</mo><msub><mi>K</mi><mi>p</mi></msub><msubsup><mo>∫</mo><mn>0</mn><mi>T</mi></msubsup><mrow class="MJX-TeXAtom-ORD"><mover><mi>θ</mi><mo>˙</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mtext>d</mtext><mspace width="thickmathspace"></mspace></mrow><mi>t</mi></mrow><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mo>−</mo><msub><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mi>z</mi><mi>z</mi></mrow></msub><mrow><mo>(</mo><mrow><msub><mi>K</mi><mi>d</mi></msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>ψ</mi><mo>˙</mo></mover></mrow><mo>+</mo><msub><mi>K</mi><mi>p</mi></msub><msubsup><mo>∫</mo><mn>0</mn><mi>T</mi></msubsup><mrow class="MJX-TeXAtom-ORD"><mover><mi>ψ</mi><mo>˙</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mtext>d</mtext><mspace width="thickmathspace"></mspace></mrow><mi>t</mi></mrow><mo>)</mo></mrow></mtd></mtr></mtable><mo>]</mo></mrow></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-111">{\begin{bmatrix} \tau_\phi \\ \tau_\theta \\ \tau_\psi\end{bmatrix}} = {\begin{bmatrix} 
    -I_{xx} \left( K_d\dot\phi + K_p \int_0^T \dot\phi {\text{d}\;}t \right) \\
    -I_{yy} \left( K_d\dot\theta + K_p \int_0^T \dot\theta {\text{d}\;}t \right) \\
    -I_{zz} \left( K_d\dot\psi + K_p \int_0^T \dot\psi {\text{d}\;}t \right) \\
\end{bmatrix}}</script></span> We have previously derived the relationship between torque and our inputs, so we know that <span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-112-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/msub&gt;&lt;msubsup&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;d&lt;/mtext&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;/mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/msub&gt;&lt;msubsup&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;d&lt;/mtext&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;/mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03C8;&lt;/mi&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/msub&gt;&lt;msubsup&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03C8;&lt;/mi&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;d&lt;/mtext&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;/mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2073" style="width: 29.127em; display: inline-block;"><span style="display: inline-block; position: relative; width: 24.9em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(2.325em 1024.85em 9.06em -999.998em); top: -5.943em; left: 0em;"><span class="mrow" id="MathJax-Span-2074"><span class="msubsup" id="MathJax-Span-2075"><span style="display: inline-block; position: relative; width: 0.931em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2076" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.42em;"><span class="mi" id="MathJax-Span-2077" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">B</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-2078" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="texatom" id="MathJax-Span-2079" style="padding-left: 0.327em;"><span class="mrow" id="MathJax-Span-2080"><span class="mrow" id="MathJax-Span-2081"><span class="mo" id="MathJax-Span-2082" style="vertical-align: 2.232em;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.296em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.369em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.32em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.345em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mtable" id="MathJax-Span-2083" style="padding-right: 0.188em; padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 8.178em; height: 0px;"><span style="position: absolute; clip: rect(2.557em 1008.13em 6.645em -999.998em); top: -4.782em; left: 0em;"><span style="display: inline-block; position: relative; width: 8.178em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1004.46em 4.322em -999.998em); top: -5.386em; left: 50%; margin-left: -2.274em;"><span class="mtd" id="MathJax-Span-2084"><span class="mrow" id="MathJax-Span-2085"><span class="mi" id="MathJax-Span-2086" style="font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2087" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-2088" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-2089"><span class="mrow" id="MathJax-Span-2090"><span class="msubsup" id="MathJax-Span-2091"><span style="display: inline-block; position: relative; width: 0.838em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.322em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2092" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.42em;"><span class="mn" id="MathJax-Span-2093" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-2094" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">−</span><span class="texatom" id="MathJax-Span-2095" style="padding-left: 0.235em;"><span class="mrow" id="MathJax-Span-2096"><span class="msubsup" id="MathJax-Span-2097"><span style="display: inline-block; position: relative; width: 0.838em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.322em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2098" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.42em;"><span class="mn" id="MathJax-Span-2099" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">3</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-2100" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em 1004.46em 4.322em -999.998em); top: -3.946em; left: 50%; margin-left: -2.274em;"><span class="mtd" id="MathJax-Span-2101"><span class="mrow" id="MathJax-Span-2102"><span class="mi" id="MathJax-Span-2103" style="font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2104" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-2105" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-2106"><span class="mrow" id="MathJax-Span-2107"><span class="msubsup" id="MathJax-Span-2108"><span style="display: inline-block; position: relative; width: 0.838em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.322em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2109" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.42em;"><span class="mn" id="MathJax-Span-2110" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-2111" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">−</span><span class="texatom" id="MathJax-Span-2112" style="padding-left: 0.235em;"><span class="mrow" id="MathJax-Span-2113"><span class="msubsup" id="MathJax-Span-2114"><span style="display: inline-block; position: relative; width: 0.838em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.322em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2115" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.42em;"><span class="mn" id="MathJax-Span-2116" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">4</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-2117" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em 1008.13em 4.322em -999.998em); top: -2.506em; left: 50%; margin-left: -4.085em;"><span class="mtd" id="MathJax-Span-2118"><span class="mrow" id="MathJax-Span-2119"><span class="mi" id="MathJax-Span-2120" style="font-family: STIXGeneral-Italic;">b</span><span class="mrow" id="MathJax-Span-2121" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-2122" style="vertical-align: 0em;"><span style="font-family: STIXGeneral-Regular;">(</span></span><span class="mrow" id="MathJax-Span-2123"><span class="texatom" id="MathJax-Span-2124"><span class="mrow" id="MathJax-Span-2125"><span class="msubsup" id="MathJax-Span-2126"><span style="display: inline-block; position: relative; width: 0.838em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.322em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2127" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.42em;"><span class="mn" id="MathJax-Span-2128" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-2129" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">−</span><span class="texatom" id="MathJax-Span-2130" style="padding-left: 0.235em;"><span class="mrow" id="MathJax-Span-2131"><span class="msubsup" id="MathJax-Span-2132"><span style="display: inline-block; position: relative; width: 0.838em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.322em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2133" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.42em;"><span class="mn" id="MathJax-Span-2134" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-2135" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">+</span><span class="texatom" id="MathJax-Span-2136" style="padding-left: 0.235em;"><span class="mrow" id="MathJax-Span-2137"><span class="msubsup" id="MathJax-Span-2138"><span style="display: inline-block; position: relative; width: 0.838em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.322em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2139" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.42em;"><span class="mn" id="MathJax-Span-2140" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">3</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-2141" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">−</span><span class="texatom" id="MathJax-Span-2142" style="padding-left: 0.235em;"><span class="mrow" id="MathJax-Span-2143"><span class="msubsup" id="MathJax-Span-2144"><span style="display: inline-block; position: relative; width: 0.838em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.322em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2145" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.42em;"><span class="mn" id="MathJax-Span-2146" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">4</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span></span><span class="mo" id="MathJax-Span-2147" style="vertical-align: 0em;"><span style="font-family: STIXGeneral-Regular;">)</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.787em;"></span></span></span></span><span class="mo" id="MathJax-Span-2148" style="vertical-align: 2.232em;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.296em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.369em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.32em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.345em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span></span><span class="mo" id="MathJax-Span-2149" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="texatom" id="MathJax-Span-2150" style="padding-left: 0.327em;"><span class="mrow" id="MathJax-Span-2151"><span class="mrow" id="MathJax-Span-2152"><span class="mo" id="MathJax-Span-2153" style="vertical-align: 3.486em;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.296em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: 2.139em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.413em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.484em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -0.602em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: 0.327em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: 1.21em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mtable" id="MathJax-Span-2154" style="padding-right: 0.188em; padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 10.5em; height: 0px;"><span style="position: absolute; clip: rect(3.811em 1010.36em 10.547em -999.998em); top: -7.43em; left: 0em;"><span style="display: inline-block; position: relative; width: 10.5em; height: 0px;"><span style="position: absolute; clip: rect(2.696em 1010.36em 4.787em -999.998em); top: -6.269em; left: 50%; margin-left: -5.247em;"><span class="mtd" id="MathJax-Span-2155"><span class="mrow" id="MathJax-Span-2156"><span class="mo" id="MathJax-Span-2157" style="font-family: STIXGeneral-Regular;">−</span><span class="msubsup" id="MathJax-Span-2158"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.37em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2159" style="font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.327em;"><span class="texatom" id="MathJax-Span-2160"><span class="mrow" id="MathJax-Span-2161"><span class="mi" id="MathJax-Span-2162" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2163" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mrow" id="MathJax-Span-2164" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-2165" style="vertical-align: -0.369em;"><span style="font-family: STIXSizeTwoSym;">(</span></span><span class="mrow" id="MathJax-Span-2166"><span class="msubsup" id="MathJax-Span-2167"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.75em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2168" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.653em;"><span class="mi" id="MathJax-Span-2169" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2170"><span class="mrow" id="MathJax-Span-2171"><span class="munderover" id="MathJax-Span-2172"><span style="display: inline-block; position: relative; width: 0.606em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.61em 4.322em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2173" style="font-family: STIXGeneral-Italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.254em 1000.24em 3.626em -999.998em); top: -4.271em; left: 0.142em;"><span class="mo" id="MathJax-Span-2174" style="font-family: STIXGeneral-Regular;">˙</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-2175" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">+</span><span class="msubsup" id="MathJax-Span-2176" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.75em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2177" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.653em;"><span class="mi" id="MathJax-Span-2178" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2179" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(3.022em 1000.65em 4.462em -999.998em); top: -3.992em; left: 0em;"><span class="mo" id="MathJax-Span-2180" style="font-family: STIXGeneral-Regular; vertical-align: 0.002em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.188em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.393em 1000.51em 4.136em -999.998em); top: -4.55em; left: 0.746em;"><span class="mi" id="MathJax-Span-2181" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.393em 1000.42em 4.136em -999.998em); top: -3.621em; left: 0.467em;"><span class="mn" id="MathJax-Span-2182" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2183" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-2184"><span class="munderover" id="MathJax-Span-2185"><span style="display: inline-block; position: relative; width: 0.606em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.61em 4.322em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2186" style="font-family: STIXGeneral-Italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.254em 1000.24em 3.626em -999.998em); top: -4.271em; left: 0.142em;"><span class="mo" id="MathJax-Span-2187" style="font-family: STIXGeneral-Regular;">˙</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="texatom" id="MathJax-Span-2188"><span class="mrow" id="MathJax-Span-2189"><span class="mtext" id="MathJax-Span-2190" style="font-family: STIXGeneral-Regular;">d</span><span class="mspace" id="MathJax-Span-2191" style="height: 0em; vertical-align: 0em; width: 0.327em; display: inline-block; overflow: hidden;"></span></span></span><span class="mi" id="MathJax-Span-2192" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span class="mo" id="MathJax-Span-2193" style="vertical-align: -0.369em;"><span style="font-family: STIXSizeTwoSym;">)</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(2.696em 1010.08em 4.787em -999.998em); top: -3.992em; left: 50%; margin-left: -5.107em;"><span class="mtd" id="MathJax-Span-2194"><span class="mrow" id="MathJax-Span-2195"><span class="mo" id="MathJax-Span-2196" style="font-family: STIXGeneral-Regular;">−</span><span class="msubsup" id="MathJax-Span-2197"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.37em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2198" style="font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.327em;"><span class="texatom" id="MathJax-Span-2199"><span class="mrow" id="MathJax-Span-2200"><span class="mi" id="MathJax-Span-2201" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">y</span><span class="mi" id="MathJax-Span-2202" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">y</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mrow" id="MathJax-Span-2203" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-2204" style="vertical-align: -0.369em;"><span style="font-family: STIXSizeTwoSym;">(</span></span><span class="mrow" id="MathJax-Span-2205"><span class="msubsup" id="MathJax-Span-2206"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.75em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2207" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.653em;"><span class="mi" id="MathJax-Span-2208" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2209"><span class="mrow" id="MathJax-Span-2210"><span class="munderover" id="MathJax-Span-2211"><span style="display: inline-block; position: relative; width: 0.513em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.51em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2212" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.254em 1000.24em 3.626em -999.998em); top: -4.271em; left: 0.095em;"><span class="mo" id="MathJax-Span-2213" style="font-family: STIXGeneral-Regular;">˙</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-2214" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">+</span><span class="msubsup" id="MathJax-Span-2215" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.75em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2216" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.653em;"><span class="mi" id="MathJax-Span-2217" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2218" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(3.022em 1000.65em 4.462em -999.998em); top: -3.992em; left: 0em;"><span class="mo" id="MathJax-Span-2219" style="font-family: STIXGeneral-Regular; vertical-align: 0.002em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.188em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.393em 1000.51em 4.136em -999.998em); top: -4.55em; left: 0.746em;"><span class="mi" id="MathJax-Span-2220" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.393em 1000.42em 4.136em -999.998em); top: -3.621em; left: 0.467em;"><span class="mn" id="MathJax-Span-2221" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2222" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-2223"><span class="munderover" id="MathJax-Span-2224"><span style="display: inline-block; position: relative; width: 0.513em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.51em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2225" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.254em 1000.24em 3.626em -999.998em); top: -4.271em; left: 0.095em;"><span class="mo" id="MathJax-Span-2226" style="font-family: STIXGeneral-Regular;">˙</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="texatom" id="MathJax-Span-2227"><span class="mrow" id="MathJax-Span-2228"><span class="mtext" id="MathJax-Span-2229" style="font-family: STIXGeneral-Regular;">d</span><span class="mspace" id="MathJax-Span-2230" style="height: 0em; vertical-align: 0em; width: 0.327em; display: inline-block; overflow: hidden;"></span></span></span><span class="mi" id="MathJax-Span-2231" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span class="mo" id="MathJax-Span-2232" style="vertical-align: -0.369em;"><span style="font-family: STIXSizeTwoSym;">)</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(2.696em 1010.36em 4.787em -999.998em); top: -1.716em; left: 50%; margin-left: -5.247em;"><span class="mtd" id="MathJax-Span-2233"><span class="mrow" id="MathJax-Span-2234"><span class="mo" id="MathJax-Span-2235" style="font-family: STIXGeneral-Regular;">−</span><span class="msubsup" id="MathJax-Span-2236"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.37em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2237" style="font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.327em;"><span class="texatom" id="MathJax-Span-2238"><span class="mrow" id="MathJax-Span-2239"><span class="mi" id="MathJax-Span-2240" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">z</span><span class="mi" id="MathJax-Span-2241" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">z</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mrow" id="MathJax-Span-2242" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-2243" style="vertical-align: -0.369em;"><span style="font-family: STIXSizeTwoSym;">(</span></span><span class="mrow" id="MathJax-Span-2244"><span class="msubsup" id="MathJax-Span-2245"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.75em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2246" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.653em;"><span class="mi" id="MathJax-Span-2247" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2248"><span class="mrow" id="MathJax-Span-2249"><span class="munderover" id="MathJax-Span-2250"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.322em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2251" style="font-family: STIXGeneral-Italic;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.095em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.254em 1000.24em 3.626em -999.998em); top: -4.039em; left: 0.235em;"><span class="mo" id="MathJax-Span-2252" style="font-family: STIXGeneral-Regular;">˙</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-2253" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">+</span><span class="msubsup" id="MathJax-Span-2254" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.75em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2255" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.653em;"><span class="mi" id="MathJax-Span-2256" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2257" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(3.022em 1000.65em 4.462em -999.998em); top: -3.992em; left: 0em;"><span class="mo" id="MathJax-Span-2258" style="font-family: STIXGeneral-Regular; vertical-align: 0.002em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.188em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.393em 1000.51em 4.136em -999.998em); top: -4.55em; left: 0.746em;"><span class="mi" id="MathJax-Span-2259" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.393em 1000.42em 4.136em -999.998em); top: -3.621em; left: 0.467em;"><span class="mn" id="MathJax-Span-2260" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2261" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-2262"><span class="munderover" id="MathJax-Span-2263"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.322em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2264" style="font-family: STIXGeneral-Italic;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.095em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.254em 1000.24em 3.626em -999.998em); top: -4.039em; left: 0.235em;"><span class="mo" id="MathJax-Span-2265" style="font-family: STIXGeneral-Regular;">˙</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="texatom" id="MathJax-Span-2266"><span class="mrow" id="MathJax-Span-2267"><span class="mtext" id="MathJax-Span-2268" style="font-family: STIXGeneral-Regular;">d</span><span class="mspace" id="MathJax-Span-2269" style="height: 0em; vertical-align: 0em; width: 0.327em; display: inline-block; overflow: hidden;"></span></span></span><span class="mi" id="MathJax-Span-2270" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span class="mo" id="MathJax-Span-2271" style="vertical-align: -0.369em;"><span style="font-family: STIXSizeTwoSym;">)</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span><span style="display: inline-block; width: 0px; height: 7.435em;"></span></span></span></span><span class="mo" id="MathJax-Span-2272" style="vertical-align: 3.486em;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.296em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: 2.139em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.413em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.484em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -0.602em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: 0.327em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: 1.21em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 5.948em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -3.53em; border-left: 0px solid; width: 0px; height: 7.666em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>τ</mi><mi>B</mi></msub><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mi>L</mi><mi>k</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><msub><mi>γ</mi><mn>1</mn></msub></mrow><mo>−</mo><mrow class="MJX-TeXAtom-ORD"><msub><mi>γ</mi><mn>3</mn></msub></mrow><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mi>L</mi><mi>k</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><msub><mi>γ</mi><mn>2</mn></msub></mrow><mo>−</mo><mrow class="MJX-TeXAtom-ORD"><msub><mi>γ</mi><mn>4</mn></msub></mrow><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mi>b</mi><mrow><mo>(</mo><mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>γ</mi><mn>1</mn></msub></mrow><mo>−</mo><mrow class="MJX-TeXAtom-ORD"><msub><mi>γ</mi><mn>2</mn></msub></mrow><mo>+</mo><mrow class="MJX-TeXAtom-ORD"><msub><mi>γ</mi><mn>3</mn></msub></mrow><mo>−</mo><mrow class="MJX-TeXAtom-ORD"><msub><mi>γ</mi><mn>4</mn></msub></mrow></mrow><mo>)</mo></mrow></mtd></mtr></mtable><mo>]</mo></mrow></mrow><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mo>−</mo><msub><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mi>x</mi></mrow></msub><mrow><mo>(</mo><mrow><msub><mi>K</mi><mi>d</mi></msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>ϕ</mi><mo>˙</mo></mover></mrow><mo>+</mo><msub><mi>K</mi><mi>p</mi></msub><msubsup><mo>∫</mo><mn>0</mn><mi>T</mi></msubsup><mrow class="MJX-TeXAtom-ORD"><mover><mi>ϕ</mi><mo>˙</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mtext>d</mtext><mspace width="thickmathspace"></mspace></mrow><mi>t</mi></mrow><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mo>−</mo><msub><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi><mi>y</mi></mrow></msub><mrow><mo>(</mo><mrow><msub><mi>K</mi><mi>d</mi></msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>θ</mi><mo>˙</mo></mover></mrow><mo>+</mo><msub><mi>K</mi><mi>p</mi></msub><msubsup><mo>∫</mo><mn>0</mn><mi>T</mi></msubsup><mrow class="MJX-TeXAtom-ORD"><mover><mi>θ</mi><mo>˙</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mtext>d</mtext><mspace width="thickmathspace"></mspace></mrow><mi>t</mi></mrow><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mo>−</mo><msub><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mi>z</mi><mi>z</mi></mrow></msub><mrow><mo>(</mo><mrow><msub><mi>K</mi><mi>d</mi></msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>ψ</mi><mo>˙</mo></mover></mrow><mo>+</mo><msub><mi>K</mi><mi>p</mi></msub><msubsup><mo>∫</mo><mn>0</mn><mi>T</mi></msubsup><mrow class="MJX-TeXAtom-ORD"><mover><mi>ψ</mi><mo>˙</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mtext>d</mtext><mspace width="thickmathspace"></mspace></mrow><mi>t</mi></mrow><mo>)</mo></mrow></mtd></mtr></mtable><mo>]</mo></mrow></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-112">\tau_B = {\begin{bmatrix} 
    Lk({\gamma_1} - {\gamma_3}) \\
    Lk({\gamma_2} - {\gamma_4}) \\
    b\left( {\gamma_1} -  {\gamma_2} +  {\gamma_3} -  {\gamma_4}\right)
\end{bmatrix}} = {\begin{bmatrix} 
    -I_{xx} \left( K_d\dot\phi + K_p \int_0^T \dot\phi {\text{d}\;}t \right) \\
    -I_{yy} \left( K_d\dot\theta + K_p \int_0^T \dot\theta {\text{d}\;}t \right) \\
    -I_{zz} \left( K_d\dot\psi + K_p \int_0^T \dot\psi {\text{d}\;}t \right) \\
\end{bmatrix}}</script></span> This gives us a set of three equations with four unknowns. We can constrain this by enforcing the constraint that our inputs must keep the quadcopter aloft: <span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-113-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2273" style="width: 4.044em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.44em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.767em 1003.39em 2.882em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-2274"><span class="mi" id="MathJax-Span-2275" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.095em;"></span></span><span class="mo" id="MathJax-Span-2276" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="mi" id="MathJax-Span-2277" style="font-family: STIXGeneral-Italic; padding-left: 0.327em;">m</span><span class="mi" id="MathJax-Span-2278" style="font-family: STIXGeneral-Italic;">g</span><span class="mo" id="MathJax-Span-2279" style="font-family: STIXGeneral-Regular;">.</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.269em; border-left: 0px solid; width: 0px; height: 1.09em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>T</mi><mo>=</mo><mi>m</mi><mi>g</mi><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-113">T = mg.</script></span> Note that this equation ignores the fact that the thrust will not be pointed directly up. This will limit the applicability of our controller, but should not cause major problems for small deviations from stability. If we had a way of determining the current angle accurately, we could compensate. If our gyro is precise enough, we can integrate the values obtained from the gyro to get the angles <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-114-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2280" style="width: 0.56em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.721em 1000.47em 2.696em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-2281"><span class="mi" id="MathJax-Span-2282" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-114">\theta</script></span> and <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-115-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2283" style="width: 0.746em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.606em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.721em 1000.56em 2.882em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-2284"><span class="mi" id="MathJax-Span-2285" style="font-family: STIXGeneral-Italic;">ϕ</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.269em; border-left: 0px solid; width: 0px; height: 1.144em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ϕ</mi></math></span></span><script type="math/tex" id="MathJax-Element-115">\phi</script></span>. In this case, we can calculate the thrust necessary to keep the quadcopter aloft by projecting the thrust <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-116-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2286" style="width: 1.442em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.21em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(2em 1001.16em 2.882em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-2287"><span class="mi" id="MathJax-Span-2288" style="font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-2289" style="font-family: STIXGeneral-Italic;">g</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.269em; border-left: 0px solid; width: 0px; height: 0.872em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mi>g</mi></math></span></span><script type="math/tex" id="MathJax-Element-116">mg</script></span> onto the inertial <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-117-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2290" style="width: 0.467em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.374em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(2em 1000.37em 2.789em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-2291"><span class="mi" id="MathJax-Span-2292" style="font-family: STIXGeneral-Italic;">z</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.16em; border-left: 0px solid; width: 0px; height: 0.709em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-117">z</script></span> axis. We find that <span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-118-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mtext&gt;proj&lt;/mtext&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2293" style="width: 10.361em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.828em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.721em 1008.78em 3.022em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-2294"><span class="msubsup" id="MathJax-Span-2295"><span style="display: inline-block; position: relative; width: 1.767em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.65em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2296" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.095em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.56em;"><span class="mtext" id="MathJax-Span-2297" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">proj</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-2298" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="mi" id="MathJax-Span-2299" style="font-family: STIXGeneral-Italic; padding-left: 0.327em;">m</span><span class="mi" id="MathJax-Span-2300" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-2301" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">cos</span><span class="mo" id="MathJax-Span-2302"></span><span class="mi" id="MathJax-Span-2303" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2304" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">cos</span><span class="mo" id="MathJax-Span-2305"></span><span class="mi" id="MathJax-Span-2306" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">ϕ</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.432em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>T</mi><mtext>proj</mtext></msub><mo>=</mo><mi>m</mi><mi>g</mi><mi>cos</mi><mo>⁡</mo><mi>θ</mi><mi>cos</mi><mo>⁡</mo><mi>ϕ</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-118">T_\text{proj} = mg\cos\theta\cos\phi</script></span> Therefore, with a precise angle measurement, we can instead enforce the requirement that the thrust be equal to <span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-119-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2307" style="width: 7.899em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.738em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.303em 1006.74em 3.579em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-2308"><span class="mi" id="MathJax-Span-2309" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.095em;"></span></span><span class="mo" id="MathJax-Span-2310" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="mfrac" id="MathJax-Span-2311" style="padding-left: 0.327em;"><span style="display: inline-block; position: relative; width: 4.462em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.44em 1001.21em 4.322em -999.998em); top: -4.689em; left: 50%; margin-left: -0.602em;"><span class="mrow" id="MathJax-Span-2312"><span class="mi" id="MathJax-Span-2313" style="font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-2314" style="font-family: STIXGeneral-Italic;">g</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em 1004.32em 4.322em -999.998em); top: -3.296em; left: 50%; margin-left: -2.181em;"><span class="mrow" id="MathJax-Span-2315"><span class="mi" id="MathJax-Span-2316" style="font-family: STIXGeneral-Regular;">cos</span><span class="mo" id="MathJax-Span-2317"></span><span class="mi" id="MathJax-Span-2318" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2319" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">cos</span><span class="mo" id="MathJax-Span-2320"></span><span class="mi" id="MathJax-Span-2321" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">ϕ</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em 1004.46em 1.21em -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.462em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.084em; border-left: 0px solid; width: 0px; height: 2.448em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>T</mi><mo>=</mo><mfrac><mrow><mi>m</mi><mi>g</mi></mrow><mrow><mi>cos</mi><mo>⁡</mo><mi>θ</mi><mi>cos</mi><mo>⁡</mo><mi>ϕ</mi></mrow></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-119">T = \frac{mg}{\cos\theta\cos\phi}</script></span> in which case the component of the thrust pointing along the positive <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-120-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2322" style="width: 0.467em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.374em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(2em 1000.37em 2.789em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-2323"><span class="mi" id="MathJax-Span-2324" style="font-family: STIXGeneral-Italic;">z</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.16em; border-left: 0px solid; width: 0px; height: 0.709em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-120">z</script></span> axis will be equal to <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-121-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2325" style="width: 1.442em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.21em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(2em 1001.16em 2.882em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-2326"><span class="mi" id="MathJax-Span-2327" style="font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-2328" style="font-family: STIXGeneral-Italic;">g</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.269em; border-left: 0px solid; width: 0px; height: 0.872em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mi>g</mi></math></span></span><script type="math/tex" id="MathJax-Element-121">mg</script></span>. We know that the thrust is proportional to a weighted sum of the inputs: <span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-122-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x27F9;&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2329" style="width: 26.526em; display: inline-block;"><span style="display: inline-block; position: relative; width: 22.67em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.721em 1022.67em 3.997em -999.998em); top: -2.971em; left: 0em;"><span class="mrow" id="MathJax-Span-2330"><span class="mi" id="MathJax-Span-2331" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.095em;"></span></span><span class="mo" id="MathJax-Span-2332" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="mfrac" id="MathJax-Span-2333" style="padding-left: 0.327em;"><span style="display: inline-block; position: relative; width: 4.462em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.44em 1001.21em 4.322em -999.998em); top: -4.689em; left: 50%; margin-left: -0.602em;"><span class="mrow" id="MathJax-Span-2334"><span class="mi" id="MathJax-Span-2335" style="font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-2336" style="font-family: STIXGeneral-Italic;">g</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em 1004.32em 4.322em -999.998em); top: -3.296em; left: 50%; margin-left: -2.181em;"><span class="mrow" id="MathJax-Span-2337"><span class="mi" id="MathJax-Span-2338" style="font-family: STIXGeneral-Regular;">cos</span><span class="mo" id="MathJax-Span-2339"></span><span class="mi" id="MathJax-Span-2340" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2341" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">cos</span><span class="mo" id="MathJax-Span-2342"></span><span class="mi" id="MathJax-Span-2343" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">ϕ</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em 1004.46em 1.21em -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.462em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mo" id="MathJax-Span-2344" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="mi" id="MathJax-Span-2345" style="font-family: STIXGeneral-Italic; padding-left: 0.327em;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-2346" style="font-family: STIXSizeOneSym; vertical-align: -0.509em; padding-left: 0.188em;">∑</span><span class="msubsup" id="MathJax-Span-2347" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.699em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.322em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2348" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.42em;"><span class="mi" id="MathJax-Span-2349" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mspace" id="MathJax-Span-2350" style="height: 0em; vertical-align: 0em; width: 0.327em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-2351" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">⟹</span><span class="mspace" id="MathJax-Span-2352" style="height: 0em; vertical-align: 0em; width: 0.327em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-2353" style="font-family: STIXSizeOneSym; vertical-align: -0.509em; padding-left: 0.327em;">∑</span><span class="msubsup" id="MathJax-Span-2354" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.699em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.322em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2355" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.42em;"><span class="mi" id="MathJax-Span-2356" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-2357" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="mfrac" id="MathJax-Span-2358" style="padding-left: 0.327em;"><span style="display: inline-block; position: relative; width: 5.112em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.44em 1001.21em 4.322em -999.998em); top: -4.689em; left: 50%; margin-left: -0.602em;"><span class="mrow" id="MathJax-Span-2359"><span class="mi" id="MathJax-Span-2360" style="font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-2361" style="font-family: STIXGeneral-Italic;">g</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em 1004.97em 4.322em -999.998em); top: -3.296em; left: 50%; margin-left: -2.506em;"><span class="mrow" id="MathJax-Span-2362"><span class="mi" id="MathJax-Span-2363" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2364" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">cos</span><span class="mo" id="MathJax-Span-2365"></span><span class="mi" id="MathJax-Span-2366" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2367" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">cos</span><span class="mo" id="MathJax-Span-2368"></span><span class="mi" id="MathJax-Span-2369" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">ϕ</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em 1005.11em 1.21em -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 5.112em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.975em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.084em; border-left: 0px solid; width: 0px; height: 2.448em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>T</mi><mo>=</mo><mfrac><mrow><mi>m</mi><mi>g</mi></mrow><mrow><mi>cos</mi><mo>⁡</mo><mi>θ</mi><mi>cos</mi><mo>⁡</mo><mi>ϕ</mi></mrow></mfrac><mo>=</mo><mi>k</mi><mo>∑</mo><msub><mi>γ</mi><mi>i</mi></msub><mspace width="thickmathspace"></mspace><mo stretchy="false">⟹</mo><mspace width="thickmathspace"></mspace><mo>∑</mo><msub><mi>γ</mi><mi>i</mi></msub><mo>=</mo><mfrac><mrow><mi>m</mi><mi>g</mi></mrow><mrow><mi>k</mi><mi>cos</mi><mo>⁡</mo><mi>θ</mi><mi>cos</mi><mo>⁡</mo><mi>ϕ</mi></mrow></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-122">T = \frac{mg}{\cos\theta\cos\phi} = k\sum \gamma_i \implies \sum\gamma_i = \frac{mg}{k\cos\theta\cos\phi}</script></span> With this extra constraint, we have a set of four linear equations with four unknowns <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-123-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2370" style="width: 0.838em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.699em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.675em 1000.7em 2.557em -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-2371"><span class="msubsup" id="MathJax-Span-2372"><span style="display: inline-block; position: relative; width: 0.699em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.322em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2373" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.42em;"><span class="mi" id="MathJax-Span-2374" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.269em; border-left: 0px solid; width: 0px; height: 0.872em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>γ</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-123">\gamma_i</script></span>. We can then solve for each <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-124-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2375" style="width: 0.838em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.699em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.675em 1000.7em 2.557em -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-2376"><span class="msubsup" id="MathJax-Span-2377"><span style="display: inline-block; position: relative; width: 0.699em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.322em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2378" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.42em;"><span class="mi" id="MathJax-Span-2379" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.269em; border-left: 0px solid; width: 0px; height: 0.872em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>γ</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-124">\gamma_i</script></span>, and obtain the following input values: <span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-125-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;&amp;#x03C8;&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;&amp;#x03C8;&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;&amp;#x03C8;&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;&amp;#x03C8;&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2380" style="width: 20.766em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.747em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(-3.296em 1017.56em 7.249em -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-2381"><span class="mtable" id="MathJax-Span-2382" style="padding-right: 0.188em; padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 17.375em; height: 0px;"><span style="position: absolute; clip: rect(5.065em 1000.84em 13.891em -999.998em); top: -9.567em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.838em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.84em 4.322em -999.998em); top: -7.941em; right: 0em;"><span class="mtd" id="MathJax-Span-2383"><span class="mrow" id="MathJax-Span-2384"><span class="msubsup" id="MathJax-Span-2385"><span style="display: inline-block; position: relative; width: 0.838em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.322em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2386" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.42em;"><span class="mn" id="MathJax-Span-2387" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.44em 1000.84em 4.322em -999.998em); top: -5.293em; right: 0em;"><span class="mtd" id="MathJax-Span-2444"><span class="mrow" id="MathJax-Span-2445"><span class="msubsup" id="MathJax-Span-2446"><span style="display: inline-block; position: relative; width: 0.838em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.322em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2447" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.42em;"><span class="mn" id="MathJax-Span-2448" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.44em 1000.84em 4.322em -999.998em); top: -2.645em; right: 0em;"><span class="mtd" id="MathJax-Span-2505"><span class="mrow" id="MathJax-Span-2506"><span class="msubsup" id="MathJax-Span-2507"><span style="display: inline-block; position: relative; width: 0.838em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.322em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2508" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.42em;"><span class="mn" id="MathJax-Span-2509" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">3</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.44em 1000.84em 4.322em -999.998em); top: 0.002em; right: 0em;"><span class="mtd" id="MathJax-Span-2567"><span class="mrow" id="MathJax-Span-2568"><span class="msubsup" id="MathJax-Span-2569"><span style="display: inline-block; position: relative; width: 0.838em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.322em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2570" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.42em;"><span class="mn" id="MathJax-Span-2571" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">4</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span><span style="display: inline-block; width: 0px; height: 9.571em;"></span></span><span style="position: absolute; clip: rect(5.716em 1016.54em 16.26em -999.998em); top: -11.239em; left: 0.838em;"><span style="display: inline-block; position: relative; width: 16.539em; height: 0px;"><span style="position: absolute; clip: rect(2.418em 1015.84em 5.019em -999.998em); top: -7.941em; left: 0em;"><span class="mtd" id="MathJax-Span-2388"><span class="mrow" id="MathJax-Span-2389"><span class="mi" id="MathJax-Span-2390"></span><span class="mo" id="MathJax-Span-2391" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="mfrac" id="MathJax-Span-2392" style="padding-left: 0.327em;"><span style="display: inline-block; position: relative; width: 5.623em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.44em 1001.21em 4.322em -999.998em); top: -4.689em; left: 50%; margin-left: -0.602em;"><span class="mrow" id="MathJax-Span-2393"><span class="mi" id="MathJax-Span-2394" style="font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-2395" style="font-family: STIXGeneral-Italic;">g</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em 1005.48em 4.322em -999.998em); top: -3.296em; left: 50%; margin-left: -2.738em;"><span class="mrow" id="MathJax-Span-2396"><span class="mn" id="MathJax-Span-2397" style="font-family: STIXGeneral-Regular;">4</span><span class="mi" id="MathJax-Span-2398" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2399" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">cos</span><span class="mo" id="MathJax-Span-2400"></span><span class="mi" id="MathJax-Span-2401" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2402" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">cos</span><span class="mo" id="MathJax-Span-2403"></span><span class="mi" id="MathJax-Span-2404" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">ϕ</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em 1005.62em 1.21em -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 5.623em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mo" id="MathJax-Span-2405" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">−</span><span class="mfrac" id="MathJax-Span-2406" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 7.249em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.161em 1007.11em 4.415em -999.998em); top: -4.736em; left: 50%; margin-left: -3.574em;"><span class="mrow" id="MathJax-Span-2407"><span class="mn" id="MathJax-Span-2408" style="font-family: STIXGeneral-Regular;">2</span><span class="mi" id="MathJax-Span-2409" style="font-family: STIXGeneral-Italic;">b</span><span class="texatom" id="MathJax-Span-2410"><span class="mrow" id="MathJax-Span-2411"><span class="msubsup" id="MathJax-Span-2412"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2413" style="font-family: STIXGeneral-Italic;">e</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-2414" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="texatom" id="MathJax-Span-2415"><span class="mrow" id="MathJax-Span-2416"><span class="msubsup" id="MathJax-Span-2417"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.37em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2418" style="font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.327em;"><span class="texatom" id="MathJax-Span-2419"><span class="mrow" id="MathJax-Span-2420"><span class="mi" id="MathJax-Span-2421" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2422" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-2423" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">+</span><span class="texatom" id="MathJax-Span-2424" style="padding-left: 0.235em;"><span class="mrow" id="MathJax-Span-2425"><span class="msubsup" id="MathJax-Span-2426"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2427" style="font-family: STIXGeneral-Italic;">e</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-2428" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="texatom" id="MathJax-Span-2429"><span class="mrow" id="MathJax-Span-2430"><span class="msubsup" id="MathJax-Span-2431"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.37em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2432" style="font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.327em;"><span class="texatom" id="MathJax-Span-2433"><span class="mrow" id="MathJax-Span-2434"><span class="mi" id="MathJax-Span-2435" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">z</span><span class="mi" id="MathJax-Span-2436" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">z</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="mi" id="MathJax-Span-2437" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2438" style="font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em 1002em 4.136em -999.998em); top: -3.296em; left: 50%; margin-left: -1.02em;"><span class="mrow" id="MathJax-Span-2439"><span class="mn" id="MathJax-Span-2440" style="font-family: STIXGeneral-Regular;">4</span><span class="mi" id="MathJax-Span-2441" style="font-family: STIXGeneral-Italic;">b</span><span class="mi" id="MathJax-Span-2442" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2443" style="font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em 1007.25em 1.21em -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 7.249em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(2.464em 1014.08em 5.019em -999.998em); top: -5.293em; left: 0em;"><span class="mtd" id="MathJax-Span-2449"><span class="mrow" id="MathJax-Span-2450"><span class="mi" id="MathJax-Span-2451"></span><span class="mo" id="MathJax-Span-2452" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="mfrac" id="MathJax-Span-2453" style="padding-left: 0.327em;"><span style="display: inline-block; position: relative; width: 5.623em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.44em 1001.21em 4.322em -999.998em); top: -4.689em; left: 50%; margin-left: -0.602em;"><span class="mrow" id="MathJax-Span-2454"><span class="mi" id="MathJax-Span-2455" style="font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-2456" style="font-family: STIXGeneral-Italic;">g</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em 1005.48em 4.322em -999.998em); top: -3.296em; left: 50%; margin-left: -2.738em;"><span class="mrow" id="MathJax-Span-2457"><span class="mn" id="MathJax-Span-2458" style="font-family: STIXGeneral-Regular;">4</span><span class="mi" id="MathJax-Span-2459" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2460" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">cos</span><span class="mo" id="MathJax-Span-2461"></span><span class="mi" id="MathJax-Span-2462" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2463" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">cos</span><span class="mo" id="MathJax-Span-2464"></span><span class="mi" id="MathJax-Span-2465" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">ϕ</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em 1005.62em 1.21em -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 5.623em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mo" id="MathJax-Span-2466" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">+</span><span class="mfrac" id="MathJax-Span-2467" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 2.093em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.207em 1001.95em 4.415em -999.998em); top: -4.736em; left: 50%; margin-left: -0.973em;"><span class="mrow" id="MathJax-Span-2468"><span class="texatom" id="MathJax-Span-2469"><span class="mrow" id="MathJax-Span-2470"><span class="msubsup" id="MathJax-Span-2471"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2472" style="font-family: STIXGeneral-Italic;">e</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-2473" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="texatom" id="MathJax-Span-2474"><span class="mrow" id="MathJax-Span-2475"><span class="msubsup" id="MathJax-Span-2476"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.37em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2477" style="font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.327em;"><span class="texatom" id="MathJax-Span-2478"><span class="mrow" id="MathJax-Span-2479"><span class="mi" id="MathJax-Span-2480" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">z</span><span class="mi" id="MathJax-Span-2481" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">z</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em 1000.98em 4.136em -999.998em); top: -3.296em; left: 50%; margin-left: -0.509em;"><span class="mrow" id="MathJax-Span-2482"><span class="mn" id="MathJax-Span-2483" style="font-family: STIXGeneral-Regular;">4</span><span class="mi" id="MathJax-Span-2484" style="font-family: STIXGeneral-Italic;">b</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em 1002.09em 1.21em -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.093em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mo" id="MathJax-Span-2485" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">−</span><span class="mfrac" id="MathJax-Span-2486" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 2.046em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.207em 1001.91em 4.415em -999.998em); top: -4.736em; left: 50%; margin-left: -0.927em;"><span class="mrow" id="MathJax-Span-2487"><span class="texatom" id="MathJax-Span-2488"><span class="mrow" id="MathJax-Span-2489"><span class="msubsup" id="MathJax-Span-2490"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2491" style="font-family: STIXGeneral-Italic;">e</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-2492" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="texatom" id="MathJax-Span-2493"><span class="mrow" id="MathJax-Span-2494"><span class="msubsup" id="MathJax-Span-2495"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.37em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2496" style="font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.327em;"><span class="texatom" id="MathJax-Span-2497"><span class="mrow" id="MathJax-Span-2498"><span class="mi" id="MathJax-Span-2499" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">y</span><span class="mi" id="MathJax-Span-2500" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">y</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em 1001.53em 4.136em -999.998em); top: -3.296em; left: 50%; margin-left: -0.741em;"><span class="mrow" id="MathJax-Span-2501"><span class="mn" id="MathJax-Span-2502" style="font-family: STIXGeneral-Regular;">2</span><span class="mi" id="MathJax-Span-2503" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2504" style="font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em 1002.05em 1.21em -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.046em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(2.418em 1016.54em 5.019em -999.998em); top: -2.645em; left: 0em;"><span class="mtd" id="MathJax-Span-2510"><span class="mrow" id="MathJax-Span-2511"><span class="mi" id="MathJax-Span-2512"></span><span class="mo" id="MathJax-Span-2513" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="mfrac" id="MathJax-Span-2514" style="padding-left: 0.327em;"><span style="display: inline-block; position: relative; width: 5.623em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.44em 1001.21em 4.322em -999.998em); top: -4.689em; left: 50%; margin-left: -0.602em;"><span class="mrow" id="MathJax-Span-2515"><span class="mi" id="MathJax-Span-2516" style="font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-2517" style="font-family: STIXGeneral-Italic;">g</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em 1005.48em 4.322em -999.998em); top: -3.296em; left: 50%; margin-left: -2.738em;"><span class="mrow" id="MathJax-Span-2518"><span class="mn" id="MathJax-Span-2519" style="font-family: STIXGeneral-Regular;">4</span><span class="mi" id="MathJax-Span-2520" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2521" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">cos</span><span class="mo" id="MathJax-Span-2522"></span><span class="mi" id="MathJax-Span-2523" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2524" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">cos</span><span class="mo" id="MathJax-Span-2525"></span><span class="mi" id="MathJax-Span-2526" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">ϕ</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em 1005.62em 1.21em -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 5.623em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mo" id="MathJax-Span-2527" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">−</span><span class="mfrac" id="MathJax-Span-2528" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 7.945em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.161em 1007.81em 4.415em -999.998em); top: -4.736em; left: 50%; margin-left: -3.9em;"><span class="mrow" id="MathJax-Span-2529"><span class="mo" id="MathJax-Span-2530" style="font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-2531" style="font-family: STIXGeneral-Regular;">2</span><span class="mi" id="MathJax-Span-2532" style="font-family: STIXGeneral-Italic;">b</span><span class="texatom" id="MathJax-Span-2533"><span class="mrow" id="MathJax-Span-2534"><span class="msubsup" id="MathJax-Span-2535"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2536" style="font-family: STIXGeneral-Italic;">e</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-2537" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="texatom" id="MathJax-Span-2538"><span class="mrow" id="MathJax-Span-2539"><span class="msubsup" id="MathJax-Span-2540"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.37em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2541" style="font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.327em;"><span class="texatom" id="MathJax-Span-2542"><span class="mrow" id="MathJax-Span-2543"><span class="mi" id="MathJax-Span-2544" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2545" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-2546" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">+</span><span class="texatom" id="MathJax-Span-2547" style="padding-left: 0.235em;"><span class="mrow" id="MathJax-Span-2548"><span class="msubsup" id="MathJax-Span-2549"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2550" style="font-family: STIXGeneral-Italic;">e</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-2551" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="texatom" id="MathJax-Span-2552"><span class="mrow" id="MathJax-Span-2553"><span class="msubsup" id="MathJax-Span-2554"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.37em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2555" style="font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.327em;"><span class="texatom" id="MathJax-Span-2556"><span class="mrow" id="MathJax-Span-2557"><span class="mi" id="MathJax-Span-2558" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">z</span><span class="mi" id="MathJax-Span-2559" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">z</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="mi" id="MathJax-Span-2560" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2561" style="font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em 1002em 4.136em -999.998em); top: -3.296em; left: 50%; margin-left: -1.02em;"><span class="mrow" id="MathJax-Span-2562"><span class="mn" id="MathJax-Span-2563" style="font-family: STIXGeneral-Regular;">4</span><span class="mi" id="MathJax-Span-2564" style="font-family: STIXGeneral-Italic;">b</span><span class="mi" id="MathJax-Span-2565" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2566" style="font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em 1007.95em 1.21em -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 7.945em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(2.464em 1014.08em 5.019em -999.998em); top: 0.002em; left: 0em;"><span class="mtd" id="MathJax-Span-2572"><span class="mrow" id="MathJax-Span-2573"><span class="mi" id="MathJax-Span-2574"></span><span class="mo" id="MathJax-Span-2575" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="mfrac" id="MathJax-Span-2576" style="padding-left: 0.327em;"><span style="display: inline-block; position: relative; width: 5.623em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.44em 1001.21em 4.322em -999.998em); top: -4.689em; left: 50%; margin-left: -0.602em;"><span class="mrow" id="MathJax-Span-2577"><span class="mi" id="MathJax-Span-2578" style="font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-2579" style="font-family: STIXGeneral-Italic;">g</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em 1005.48em 4.322em -999.998em); top: -3.296em; left: 50%; margin-left: -2.738em;"><span class="mrow" id="MathJax-Span-2580"><span class="mn" id="MathJax-Span-2581" style="font-family: STIXGeneral-Regular;">4</span><span class="mi" id="MathJax-Span-2582" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2583" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">cos</span><span class="mo" id="MathJax-Span-2584"></span><span class="mi" id="MathJax-Span-2585" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2586" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">cos</span><span class="mo" id="MathJax-Span-2587"></span><span class="mi" id="MathJax-Span-2588" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">ϕ</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em 1005.62em 1.21em -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 5.623em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mo" id="MathJax-Span-2589" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">+</span><span class="mfrac" id="MathJax-Span-2590" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 2.093em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.207em 1001.95em 4.415em -999.998em); top: -4.736em; left: 50%; margin-left: -0.973em;"><span class="mrow" id="MathJax-Span-2591"><span class="texatom" id="MathJax-Span-2592"><span class="mrow" id="MathJax-Span-2593"><span class="msubsup" id="MathJax-Span-2594"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2595" style="font-family: STIXGeneral-Italic;">e</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-2596" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="texatom" id="MathJax-Span-2597"><span class="mrow" id="MathJax-Span-2598"><span class="msubsup" id="MathJax-Span-2599"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.37em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2600" style="font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.327em;"><span class="texatom" id="MathJax-Span-2601"><span class="mrow" id="MathJax-Span-2602"><span class="mi" id="MathJax-Span-2603" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">z</span><span class="mi" id="MathJax-Span-2604" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">z</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em 1000.98em 4.136em -999.998em); top: -3.296em; left: 50%; margin-left: -0.509em;"><span class="mrow" id="MathJax-Span-2605"><span class="mn" id="MathJax-Span-2606" style="font-family: STIXGeneral-Regular;">4</span><span class="mi" id="MathJax-Span-2607" style="font-family: STIXGeneral-Italic;">b</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em 1002.09em 1.21em -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.093em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span><span class="mo" id="MathJax-Span-2608" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">+</span><span class="mfrac" id="MathJax-Span-2609" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 2.046em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.207em 1001.91em 4.415em -999.998em); top: -4.736em; left: 50%; margin-left: -0.927em;"><span class="mrow" id="MathJax-Span-2610"><span class="texatom" id="MathJax-Span-2611"><span class="mrow" id="MathJax-Span-2612"><span class="msubsup" id="MathJax-Span-2613"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2614" style="font-family: STIXGeneral-Italic;">e</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-2615" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="texatom" id="MathJax-Span-2616"><span class="mrow" id="MathJax-Span-2617"><span class="msubsup" id="MathJax-Span-2618"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.37em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2619" style="font-family: STIXGeneral-Italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.327em;"><span class="texatom" id="MathJax-Span-2620"><span class="mrow" id="MathJax-Span-2621"><span class="mi" id="MathJax-Span-2622" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">y</span><span class="mi" id="MathJax-Span-2623" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">y</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em 1001.53em 4.136em -999.998em); top: -3.296em; left: 50%; margin-left: -0.741em;"><span class="mrow" id="MathJax-Span-2624"><span class="mn" id="MathJax-Span-2625" style="font-family: STIXGeneral-Regular;">2</span><span class="mi" id="MathJax-Span-2626" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2627" style="font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em 1002.05em 1.21em -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.046em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span><span style="display: inline-block; width: 0px; height: 11.243em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -5.758em; border-left: 0px solid; width: 0px; height: 12.122em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><msub><mi>γ</mi><mn>1</mn></msub></mtd><mtd><mi></mi><mo>=</mo><mfrac><mrow><mi>m</mi><mi>g</mi></mrow><mrow><mn>4</mn><mi>k</mi><mi>cos</mi><mo>⁡</mo><mi>θ</mi><mi>cos</mi><mo>⁡</mo><mi>ϕ</mi></mrow></mfrac><mo>−</mo><mfrac><mrow><mn>2</mn><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>e</mi><mi>ϕ</mi></msub></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mi>x</mi></mrow></msub></mrow><mo>+</mo><mrow class="MJX-TeXAtom-ORD"><msub><mi>e</mi><mi>ψ</mi></msub></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mi>z</mi><mi>z</mi></mrow></msub></mrow><mi>k</mi><mi>L</mi></mrow><mrow><mn>4</mn><mi>b</mi><mi>k</mi><mi>L</mi></mrow></mfrac></mtd></mtr><mtr><mtd><msub><mi>γ</mi><mn>2</mn></msub></mtd><mtd><mi></mi><mo>=</mo><mfrac><mrow><mi>m</mi><mi>g</mi></mrow><mrow><mn>4</mn><mi>k</mi><mi>cos</mi><mo>⁡</mo><mi>θ</mi><mi>cos</mi><mo>⁡</mo><mi>ϕ</mi></mrow></mfrac><mo>+</mo><mfrac><mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>e</mi><mi>ψ</mi></msub></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mi>z</mi><mi>z</mi></mrow></msub></mrow></mrow><mrow><mn>4</mn><mi>b</mi></mrow></mfrac><mo>−</mo><mfrac><mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>e</mi><mi>θ</mi></msub></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi><mi>y</mi></mrow></msub></mrow></mrow><mrow><mn>2</mn><mi>k</mi><mi>L</mi></mrow></mfrac></mtd></mtr><mtr><mtd><msub><mi>γ</mi><mn>3</mn></msub></mtd><mtd><mi></mi><mo>=</mo><mfrac><mrow><mi>m</mi><mi>g</mi></mrow><mrow><mn>4</mn><mi>k</mi><mi>cos</mi><mo>⁡</mo><mi>θ</mi><mi>cos</mi><mo>⁡</mo><mi>ϕ</mi></mrow></mfrac><mo>−</mo><mfrac><mrow><mo>−</mo><mn>2</mn><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>e</mi><mi>ϕ</mi></msub></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mi>x</mi></mrow></msub></mrow><mo>+</mo><mrow class="MJX-TeXAtom-ORD"><msub><mi>e</mi><mi>ψ</mi></msub></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mi>z</mi><mi>z</mi></mrow></msub></mrow><mi>k</mi><mi>L</mi></mrow><mrow><mn>4</mn><mi>b</mi><mi>k</mi><mi>L</mi></mrow></mfrac></mtd></mtr><mtr><mtd><msub><mi>γ</mi><mn>4</mn></msub></mtd><mtd><mi></mi><mo>=</mo><mfrac><mrow><mi>m</mi><mi>g</mi></mrow><mrow><mn>4</mn><mi>k</mi><mi>cos</mi><mo>⁡</mo><mi>θ</mi><mi>cos</mi><mo>⁡</mo><mi>ϕ</mi></mrow></mfrac><mo>+</mo><mfrac><mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>e</mi><mi>ψ</mi></msub></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mi>z</mi><mi>z</mi></mrow></msub></mrow></mrow><mrow><mn>4</mn><mi>b</mi></mrow></mfrac><mo>+</mo><mfrac><mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>e</mi><mi>θ</mi></msub></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mi>y</mi><mi>y</mi></mrow></msub></mrow></mrow><mrow><mn>2</mn><mi>k</mi><mi>L</mi></mrow></mfrac></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-125">\begin{aligned}
    \gamma_1 &= \frac{mg}{4k\cos\theta\cos\phi}-\frac{2 b {e_\phi} {I_{xx}}+{e_\psi} {I_{zz}} k L}{4 b k L} \\
    \gamma_2 &= \frac{mg}{4k\cos\theta\cos\phi}+\frac{ {e_\psi} {I_{zz}}}{4 b}-\frac{ {e_\theta} {I_{yy}}}{2 k L} \\
    \gamma_3 &= \frac{mg}{4k\cos\theta\cos\phi}-\frac{-2 b {e_\phi} {I_{xx}}+{e_\psi} {I_{zz}} k L}{4 b k L} \\
    \gamma_4 &= \frac{mg}{4k\cos\theta\cos\phi}+\frac{ {e_\psi} {I_{zz}}}{4 b}+\frac{ {e_\theta} {I_{yy}}}{2 k L}\end{aligned}</script></span></p>
<p>This is a complete specification for our PD controller. We can simulate this controller using our simulation environment. The controller drives the angular velocities and angles to zero.</p>
<p><img src="./Quadcopter_Dynamics_and_Simulation_files/pd_controller.png" alt="image"><br>
<span> Left: Angular velocities. Right: angular displacements. <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-126-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2628" style="width: 0.746em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.606em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.721em 1000.56em 2.882em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-2629"><span class="mi" id="MathJax-Span-2630" style="font-family: STIXGeneral-Italic;">ϕ</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.269em; border-left: 0px solid; width: 0px; height: 1.144em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ϕ</mi></math></span></span><script type="math/tex" id="MathJax-Element-126">\phi</script></span>, <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-127-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2631" style="width: 0.56em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.721em 1000.47em 2.696em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-2632"><span class="mi" id="MathJax-Span-2633" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-127">\theta</script></span>, <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-128-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C8;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2634" style="width: 0.838em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.699em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(2em 1000.7em 2.882em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-2635"><span class="mi" id="MathJax-Span-2636" style="font-family: STIXGeneral-Italic;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.095em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.269em; border-left: 0px solid; width: 0px; height: 0.872em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ψ</mi></math></span></span><script type="math/tex" id="MathJax-Element-128">\psi</script></span> are coded as red, green, and blue. </span></p>
<p>However, note that the angles are not completely driven to zero. The average steady state error (error after 10 seconds of simulation) is approximately 0.3<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-129-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;&amp;#x2218;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2637" style="width: 0.374em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.327em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.442em 1000.33em 2.371em -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-2638"><span class="msubsup" id="MathJax-Span-2639"><span style="display: inline-block; position: relative; width: 0.327em; height: 0px;"><span style="position: absolute; clip: rect(3.858em 1000em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2640"></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.364em; left: 0em;"><span class="mo" id="MathJax-Span-2641" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∘</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.872em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi></mi><mo>∘</mo></msup></math></span></span><script type="math/tex" id="MathJax-Element-129">^\circ</script></span>. This is a common problem with using PD controllers for mechanical systems, and can be partially alleviated with a PID controller, as we will discuss in the next section.</p>
<p>In addition, note that since we are only controlling angular velocities, our positions and linear velocities do not converge to zero. However, the <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-130-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2642" style="width: 0.467em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.374em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(2em 1000.37em 2.789em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-2643"><span class="mi" id="MathJax-Span-2644" style="font-family: STIXGeneral-Italic;">z</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.16em; border-left: 0px solid; width: 0px; height: 0.709em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-130">z</script></span> position will remain constant, because we have constrained the total vertical thrust to be such that it keeps the quadcopter perfectly aloft, without ascending or descending. However, this is really nothing more than a curiosity. With the limited sensing that we have available to us, there is nothing we can do to control the linear position and velocity of the quadcopter. While in theory we could compute the linear velocities and positions from the angular velocities, in practice the values will be so noisy as to be completely useless. Thus, we will restrict ourselves to just stabilizing the quadcopter angle and angular velocity. (Traditionally, navigation is done by a human, and stabilization is there simply to make control easier for the human operator.)</p>
<p>We have implemented this PD control for use in our simulation. The controller is implemented as a function which is given some state (corresponding to controller state, not system state) and the sensor inputs, and must compute the inputs <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-131-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2645" style="width: 0.838em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.699em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.675em 1000.7em 2.557em -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-2646"><span class="msubsup" id="MathJax-Span-2647"><span style="display: inline-block; position: relative; width: 0.699em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.322em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2648" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.42em;"><span class="mi" id="MathJax-Span-2649" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.269em; border-left: 0px solid; width: 0px; height: 0.872em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>γ</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-131">\gamma_i</script></span> and the updated state. The code for a PD control follows.</p>
<div class="sourceCode"><pre class="sourceCode matlab"><code class="sourceCode matlab"><span class="co">% Compute system inputs and updated state.</span>
<span class="co">% Note that input = [$\gamma_1$, $\ldots$, $\gamma_4$]</span>
function [input, state] = pd_controller(state, thetadot)
    <span class="co">% Controller gains, tuned by hand and intuition.</span>
    Kd = <span class="fl">4</span>;
    Kp = <span class="fl">3</span>;

    <span class="co">% Initialize the integral if necessary.</span>
    if ~isfield(state, <span class="st">'integral'</span>)
        params.integral = zeros(<span class="fl">3</span>, <span class="fl">1</span>);
    end

    <span class="co">% Compute total thrust</span>
    total = state.m * state.g / state.k / (cos(state.integral(<span class="fl">1</span>)) * cos(state.integral(<span class="fl">2</span>)));

    <span class="co">% Compute errors</span>
    e = Kd * thetadot + Kp * params.integral;

    <span class="co">% Solve for the inputs, $\gamma_i$</span>
    input = error2inputs(params, accels, total);

    <span class="co">% Update the state</span>
    params.integral = params.integral + params.dt .* thetadot;
end</code></pre></div>
<h2 id="pid-control" class="unnumbered">PID Control</h2>
<p>PD controllers are nice in their simplicity and ease of implementation, but they are often inadequate for controlling mechanical systems. Especially in the presence of noise and disturbances, PD controllers will often lead to steady state error. A PID control is a PD control with another term added, which is proportional to the integral of the process variable. Adding an integral term causes any remaining steady-state error to build up and enact a change, so a PID controller should be able to track our trajectory (and stabilize the quadcopter) with a significantly smaller steady-state error. The equations remain identical to the ones presented in the PD case, but with an additional term in the error: <span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-132-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/msub&gt;&lt;msubsup&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;d&lt;/mtext&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;/mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;msubsup&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msubsup&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;d&lt;/mtext&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;/mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;d&lt;/mtext&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;/mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/msub&gt;&lt;msubsup&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;d&lt;/mtext&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;/mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;msubsup&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msubsup&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;d&lt;/mtext&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;/mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;d&lt;/mtext&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;/mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;&amp;#x03C8;&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03C8;&lt;/mi&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/msub&gt;&lt;msubsup&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03C8;&lt;/mi&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;d&lt;/mtext&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;/mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;msubsup&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msubsup&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03C8;&lt;/mi&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;d&lt;/mtext&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;/mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;d&lt;/mtext&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;/mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2650" style="width: 22.996em; display: inline-block;"><span style="display: inline-block; position: relative; width: 19.651em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(-2.227em 1019.47em 6.227em -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-2651"><span class="mtable" id="MathJax-Span-2652" style="padding-right: 0.188em; padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 19.28em; height: 0px;"><span style="position: absolute; clip: rect(4.09em 1000.98em 10.779em -999.998em); top: -7.43em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.98em 4.415em -999.998em); top: -6.78em; right: 0em;"><span class="mtd" id="MathJax-Span-2653"><span class="mrow" id="MathJax-Span-2654"><span class="msubsup" id="MathJax-Span-2655"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2656" style="font-family: STIXGeneral-Italic;">e</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-2657" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.44em 1000.88em 4.276em -999.998em); top: -3.9em; right: 0em;"><span class="mtd" id="MathJax-Span-2715"><span class="mrow" id="MathJax-Span-2716"><span class="msubsup" id="MathJax-Span-2717"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2718" style="font-family: STIXGeneral-Italic;">e</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-2719" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.44em 1000.98em 4.415em -999.998em); top: -1.066em; right: 0em;"><span class="mtd" id="MathJax-Span-2777"><span class="mrow" id="MathJax-Span-2778"><span class="msubsup" id="MathJax-Span-2779"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.42em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2780" style="font-family: STIXGeneral-Italic;">e</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.467em;"><span class="mi" id="MathJax-Span-2781" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span><span style="display: inline-block; width: 0px; height: 7.435em;"></span></span><span style="position: absolute; clip: rect(4.74em 1018.3em 13.194em -999.998em); top: -9.195em; left: 0.978em;"><span style="display: inline-block; position: relative; width: 18.304em; height: 0px;"><span style="position: absolute; clip: rect(2.278em 1018.16em 5.065em -999.998em); top: -6.78em; left: 0em;"><span class="mtd" id="MathJax-Span-2658"><span class="mrow" id="MathJax-Span-2659"><span class="mi" id="MathJax-Span-2660"></span><span class="mo" id="MathJax-Span-2661" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="msubsup" id="MathJax-Span-2662" style="padding-left: 0.327em;"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.75em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2663" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.653em;"><span class="mi" id="MathJax-Span-2664" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2665"><span class="mrow" id="MathJax-Span-2666"><span class="munderover" id="MathJax-Span-2667"><span style="display: inline-block; position: relative; width: 0.606em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.61em 4.322em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2668" style="font-family: STIXGeneral-Italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.254em 1000.24em 3.626em -999.998em); top: -4.271em; left: 0.142em;"><span class="mo" id="MathJax-Span-2669" style="font-family: STIXGeneral-Regular;">˙</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-2670" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">+</span><span class="msubsup" id="MathJax-Span-2671" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.75em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2672" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.653em;"><span class="mi" id="MathJax-Span-2673" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2674" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.767em; height: 0px;"><span style="position: absolute; clip: rect(2.464em 1001.02em 5.019em -999.998em); top: -3.992em; left: 0em;"><span class="mo" id="MathJax-Span-2675" style="font-family: STIXIntegralsD; vertical-align: -0.602em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.467em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.393em 1000.51em 4.136em -999.998em); top: -5.107em; left: 1.21em;"><span class="mi" id="MathJax-Span-2676" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.393em 1000.42em 4.136em -999.998em); top: -3.063em; left: 0.606em;"><span class="mn" id="MathJax-Span-2677" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2678" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-2679"><span class="munderover" id="MathJax-Span-2680"><span style="display: inline-block; position: relative; width: 0.606em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.61em 4.322em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2681" style="font-family: STIXGeneral-Italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.254em 1000.24em 3.626em -999.998em); top: -4.271em; left: 0.142em;"><span class="mo" id="MathJax-Span-2682" style="font-family: STIXGeneral-Regular;">˙</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="texatom" id="MathJax-Span-2683"><span class="mrow" id="MathJax-Span-2684"><span class="mtext" id="MathJax-Span-2685" style="font-family: STIXGeneral-Regular;">d</span><span class="mspace" id="MathJax-Span-2686" style="height: 0em; vertical-align: 0em; width: 0.327em; display: inline-block; overflow: hidden;"></span></span></span><span class="mi" id="MathJax-Span-2687" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-2688" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">+</span><span class="msubsup" id="MathJax-Span-2689" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 0.931em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.75em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2690" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.653em;"><span class="mi" id="MathJax-Span-2691" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2692" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.767em; height: 0px;"><span style="position: absolute; clip: rect(2.464em 1001.02em 5.019em -999.998em); top: -3.992em; left: 0em;"><span class="mo" id="MathJax-Span-2693" style="font-family: STIXIntegralsD; vertical-align: -0.602em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.467em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.393em 1000.51em 4.136em -999.998em); top: -5.107em; left: 1.21em;"><span class="mi" id="MathJax-Span-2694" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.393em 1000.42em 4.136em -999.998em); top: -3.063em; left: 0.606em;"><span class="mn" id="MathJax-Span-2695" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2696" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.767em; height: 0px;"><span style="position: absolute; clip: rect(2.464em 1001.02em 5.019em -999.998em); top: -3.992em; left: 0em;"><span class="mo" id="MathJax-Span-2697" style="font-family: STIXIntegralsD; vertical-align: -0.602em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.467em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.393em 1000.51em 4.136em -999.998em); top: -5.107em; left: 1.21em;"><span class="mi" id="MathJax-Span-2698" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.393em 1000.42em 4.136em -999.998em); top: -3.063em; left: 0.606em;"><span class="mn" id="MathJax-Span-2699" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2700" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-2701"><span class="munderover" id="MathJax-Span-2702"><span style="display: inline-block; position: relative; width: 0.606em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.61em 4.322em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2703" style="font-family: STIXGeneral-Italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.254em 1000.24em 3.626em -999.998em); top: -4.271em; left: 0.142em;"><span class="mo" id="MathJax-Span-2704" style="font-family: STIXGeneral-Regular;">˙</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="texatom" id="MathJax-Span-2705"><span class="mrow" id="MathJax-Span-2706"><span class="mtext" id="MathJax-Span-2707" style="font-family: STIXGeneral-Regular;">d</span><span class="mspace" id="MathJax-Span-2708" style="height: 0em; vertical-align: 0em; width: 0.327em; display: inline-block; overflow: hidden;"></span></span></span><span class="mi" id="MathJax-Span-2709" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="texatom" id="MathJax-Span-2710"><span class="mrow" id="MathJax-Span-2711"><span class="mtext" id="MathJax-Span-2712" style="font-family: STIXGeneral-Regular;">d</span><span class="mspace" id="MathJax-Span-2713" style="height: 0em; vertical-align: 0em; width: 0.327em; display: inline-block; overflow: hidden;"></span></span></span><span class="mi" id="MathJax-Span-2714" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(2.278em 1017.79em 5.065em -999.998em); top: -3.9em; left: 0em;"><span class="mtd" id="MathJax-Span-2720"><span class="mrow" id="MathJax-Span-2721"><span class="mi" id="MathJax-Span-2722"></span><span class="mo" id="MathJax-Span-2723" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="msubsup" id="MathJax-Span-2724" style="padding-left: 0.327em;"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.75em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2725" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.653em;"><span class="mi" id="MathJax-Span-2726" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2727"><span class="mrow" id="MathJax-Span-2728"><span class="munderover" id="MathJax-Span-2729"><span style="display: inline-block; position: relative; width: 0.513em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.51em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2730" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.254em 1000.24em 3.626em -999.998em); top: -4.271em; left: 0.095em;"><span class="mo" id="MathJax-Span-2731" style="font-family: STIXGeneral-Regular;">˙</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-2732" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">+</span><span class="msubsup" id="MathJax-Span-2733" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.75em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2734" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.653em;"><span class="mi" id="MathJax-Span-2735" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2736" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.767em; height: 0px;"><span style="position: absolute; clip: rect(2.464em 1001.02em 5.019em -999.998em); top: -3.992em; left: 0em;"><span class="mo" id="MathJax-Span-2737" style="font-family: STIXIntegralsD; vertical-align: -0.602em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.467em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.393em 1000.51em 4.136em -999.998em); top: -5.107em; left: 1.21em;"><span class="mi" id="MathJax-Span-2738" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.393em 1000.42em 4.136em -999.998em); top: -3.063em; left: 0.606em;"><span class="mn" id="MathJax-Span-2739" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2740" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-2741"><span class="munderover" id="MathJax-Span-2742"><span style="display: inline-block; position: relative; width: 0.513em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.51em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2743" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.254em 1000.24em 3.626em -999.998em); top: -4.271em; left: 0.095em;"><span class="mo" id="MathJax-Span-2744" style="font-family: STIXGeneral-Regular;">˙</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="texatom" id="MathJax-Span-2745"><span class="mrow" id="MathJax-Span-2746"><span class="mtext" id="MathJax-Span-2747" style="font-family: STIXGeneral-Regular;">d</span><span class="mspace" id="MathJax-Span-2748" style="height: 0em; vertical-align: 0em; width: 0.327em; display: inline-block; overflow: hidden;"></span></span></span><span class="mi" id="MathJax-Span-2749" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-2750" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">+</span><span class="msubsup" id="MathJax-Span-2751" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 0.931em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.75em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2752" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.653em;"><span class="mi" id="MathJax-Span-2753" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2754" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.767em; height: 0px;"><span style="position: absolute; clip: rect(2.464em 1001.02em 5.019em -999.998em); top: -3.992em; left: 0em;"><span class="mo" id="MathJax-Span-2755" style="font-family: STIXIntegralsD; vertical-align: -0.602em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.467em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.393em 1000.51em 4.136em -999.998em); top: -5.107em; left: 1.21em;"><span class="mi" id="MathJax-Span-2756" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.393em 1000.42em 4.136em -999.998em); top: -3.063em; left: 0.606em;"><span class="mn" id="MathJax-Span-2757" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2758" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.767em; height: 0px;"><span style="position: absolute; clip: rect(2.464em 1001.02em 5.019em -999.998em); top: -3.992em; left: 0em;"><span class="mo" id="MathJax-Span-2759" style="font-family: STIXIntegralsD; vertical-align: -0.602em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.467em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.393em 1000.51em 4.136em -999.998em); top: -5.107em; left: 1.21em;"><span class="mi" id="MathJax-Span-2760" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.393em 1000.42em 4.136em -999.998em); top: -3.063em; left: 0.606em;"><span class="mn" id="MathJax-Span-2761" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2762" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-2763"><span class="munderover" id="MathJax-Span-2764"><span style="display: inline-block; position: relative; width: 0.513em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.51em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2765" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.254em 1000.24em 3.626em -999.998em); top: -4.271em; left: 0.095em;"><span class="mo" id="MathJax-Span-2766" style="font-family: STIXGeneral-Regular;">˙</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="texatom" id="MathJax-Span-2767"><span class="mrow" id="MathJax-Span-2768"><span class="mtext" id="MathJax-Span-2769" style="font-family: STIXGeneral-Regular;">d</span><span class="mspace" id="MathJax-Span-2770" style="height: 0em; vertical-align: 0em; width: 0.327em; display: inline-block; overflow: hidden;"></span></span></span><span class="mi" id="MathJax-Span-2771" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="texatom" id="MathJax-Span-2772"><span class="mrow" id="MathJax-Span-2773"><span class="mtext" id="MathJax-Span-2774" style="font-family: STIXGeneral-Regular;">d</span><span class="mspace" id="MathJax-Span-2775" style="height: 0em; vertical-align: 0em; width: 0.327em; display: inline-block; overflow: hidden;"></span></span></span><span class="mi" id="MathJax-Span-2776" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(2.278em 1018.3em 5.065em -999.998em); top: -1.066em; left: 0em;"><span class="mtd" id="MathJax-Span-2782"><span class="mrow" id="MathJax-Span-2783"><span class="mi" id="MathJax-Span-2784"></span><span class="mo" id="MathJax-Span-2785" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="msubsup" id="MathJax-Span-2786" style="padding-left: 0.327em;"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.75em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2787" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.653em;"><span class="mi" id="MathJax-Span-2788" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2789"><span class="mrow" id="MathJax-Span-2790"><span class="munderover" id="MathJax-Span-2791"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.322em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2792" style="font-family: STIXGeneral-Italic;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.095em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.254em 1000.24em 3.626em -999.998em); top: -4.039em; left: 0.235em;"><span class="mo" id="MathJax-Span-2793" style="font-family: STIXGeneral-Regular;">˙</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-2794" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">+</span><span class="msubsup" id="MathJax-Span-2795" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.75em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2796" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.653em;"><span class="mi" id="MathJax-Span-2797" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2798" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.767em; height: 0px;"><span style="position: absolute; clip: rect(2.464em 1001.02em 5.019em -999.998em); top: -3.992em; left: 0em;"><span class="mo" id="MathJax-Span-2799" style="font-family: STIXIntegralsD; vertical-align: -0.602em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.467em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.393em 1000.51em 4.136em -999.998em); top: -5.107em; left: 1.21em;"><span class="mi" id="MathJax-Span-2800" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.393em 1000.42em 4.136em -999.998em); top: -3.063em; left: 0.606em;"><span class="mn" id="MathJax-Span-2801" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2802" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-2803"><span class="munderover" id="MathJax-Span-2804"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.322em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2805" style="font-family: STIXGeneral-Italic;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.095em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.254em 1000.24em 3.626em -999.998em); top: -4.039em; left: 0.235em;"><span class="mo" id="MathJax-Span-2806" style="font-family: STIXGeneral-Regular;">˙</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="texatom" id="MathJax-Span-2807"><span class="mrow" id="MathJax-Span-2808"><span class="mtext" id="MathJax-Span-2809" style="font-family: STIXGeneral-Regular;">d</span><span class="mspace" id="MathJax-Span-2810" style="height: 0em; vertical-align: 0em; width: 0.327em; display: inline-block; overflow: hidden;"></span></span></span><span class="mi" id="MathJax-Span-2811" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-2812" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">+</span><span class="msubsup" id="MathJax-Span-2813" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 0.931em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.75em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2814" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.653em;"><span class="mi" id="MathJax-Span-2815" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2816" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.767em; height: 0px;"><span style="position: absolute; clip: rect(2.464em 1001.02em 5.019em -999.998em); top: -3.992em; left: 0em;"><span class="mo" id="MathJax-Span-2817" style="font-family: STIXIntegralsD; vertical-align: -0.602em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.467em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.393em 1000.51em 4.136em -999.998em); top: -5.107em; left: 1.21em;"><span class="mi" id="MathJax-Span-2818" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.393em 1000.42em 4.136em -999.998em); top: -3.063em; left: 0.606em;"><span class="mn" id="MathJax-Span-2819" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2820" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.767em; height: 0px;"><span style="position: absolute; clip: rect(2.464em 1001.02em 5.019em -999.998em); top: -3.992em; left: 0em;"><span class="mo" id="MathJax-Span-2821" style="font-family: STIXIntegralsD; vertical-align: -0.602em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.467em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.393em 1000.51em 4.136em -999.998em); top: -5.107em; left: 1.21em;"><span class="mi" id="MathJax-Span-2822" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.393em 1000.42em 4.136em -999.998em); top: -3.063em; left: 0.606em;"><span class="mn" id="MathJax-Span-2823" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2824" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-2825"><span class="munderover" id="MathJax-Span-2826"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.65em 4.322em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2827" style="font-family: STIXGeneral-Italic;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.095em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.254em 1000.24em 3.626em -999.998em); top: -4.039em; left: 0.235em;"><span class="mo" id="MathJax-Span-2828" style="font-family: STIXGeneral-Regular;">˙</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="texatom" id="MathJax-Span-2829"><span class="mrow" id="MathJax-Span-2830"><span class="mtext" id="MathJax-Span-2831" style="font-family: STIXGeneral-Regular;">d</span><span class="mspace" id="MathJax-Span-2832" style="height: 0em; vertical-align: 0em; width: 0.327em; display: inline-block; overflow: hidden;"></span></span></span><span class="mi" id="MathJax-Span-2833" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="texatom" id="MathJax-Span-2834"><span class="mrow" id="MathJax-Span-2835"><span class="mtext" id="MathJax-Span-2836" style="font-family: STIXGeneral-Regular;">d</span><span class="mspace" id="MathJax-Span-2837" style="height: 0em; vertical-align: 0em; width: 0.327em; display: inline-block; overflow: hidden;"></span></span></span><span class="mi" id="MathJax-Span-2838" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span><span style="display: inline-block; width: 0px; height: 9.2em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -4.563em; border-left: 0px solid; width: 0px; height: 9.677em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><msub><mi>e</mi><mi>ϕ</mi></msub></mtd><mtd><mi></mi><mo>=</mo><msub><mi>K</mi><mi>d</mi></msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>ϕ</mi><mo>˙</mo></mover></mrow><mo>+</mo><msub><mi>K</mi><mi>p</mi></msub><msubsup><mo>∫</mo><mn>0</mn><mi>T</mi></msubsup><mrow class="MJX-TeXAtom-ORD"><mover><mi>ϕ</mi><mo>˙</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mtext>d</mtext><mspace width="thickmathspace"></mspace></mrow><mi>t</mi><mo>+</mo><msub><mi>K</mi><mi>i</mi></msub><msubsup><mo>∫</mo><mn>0</mn><mi>T</mi></msubsup><msubsup><mo>∫</mo><mn>0</mn><mi>T</mi></msubsup><mrow class="MJX-TeXAtom-ORD"><mover><mi>ϕ</mi><mo>˙</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mtext>d</mtext><mspace width="thickmathspace"></mspace></mrow><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mtext>d</mtext><mspace width="thickmathspace"></mspace></mrow><mi>t</mi></mtd></mtr><mtr><mtd><msub><mi>e</mi><mi>θ</mi></msub></mtd><mtd><mi></mi><mo>=</mo><msub><mi>K</mi><mi>d</mi></msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>θ</mi><mo>˙</mo></mover></mrow><mo>+</mo><msub><mi>K</mi><mi>p</mi></msub><msubsup><mo>∫</mo><mn>0</mn><mi>T</mi></msubsup><mrow class="MJX-TeXAtom-ORD"><mover><mi>θ</mi><mo>˙</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mtext>d</mtext><mspace width="thickmathspace"></mspace></mrow><mi>t</mi><mo>+</mo><msub><mi>K</mi><mi>i</mi></msub><msubsup><mo>∫</mo><mn>0</mn><mi>T</mi></msubsup><msubsup><mo>∫</mo><mn>0</mn><mi>T</mi></msubsup><mrow class="MJX-TeXAtom-ORD"><mover><mi>θ</mi><mo>˙</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mtext>d</mtext><mspace width="thickmathspace"></mspace></mrow><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mtext>d</mtext><mspace width="thickmathspace"></mspace></mrow><mi>t</mi></mtd></mtr><mtr><mtd><msub><mi>e</mi><mi>ψ</mi></msub></mtd><mtd><mi></mi><mo>=</mo><msub><mi>K</mi><mi>d</mi></msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>ψ</mi><mo>˙</mo></mover></mrow><mo>+</mo><msub><mi>K</mi><mi>p</mi></msub><msubsup><mo>∫</mo><mn>0</mn><mi>T</mi></msubsup><mrow class="MJX-TeXAtom-ORD"><mover><mi>ψ</mi><mo>˙</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mtext>d</mtext><mspace width="thickmathspace"></mspace></mrow><mi>t</mi><mo>+</mo><msub><mi>K</mi><mi>i</mi></msub><msubsup><mo>∫</mo><mn>0</mn><mi>T</mi></msubsup><msubsup><mo>∫</mo><mn>0</mn><mi>T</mi></msubsup><mrow class="MJX-TeXAtom-ORD"><mover><mi>ψ</mi><mo>˙</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mtext>d</mtext><mspace width="thickmathspace"></mspace></mrow><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mtext>d</mtext><mspace width="thickmathspace"></mspace></mrow><mi>t</mi></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-132">\begin{aligned}
    e_\phi &= K_d\dot\phi + K_p \int_0^T\dot\phi{\text{d}\;}t + K_i \int_0^T\int_0^T\dot\phi{\text{d}\;}t{\text{d}\;}t \\
    e_\theta &= K_d\dot\theta + K_p \int_0^T\dot\theta{\text{d}\;}t + K_i \int_0^T\int_0^T\dot\theta{\text{d}\;}t{\text{d}\;}t \\
    e_\psi &= K_d\dot\psi + K_p \int_0^T\dot\psi{\text{d}\;}t + K_i \int_0^T\int_0^T\dot\psi{\text{d}\;}t{\text{d}\;}t \\\end{aligned}</script></span> However, PID controls come with their own shortcomings. One problem that commonly occurs with a PID control is known as integral windup.</p>
<p><img src="./Quadcopter_Dynamics_and_Simulation_files/windup.png" alt="image"><br>
<span> In some cases, integral wind-up can cause lengthy oscillations instead of settling. In other cases, wind-up may actually cause the system to become unstable, instead of taking longer to reach a steady state. </span></p>
<p>If there is a large disturbance in the process variable, this large disturbance is integrated over time, becoming a still larger control signal (due to the integral term). However, even once the system stabilizes, the integral is still large, thus causing the controller to overshoot its target. It may then begin a series of dieing down oscillations, become unstable, or simply take an incredibly long time to reach a steady state. In order to avoid this, we disable the integral function until we reach something close to the steady state. Once we are in a controllable region near the desired steady state, we turn on the integral function, which pushes the system towards a low steady-state error.</p>
<p><img src="./Quadcopter_Dynamics_and_Simulation_files/pid_controller.png" alt="image"><br>
<span> With a properly implemented PID, we achieve an error of approximately 0.06<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-133-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;&amp;#x2218;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2839" style="width: 0.374em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.327em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.442em 1000.33em 2.371em -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-2840"><span class="msubsup" id="MathJax-Span-2841"><span style="display: inline-block; position: relative; width: 0.327em; height: 0px;"><span style="position: absolute; clip: rect(3.858em 1000em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2842"></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.364em; left: 0em;"><span class="mo" id="MathJax-Span-2843" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∘</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.872em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi></mi><mo>∘</mo></msup></math></span></span><script type="math/tex" id="MathJax-Element-133">^\circ</script></span> after 10 seconds. </span></p>
<p>We have implemented this PID control for use in simulation, in the same way as with the PD controller shown earlier. Note that there is an additional parameter to tune in a PID. The disturbances used for all the test cases are identical, shown to compare the controllers.</p>
<div class="sourceCode"><pre class="sourceCode matlab"><code class="sourceCode matlab"><span class="co">% Compute system inputs and updated state.</span>
<span class="co">% Note that input = [$\gamma_1$, $\ldots$, $\gamma_4$]</span>
function [input, state] = pid_controller(state, thetadot)
    <span class="co">% Controller gains, tuned by hand and intuition.</span>
    Kd = <span class="fl">4</span>;
    Kp = <span class="fl">3</span>;
    Ki = <span class="fl">5.5</span>;

    <span class="co">% Initialize the integral if necessary.</span>
    if ~isfield(state, <span class="st">'integral'</span>)
        params.integral = zeros(<span class="fl">3</span>, <span class="fl">1</span>);
        params.integral2 = zeros(<span class="fl">3</span>, <span class="fl">1</span>);
    end

    <span class="co">% Prevent wind-up</span>
    if max(abs(params.integral2)) &gt; <span class="fl">0.01</span>
        params.integral2(:) = <span class="fl">0</span>;
    end

    <span class="co">% Compute total thrust</span>
    total = state.m * state.g / state.k / (cos(state.integral(<span class="fl">1</span>)) * cos(state.integral(<span class="fl">2</span>)));

    <span class="co">% Compute errors</span>
    e = Kd * thetadot + Kp * params.integral - Ki * params.integral2;

    <span class="co">% Solve for the inputs, $\gamma_i$</span>
    input = error2inputs(params, accels, total);

    <span class="co">% Update the state</span>
    params.integral = params.integral + params.dt .* thetadot;
    params.integral2 = params.integral2 + params.dt .* params.integral;
end</code></pre></div>
<h2 id="automatic-pid-tuning" class="unnumbered">Automatic PID Tuning</h2>
<p>Although PID control has the potential to perform very well, it turns out that the quality of the controller is highly dependent on the gain parameters. Tuning the parameters by hand may be quite difficult, as the ratios of the parameters is as important as the magnitudes of the parameters themselves; often, tuning parameters requires detailed knowledge of the system and an understanding of the conditions in which the PID control will be used. The parameters we chose previously were tuned by hand for good performance, simply by running simulations with many possibly disturbances and parameter values, and choosing something that worked reasonably well. This method is clearly suboptimal, not only because it can be very difficult and labor-intensive (and sometimes more or less impossible) but also because the resulting gains are not in any way guaranteed to be optimal or even close to optimal.</p>
<p>Ideally, we would be able to use an algorithm to analyze a system and output the “optimal” PID gains, for some reasonable definition of optimal. This problem has been studied in depth, and many methods have been proposed. Many of these methods require detailed knowledge of the system being modeled, and some rely on properties of the system, such as stability or linearity. The method we will use for choosing our PID parameters is a method known as <em>extremum seeking</em>.</p>
<p>Extremum seeking works exactly as the name implies. We define the “optimal” set of parameters as some vector <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-134-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2844" style="width: 7.667em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.552em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.396em 1006.5em 2.975em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-2845"><span class="texatom" id="MathJax-Span-2846"><span class="mrow" id="MathJax-Span-2847"><span class="munderover" id="MathJax-Span-2848"><span style="display: inline-block; position: relative; width: 0.513em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.51em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2849" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.225em; left: 0.049em;"><span style="height: 0em; vertical-align: 0em; width: 0.467em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-2850" style="font-family: STIXGeneral-Regular;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.23em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-2851" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="mo" id="MathJax-Span-2852" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">(</span><span class="msubsup" id="MathJax-Span-2853"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.75em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2854" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.653em;"><span class="mi" id="MathJax-Span-2855" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-2856" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-2857" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.931em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.75em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2858" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.653em;"><span class="mi" id="MathJax-Span-2859" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-2860" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-2861" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.75em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2862" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.653em;"><span class="mi" id="MathJax-Span-2863" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-2864" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.378em; border-left: 0px solid; width: 0px; height: 1.633em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mi>θ</mi><mo stretchy="false">→</mo></mover></mrow><mo>=</mo><mo stretchy="false">(</mo><msub><mi>K</mi><mi>p</mi></msub><mo>,</mo><msub><mi>K</mi><mi>i</mi></msub><mo>,</mo><msub><mi>K</mi><mi>d</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-134">\vec \theta = (K_p, K_i, K_d)</script></span> which minimizes some cost function <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-135-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2865" style="width: 1.953em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.675em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.396em 1001.63em 2.882em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-2866"><span class="mi" id="MathJax-Span-2867" style="font-family: STIXGeneral-Italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mo" id="MathJax-Span-2868" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-2869"><span class="mrow" id="MathJax-Span-2870"><span class="munderover" id="MathJax-Span-2871"><span style="display: inline-block; position: relative; width: 0.513em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.51em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2872" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.225em; left: 0.049em;"><span style="height: 0em; vertical-align: 0em; width: 0.467em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-2873" style="font-family: STIXGeneral-Regular;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.23em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-2874" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.269em; border-left: 0px solid; width: 0px; height: 1.47em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>J</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>θ</mi><mo stretchy="false">→</mo></mover></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-135">J(\vec\theta)</script></span>. In our case, we would like to define a cost function that penalizes high error and error over extended durations of time. One candidate cost function is given by <span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-136-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;msubsup&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;d&lt;/mtext&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;/mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2875" style="width: 13.984em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.94em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(0.931em 1011.94em 3.718em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-2876"><span class="mi" id="MathJax-Span-2877" style="font-family: STIXGeneral-Italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mo" id="MathJax-Span-2878" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-2879"><span class="mrow" id="MathJax-Span-2880"><span class="munderover" id="MathJax-Span-2881"><span style="display: inline-block; position: relative; width: 0.513em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.51em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2882" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.225em; left: 0.049em;"><span style="height: 0em; vertical-align: 0em; width: 0.467em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-2883" style="font-family: STIXGeneral-Regular;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.23em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-2884" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2885" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="texatom" id="MathJax-Span-2886" style="padding-left: 0.327em;"><span class="mrow" id="MathJax-Span-2887"><span class="mfrac" id="MathJax-Span-2888"><span style="display: inline-block; position: relative; width: 2.65em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.161em 1000.37em 4.136em -999.998em); top: -4.689em; left: 50%; margin-left: -0.23em;"><span class="mn" id="MathJax-Span-2889" style="font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.3em 1002.51em 4.415em -999.998em); top: -3.296em; left: 50%; margin-left: -1.252em;"><span class="mrow" id="MathJax-Span-2890"><span class="msubsup" id="MathJax-Span-2891"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px;"><span style="position: absolute; clip: rect(3.3em 1000.28em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2892" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.281em;"><span class="mi" id="MathJax-Span-2893" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.095em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-2894" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">−</span><span class="msubsup" id="MathJax-Span-2895" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 0.699em; height: 0px;"><span style="position: absolute; clip: rect(3.3em 1000.28em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2896" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.281em;"><span class="mi" id="MathJax-Span-2897" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">o</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em 1002.65em 1.21em -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.65em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span></span></span><span class="msubsup" id="MathJax-Span-2898" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.767em; height: 0px;"><span style="position: absolute; clip: rect(2.464em 1001.02em 5.019em -999.998em); top: -3.992em; left: 0em;"><span class="mo" id="MathJax-Span-2899" style="font-family: STIXIntegralsD; vertical-align: -0.602em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.467em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.486em 1000.56em 4.369em -999.998em); top: -5.107em; left: 1.21em;"><span class="texatom" id="MathJax-Span-2900"><span class="mrow" id="MathJax-Span-2901"><span class="msubsup" id="MathJax-Span-2902"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px;"><span style="position: absolute; clip: rect(3.486em 1000.24em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2903" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.9em; left: 0.188em;"><span class="mi" id="MathJax-Span-2904" style="font-size: 50%; font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.095em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.486em 1000.56em 4.229em -999.998em); top: -3.063em; left: 0.606em;"><span class="texatom" id="MathJax-Span-2905"><span class="mrow" id="MathJax-Span-2906"><span class="msubsup" id="MathJax-Span-2907"><span style="display: inline-block; position: relative; width: 0.513em; height: 0px;"><span style="position: absolute; clip: rect(3.486em 1000.24em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2908" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.9em; left: 0.188em;"><span class="mn" id="MathJax-Span-2909" style="font-size: 50%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mi" id="MathJax-Span-2910" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">e</span><span class="mo" id="MathJax-Span-2911" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2912" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-2913" style="font-family: STIXGeneral-Regular;">,</span><span class="texatom" id="MathJax-Span-2914" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-2915"><span class="munderover" id="MathJax-Span-2916"><span style="display: inline-block; position: relative; width: 0.513em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.51em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2917" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.225em; left: 0.049em;"><span style="height: 0em; vertical-align: 0em; width: 0.467em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-2918" style="font-family: STIXGeneral-Regular;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.23em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="msubsup" id="MathJax-Span-2919"><span style="display: inline-block; position: relative; width: 0.746em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.28em 4.322em -999.998em); top: -3.992em; left: 0em;"><span class="mo" id="MathJax-Span-2920" style="font-family: STIXGeneral-Regular;">)</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.411em; left: 0.327em;"><span class="mn" id="MathJax-Span-2921" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2922"><span class="mrow" id="MathJax-Span-2923"><span class="mtext" id="MathJax-Span-2924" style="font-family: STIXGeneral-Regular;">d</span><span class="mspace" id="MathJax-Span-2925" style="height: 0em; vertical-align: 0em; width: 0.327em; display: inline-block; overflow: hidden;"></span></span></span><span class="mi" id="MathJax-Span-2926" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.046em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>J</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>θ</mi><mo stretchy="false">→</mo></mover></mrow><mo stretchy="false">)</mo><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mfrac><mn>1</mn><mrow><msub><mi>t</mi><mi>f</mi></msub><mo>−</mo><msub><mi>t</mi><mi>o</mi></msub></mrow></mfrac></mrow><msubsup><mo>∫</mo><mrow class="MJX-TeXAtom-ORD"><msub><mi>t</mi><mn>0</mn></msub></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>t</mi><mi>f</mi></msub></mrow></msubsup><mi>e</mi><mo stretchy="false">(</mo><mi>t</mi><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>θ</mi><mo stretchy="false">→</mo></mover></mrow><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mrow class="MJX-TeXAtom-ORD"><mtext>d</mtext><mspace width="thickmathspace"></mspace></mrow><mi>t</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-136">J(\vec\theta) = {\frac{1}{t_f - t_o}} \int_{t_0}^{t_f} e(t, \vec\theta)^2 {\text{d}\;}t</script></span> where <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-137-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2927" style="width: 2.743em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.325em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.396em 1002.28em 2.882em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-2928"><span class="mi" id="MathJax-Span-2929" style="font-family: STIXGeneral-Italic;">e</span><span class="mo" id="MathJax-Span-2930" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2931" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-2932" style="font-family: STIXGeneral-Regular;">,</span><span class="texatom" id="MathJax-Span-2933" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-2934"><span class="munderover" id="MathJax-Span-2935"><span style="display: inline-block; position: relative; width: 0.513em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.51em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2936" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.225em; left: 0.049em;"><span style="height: 0em; vertical-align: 0em; width: 0.467em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-2937" style="font-family: STIXGeneral-Regular;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.23em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-2938" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.269em; border-left: 0px solid; width: 0px; height: 1.47em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>e</mi><mo stretchy="false">(</mo><mi>t</mi><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>θ</mi><mo stretchy="false">→</mo></mover></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-137">e(t, \vec\theta)</script></span> is the error in following some reference trajectory with some initial disturbance using a set of parameters <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-138-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2939" style="width: 0.606em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.513em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.071em 1000.51em 2.371em -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-2940"><span class="texatom" id="MathJax-Span-2941"><span class="mrow" id="MathJax-Span-2942"><span class="munderover" id="MathJax-Span-2943"><span style="display: inline-block; position: relative; width: 0.513em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.51em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2944" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.225em; left: 0.049em;"><span style="height: 0em; vertical-align: 0em; width: 0.467em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-2945" style="font-family: STIXGeneral-Regular;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.23em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 1.307em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mi>θ</mi><mo stretchy="false">→</mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-138">\vec\theta</script></span>. Suppose we were able to somehow compute the gradient of this cost function, <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-139-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2946" style="width: 2.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.418em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.396em 1002.37em 2.882em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-2947"><span class="mi" id="MathJax-Span-2948" style="font-family: STIXGeneral-Regular;">∇</span><span class="mi" id="MathJax-Span-2949" style="font-family: STIXGeneral-Italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mo" id="MathJax-Span-2950" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-2951"><span class="mrow" id="MathJax-Span-2952"><span class="munderover" id="MathJax-Span-2953"><span style="display: inline-block; position: relative; width: 0.513em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.51em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2954" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.225em; left: 0.049em;"><span style="height: 0em; vertical-align: 0em; width: 0.467em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-2955" style="font-family: STIXGeneral-Regular;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.23em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-2956" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.269em; border-left: 0px solid; width: 0px; height: 1.47em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">∇</mi><mi>J</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>θ</mi><mo stretchy="false">→</mo></mover></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-139">\nabla J(\vec\theta)</script></span>. In that case, we could iteratively improve our parameter vector by defining a parameter update rule <span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-140-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2957" style="width: 12.08em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.314em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.396em 1010.27em 2.882em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-2958"><span class="texatom" id="MathJax-Span-2959"><span class="mrow" id="MathJax-Span-2960"><span class="munderover" id="MathJax-Span-2961"><span style="display: inline-block; position: relative; width: 0.513em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.51em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2962" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.225em; left: 0.049em;"><span style="height: 0em; vertical-align: 0em; width: 0.467em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-2963" style="font-family: STIXGeneral-Regular;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.23em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-2964" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2965" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-2966" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">+</span><span class="mn" id="MathJax-Span-2967" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">1</span><span class="mo" id="MathJax-Span-2968" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2969" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="texatom" id="MathJax-Span-2970" style="padding-left: 0.327em;"><span class="mrow" id="MathJax-Span-2971"><span class="munderover" id="MathJax-Span-2972"><span style="display: inline-block; position: relative; width: 0.513em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.51em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2973" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.225em; left: 0.049em;"><span style="height: 0em; vertical-align: 0em; width: 0.467em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-2974" style="font-family: STIXGeneral-Regular;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.23em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-2975" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2976" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-2977" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2978" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">−</span><span class="mi" id="MathJax-Span-2979" style="font-family: STIXGeneral-Italic; padding-left: 0.235em;">α</span><span class="mi" id="MathJax-Span-2980" style="font-family: STIXGeneral-Regular;">∇</span><span class="mi" id="MathJax-Span-2981" style="font-family: STIXGeneral-Italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mo" id="MathJax-Span-2982" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-2983"><span class="mrow" id="MathJax-Span-2984"><span class="munderover" id="MathJax-Span-2985"><span style="display: inline-block; position: relative; width: 0.513em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.51em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2986" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.225em; left: 0.049em;"><span style="height: 0em; vertical-align: 0em; width: 0.467em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-2987" style="font-family: STIXGeneral-Regular;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.23em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-2988" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.269em; border-left: 0px solid; width: 0px; height: 1.47em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mover><mi>θ</mi><mo stretchy="false">→</mo></mover></mrow><mo stretchy="false">(</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>θ</mi><mo stretchy="false">→</mo></mover></mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo>−</mo><mi>α</mi><mi mathvariant="normal">∇</mi><mi>J</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>θ</mi><mo stretchy="false">→</mo></mover></mrow><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-140">\vec\theta(k + 1) = \vec\theta(k) - \alpha \nabla J(\vec \theta)</script></span> where <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-141-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2989" style="width: 1.907em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.628em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.396em 1001.58em 2.882em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-2990"><span class="texatom" id="MathJax-Span-2991"><span class="mrow" id="MathJax-Span-2992"><span class="munderover" id="MathJax-Span-2993"><span style="display: inline-block; position: relative; width: 0.513em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.51em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2994" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.225em; left: 0.049em;"><span style="height: 0em; vertical-align: 0em; width: 0.467em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-2995" style="font-family: STIXGeneral-Regular;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.23em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-2996" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2997" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-2998" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.269em; border-left: 0px solid; width: 0px; height: 1.47em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mi>θ</mi><mo stretchy="false">→</mo></mover></mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-141">\vec\theta(k)</script></span> is the parameter vector after <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-142-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2999" style="width: 0.56em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.721em 1000.47em 2.696em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-3000"><span class="mi" id="MathJax-Span-3001" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-142">k</script></span> iterations and <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-143-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3002" style="width: 0.653em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.56em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(2em 1000.56em 2.696em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-3003"><span class="mi" id="MathJax-Span-3004" style="font-family: STIXGeneral-Italic;">α</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.655em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>α</mi></math></span></span><script type="math/tex" id="MathJax-Element-143">\alpha</script></span> is some step size which dictates how much we adjust our parameter vector at each step of the iteration. As <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-144-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x221E;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3005" style="width: 3.44em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.929em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.721em 1002.84em 2.696em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-3006"><span class="mi" id="MathJax-Span-3007" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-3008" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">→</span><span class="mi" id="MathJax-Span-3009" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">∞</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><mo stretchy="false">→</mo><mi mathvariant="normal">∞</mi></math></span></span><script type="math/tex" id="MathJax-Element-144">k\to\infty</script></span>, the cost function <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-145-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3010" style="width: 1.953em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.675em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.396em 1001.63em 2.882em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-3011"><span class="mi" id="MathJax-Span-3012" style="font-family: STIXGeneral-Italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mo" id="MathJax-Span-3013" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-3014"><span class="mrow" id="MathJax-Span-3015"><span class="munderover" id="MathJax-Span-3016"><span style="display: inline-block; position: relative; width: 0.513em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.51em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-3017" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.225em; left: 0.049em;"><span style="height: 0em; vertical-align: 0em; width: 0.467em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-3018" style="font-family: STIXGeneral-Regular;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.23em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-3019" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.269em; border-left: 0px solid; width: 0px; height: 1.47em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>J</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>θ</mi><mo stretchy="false">→</mo></mover></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-145">J(\vec\theta)</script></span> will approach a local minimum in the space of PID parameters.</p>
<p>The question remains as to how we can estimate <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-146-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3020" style="width: 2.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.418em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.396em 1002.37em 2.882em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-3021"><span class="mi" id="MathJax-Span-3022" style="font-family: STIXGeneral-Regular;">∇</span><span class="mi" id="MathJax-Span-3023" style="font-family: STIXGeneral-Italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mo" id="MathJax-Span-3024" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-3025"><span class="mrow" id="MathJax-Span-3026"><span class="munderover" id="MathJax-Span-3027"><span style="display: inline-block; position: relative; width: 0.513em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.51em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-3028" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.225em; left: 0.049em;"><span style="height: 0em; vertical-align: 0em; width: 0.467em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-3029" style="font-family: STIXGeneral-Regular;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.23em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-3030" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.269em; border-left: 0px solid; width: 0px; height: 1.47em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">∇</mi><mi>J</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>θ</mi><mo stretchy="false">→</mo></mover></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-146">\nabla J(\vec\theta)</script></span>. By definition, <span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-147-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mfrac&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mfrac&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mfrac&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3031" style="width: 20.301em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.329em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(2.511em 1017.28em 5.251em -999.998em); top: -4.132em; left: 0em;"><span class="mrow" id="MathJax-Span-3032"><span class="mi" id="MathJax-Span-3033" style="font-family: STIXGeneral-Regular;">∇</span><span class="mi" id="MathJax-Span-3034" style="font-family: STIXGeneral-Italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mo" id="MathJax-Span-3035" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-3036"><span class="mrow" id="MathJax-Span-3037"><span class="munderover" id="MathJax-Span-3038"><span style="display: inline-block; position: relative; width: 0.513em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.51em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-3039" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.225em; left: 0.049em;"><span style="height: 0em; vertical-align: 0em; width: 0.467em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-3040" style="font-family: STIXGeneral-Regular;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.23em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-3041" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3042" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">=</span><span class="mrow" id="MathJax-Span-3043" style="padding-left: 0.327em;"><span class="mo" id="MathJax-Span-3044" style="vertical-align: -0.602em;"><span style="font-family: STIXSizeThreeSym;">(</span></span><span class="mrow" id="MathJax-Span-3045"><span class="texatom" id="MathJax-Span-3046"><span class="mrow" id="MathJax-Span-3047"><span class="mfrac" id="MathJax-Span-3048"><span style="display: inline-block; position: relative; width: 1.675em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.207em 1000.47em 4.136em -999.998em); top: -4.689em; left: 50%; margin-left: -0.23em;"><span class="mi" id="MathJax-Span-3049" style="font-family: STIXGeneral-Regular;">∂</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.207em 1001.58em 4.415em -999.998em); top: -3.296em; left: 50%; margin-left: -0.787em;"><span class="mrow" id="MathJax-Span-3050"><span class="mi" id="MathJax-Span-3051" style="font-family: STIXGeneral-Regular;">∂</span><span class="msubsup" id="MathJax-Span-3052"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.75em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-3053" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.653em;"><span class="mi" id="MathJax-Span-3054" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em 1001.67em 1.21em -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.675em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span></span></span><span class="mi" id="MathJax-Span-3055" style="font-family: STIXGeneral-Italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mo" id="MathJax-Span-3056" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-3057"><span class="mrow" id="MathJax-Span-3058"><span class="munderover" id="MathJax-Span-3059"><span style="display: inline-block; position: relative; width: 0.513em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.51em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-3060" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.225em; left: 0.049em;"><span style="height: 0em; vertical-align: 0em; width: 0.467em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-3061" style="font-family: STIXGeneral-Regular;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.23em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-3062" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3063" style="font-family: STIXGeneral-Regular;">,</span><span class="texatom" id="MathJax-Span-3064" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-3065"><span class="mfrac" id="MathJax-Span-3066"><span style="display: inline-block; position: relative; width: 1.535em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.207em 1000.47em 4.136em -999.998em); top: -4.689em; left: 50%; margin-left: -0.23em;"><span class="mi" id="MathJax-Span-3067" style="font-family: STIXGeneral-Regular;">∂</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.207em 1001.4em 4.276em -999.998em); top: -3.296em; left: 50%; margin-left: -0.694em;"><span class="mrow" id="MathJax-Span-3068"><span class="mi" id="MathJax-Span-3069" style="font-family: STIXGeneral-Regular;">∂</span><span class="msubsup" id="MathJax-Span-3070"><span style="display: inline-block; position: relative; width: 0.931em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.75em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-3071" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.653em;"><span class="mi" id="MathJax-Span-3072" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em 1001.53em 1.21em -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.535em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span></span></span><span class="mi" id="MathJax-Span-3073" style="font-family: STIXGeneral-Italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mo" id="MathJax-Span-3074" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-3075"><span class="mrow" id="MathJax-Span-3076"><span class="munderover" id="MathJax-Span-3077"><span style="display: inline-block; position: relative; width: 0.513em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.51em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-3078" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.225em; left: 0.049em;"><span style="height: 0em; vertical-align: 0em; width: 0.467em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-3079" style="font-family: STIXGeneral-Regular;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.23em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-3080" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3081" style="font-family: STIXGeneral-Regular;">,</span><span class="texatom" id="MathJax-Span-3082" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-3083"><span class="mfrac" id="MathJax-Span-3084"><span style="display: inline-block; position: relative; width: 1.721em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.207em 1000.47em 4.136em -999.998em); top: -4.689em; left: 50%; margin-left: -0.23em;"><span class="mi" id="MathJax-Span-3085" style="font-family: STIXGeneral-Regular;">∂</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.207em 1001.58em 4.276em -999.998em); top: -3.296em; left: 50%; margin-left: -0.787em;"><span class="mrow" id="MathJax-Span-3086"><span class="mi" id="MathJax-Span-3087" style="font-family: STIXGeneral-Regular;">∂</span><span class="msubsup" id="MathJax-Span-3088"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(3.207em 1000.75em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-3089" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.653em;"><span class="mi" id="MathJax-Span-3090" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em 1001.72em 1.21em -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.721em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span></span></span><span class="mi" id="MathJax-Span-3091" style="font-family: STIXGeneral-Italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mo" id="MathJax-Span-3092" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-3093"><span class="mrow" id="MathJax-Span-3094"><span class="munderover" id="MathJax-Span-3095"><span style="display: inline-block; position: relative; width: 0.513em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.51em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-3096" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.225em; left: 0.049em;"><span style="height: 0em; vertical-align: 0em; width: 0.467em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-3097" style="font-family: STIXGeneral-Regular;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.23em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-3098" style="font-family: STIXGeneral-Regular;">)</span></span><span class="mo" id="MathJax-Span-3099" style="vertical-align: -0.602em;"><span style="font-family: STIXSizeThreeSym;">)</span></span></span><span class="mo" id="MathJax-Span-3100" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">.</span></span><span style="display: inline-block; width: 0px; height: 4.136em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.193em; border-left: 0px solid; width: 0px; height: 2.992em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi mathvariant="normal">∇</mi><mi>J</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>θ</mi><mo stretchy="false">→</mo></mover></mrow><mo stretchy="false">)</mo><mo>=</mo><mrow><mo>(</mo><mrow><mrow class="MJX-TeXAtom-ORD"><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>K</mi><mi>p</mi></msub></mrow></mfrac></mrow><mi>J</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>θ</mi><mo stretchy="false">→</mo></mover></mrow><mo stretchy="false">)</mo><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>K</mi><mi>i</mi></msub></mrow></mfrac></mrow><mi>J</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>θ</mi><mo stretchy="false">→</mo></mover></mrow><mo stretchy="false">)</mo><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>K</mi><mi>d</mi></msub></mrow></mfrac></mrow><mi>J</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>θ</mi><mo stretchy="false">→</mo></mover></mrow><mo stretchy="false">)</mo></mrow><mo>)</mo></mrow><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-147">\nabla J(\vec\theta) = \left({\frac{\partial  }{\partial K_p}} J(\vec\theta), {\frac{\partial  }{\partial K_i}} J(\vec\theta), {\frac{\partial  }{\partial K_d}}
    J(\vec\theta)\right).</script></span> We know how to compute <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-148-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3101" style="width: 1.953em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.675em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.396em 1001.63em 2.882em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-3102"><span class="mi" id="MathJax-Span-3103" style="font-family: STIXGeneral-Italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mo" id="MathJax-Span-3104" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-3105"><span class="mrow" id="MathJax-Span-3106"><span class="munderover" id="MathJax-Span-3107"><span style="display: inline-block; position: relative; width: 0.513em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.51em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-3108" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.225em; left: 0.049em;"><span style="height: 0em; vertical-align: 0em; width: 0.467em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-3109" style="font-family: STIXGeneral-Regular;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.23em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-3110" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.269em; border-left: 0px solid; width: 0px; height: 1.47em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>J</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>θ</mi><mo stretchy="false">→</mo></mover></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-148">J(\vec\theta)</script></span>. Using this, we can approximate the derivative with respect to any of the gains numerically, simply by computing <span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-149-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mfrac&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2248;&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3111" style="width: 19.187em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.4em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(0.746em 1016.4em 3.393em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-3112"><span class="texatom" id="MathJax-Span-3113"><span class="mrow" id="MathJax-Span-3114"><span class="mfrac" id="MathJax-Span-3115"><span style="display: inline-block; position: relative; width: 1.303em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(3.207em 1000.47em 4.136em -999.998em); top: -4.689em; left: 50%; margin-left: -0.23em;"><span class="mi" id="MathJax-Span-3116" style="font-family: STIXGeneral-Regular;">∂</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.207em 1001.21em 4.136em -999.998em); top: -3.296em; left: 50%; margin-left: -0.602em;"><span class="mrow" id="MathJax-Span-3117"><span class="mi" id="MathJax-Span-3118" style="font-family: STIXGeneral-Regular;">∂</span><span class="mi" id="MathJax-Span-3119" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em 1001.3em 1.21em -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.303em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span></span></span><span class="mi" id="MathJax-Span-3120" style="font-family: STIXGeneral-Italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mo" id="MathJax-Span-3121" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-3122"><span class="mrow" id="MathJax-Span-3123"><span class="munderover" id="MathJax-Span-3124"><span style="display: inline-block; position: relative; width: 0.513em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.51em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-3125" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.225em; left: 0.049em;"><span style="height: 0em; vertical-align: 0em; width: 0.467em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-3126" style="font-family: STIXGeneral-Regular;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.23em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-3127" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3128" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">≈</span><span class="mfrac" id="MathJax-Span-3129" style="padding-left: 0.327em;"><span style="display: inline-block; position: relative; width: 11.522em; height: 0px; margin-right: 0.142em; margin-left: 0.142em;"><span style="position: absolute; clip: rect(2.836em 1011.34em 4.322em -999.998em); top: -4.689em; left: 50%; margin-left: -5.665em;"><span class="mrow" id="MathJax-Span-3130"><span class="mi" id="MathJax-Span-3131" style="font-family: STIXGeneral-Italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mo" id="MathJax-Span-3132" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-3133"><span class="mrow" id="MathJax-Span-3134"><span class="munderover" id="MathJax-Span-3135"><span style="display: inline-block; position: relative; width: 0.513em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.51em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-3136" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.225em; left: 0.049em;"><span style="height: 0em; vertical-align: 0em; width: 0.467em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-3137" style="font-family: STIXGeneral-Regular;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.23em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-3138" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">+</span><span class="mi" id="MathJax-Span-3139" style="font-family: STIXGeneral-Italic; padding-left: 0.235em;">δ</span><span class="mo" id="MathJax-Span-3140" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">⋅</span><span class="msubsup" id="MathJax-Span-3141" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 1.071em; height: 0px;"><span style="position: absolute; clip: rect(3.115em 1000.47em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-3142"><span class="mrow" id="MathJax-Span-3143"><span class="munderover" id="MathJax-Span-3144"><span style="display: inline-block; position: relative; width: 0.513em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.47em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-3145" style="font-family: STIXGeneral-Italic;">u</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.039em; left: 0.095em;"><span style="height: 0em; vertical-align: 0em; width: 0.374em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-3146" style="font-family: STIXGeneral-Regular;">̂&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.23em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.513em;"><span class="mi" id="MathJax-Span-3147" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-3148" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3149" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">−</span><span class="mi" id="MathJax-Span-3150" style="font-family: STIXGeneral-Italic; padding-left: 0.235em;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mo" id="MathJax-Span-3151" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-3152"><span class="mrow" id="MathJax-Span-3153"><span class="munderover" id="MathJax-Span-3154"><span style="display: inline-block; position: relative; width: 0.513em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.51em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-3155" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.225em; left: 0.049em;"><span style="height: 0em; vertical-align: 0em; width: 0.467em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-3156" style="font-family: STIXGeneral-Regular;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.23em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-3157" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">−</span><span class="mi" id="MathJax-Span-3158" style="font-family: STIXGeneral-Italic; padding-left: 0.235em;">δ</span><span class="mo" id="MathJax-Span-3159" style="font-family: STIXGeneral-Regular; padding-left: 0.235em;">⋅</span><span class="msubsup" id="MathJax-Span-3160" style="padding-left: 0.235em;"><span style="display: inline-block; position: relative; width: 1.071em; height: 0px;"><span style="position: absolute; clip: rect(3.115em 1000.47em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-3161"><span class="mrow" id="MathJax-Span-3162"><span class="munderover" id="MathJax-Span-3163"><span style="display: inline-block; position: relative; width: 0.513em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.47em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-3164" style="font-family: STIXGeneral-Italic;">u</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.039em; left: 0.095em;"><span style="height: 0em; vertical-align: 0em; width: 0.374em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-3165" style="font-family: STIXGeneral-Regular;">̂&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.23em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.513em;"><span class="mi" id="MathJax-Span-3166" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-3167" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(3.161em 1000.98em 4.136em -999.998em); top: -3.296em; left: 50%; margin-left: -0.462em;"><span class="mrow" id="MathJax-Span-3168"><span class="mn" id="MathJax-Span-3169" style="font-family: STIXGeneral-Regular;">2</span><span class="mi" id="MathJax-Span-3170" style="font-family: STIXGeneral-Italic;">δ</span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; clip: rect(0.885em 1011.52em 1.21em -999.998em); top: -1.298em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 11.522em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.071em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.867em; border-left: 0px solid; width: 0px; height: 2.883em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><mi>K</mi></mrow></mfrac></mrow><mi>J</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>θ</mi><mo stretchy="false">→</mo></mover></mrow><mo stretchy="false">)</mo><mo>≈</mo><mfrac><mrow><mi>J</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>θ</mi><mo stretchy="false">→</mo></mover></mrow><mo>+</mo><mi>δ</mi><mo>⋅</mo><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>u</mi><mo stretchy="false">^</mo></mover></mrow><mi>K</mi></msub><mo stretchy="false">)</mo><mo>−</mo><mi>J</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>θ</mi><mo stretchy="false">→</mo></mover></mrow><mo>−</mo><mi>δ</mi><mo>⋅</mo><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>u</mi><mo stretchy="false">^</mo></mover></mrow><mi>K</mi></msub><mo stretchy="false">)</mo></mrow><mrow><mn>2</mn><mi>δ</mi></mrow></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-149">{\frac{\partial  }{\partial K}} J(\vec\theta) \approx \frac{J(\vec\theta + \delta\cdot \hat{u}_K) - J(\vec\theta-
    \delta\cdot \hat{u}_K)}{2\delta}</script></span> where <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-150-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3171" style="width: 1.257em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.071em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.349em 1001.07em 2.511em -999.998em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-3172"><span class="msubsup" id="MathJax-Span-3173"><span style="display: inline-block; position: relative; width: 1.071em; height: 0px;"><span style="position: absolute; clip: rect(3.115em 1000.47em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-3174"><span class="mrow" id="MathJax-Span-3175"><span class="munderover" id="MathJax-Span-3176"><span style="display: inline-block; position: relative; width: 0.513em; height: 0px;"><span style="position: absolute; clip: rect(3.44em 1000.47em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-3177" style="font-family: STIXGeneral-Italic;">u</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.039em; left: 0.095em;"><span style="height: 0em; vertical-align: 0em; width: 0.374em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-3178" style="font-family: STIXGeneral-Regular;">̂&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.23em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.853em; left: 0.513em;"><span class="mi" id="MathJax-Span-3179" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.232em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.215em; border-left: 0px solid; width: 0px; height: 1.144em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>u</mi><mo stretchy="false">^</mo></mover></mrow><mi>K</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-150">\hat{u}_K</script></span> is the unit vector in the <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-151-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3180" style="width: 0.838em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.699em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.767em 1000.7em 2.696em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-3181"><span class="mi" id="MathJax-Span-3182" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.872em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script type="math/tex" id="MathJax-Element-151">K</script></span> direction. As <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-152-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B4;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3183" style="width: 3.022em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.557em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.721em 1002.51em 2.696em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-3184"><span class="mi" id="MathJax-Span-3185" style="font-family: STIXGeneral-Italic;">δ</span><span class="mo" id="MathJax-Span-3186" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">→</span><span class="mn" id="MathJax-Span-3187" style="font-family: STIXGeneral-Regular; padding-left: 0.327em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.052em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>δ</mi><mo stretchy="false">→</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-152">\delta\to 0</script></span>, this approximation becomes better. Using this approximation, we can minimize our cost function and achieve locally optimal PID parameters. We can start with randomly initialized positive weights, disturb the system in some set manner, evaluate <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-153-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3188" style="width: 1.953em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.675em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.396em 1001.63em 2.882em -999.998em); top: -2.552em; left: 0em;"><span class="mrow" id="MathJax-Span-3189"><span class="mi" id="MathJax-Span-3190" style="font-family: STIXGeneral-Italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"></span></span><span class="mo" id="MathJax-Span-3191" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-3192"><span class="mrow" id="MathJax-Span-3193"><span class="munderover" id="MathJax-Span-3194"><span style="display: inline-block; position: relative; width: 0.513em; height: 0px;"><span style="position: absolute; clip: rect(3.161em 1000.51em 4.136em -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-3195" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -4.225em; left: 0.049em;"><span style="height: 0em; vertical-align: 0em; width: 0.467em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-3196" style="font-family: STIXGeneral-Regular;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.23em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-3197" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.557em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.269em; border-left: 0px solid; width: 0px; height: 1.47em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>J</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>θ</mi><mo stretchy="false">→</mo></mover></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-153">J(\vec\theta)</script></span> by simulating the system for different PID parameters, and then compute the gradient. Then, using the method of gradient descent, we can iteratively oprtimize our gains until we have some form of convergence.</p>
<p>The gradient descent method does, however, have several problems. First of all, although it finds a local minimum, that minimum is only guaranteed to be a <em>local</em> minimum - there may be other minima which are better global minima. In order to avoid choosing suboptimal local minima in the cost function, we repeat our optimization several times, and choose the best result. We initialize our PID parameters randomly, so each time we run the optimization we will get a different result. In addition, instead of choosing disturbance and then optimizing the response to that disturbance, we use several random disturbances at each iteration and use the average response to compute costs and gradients. This ensures that our parameters are general and not optimized for a specific disturbance. In addition, we vary the step size and the number of disturbances to try per iteration, in order to increase the sensitivity of our results as our iteration continues. We stop iterations when we detect a steady state, which we do by computing a linear regression on the most recent costs and iterating until the slope is statistically indistinguishable from zero using a 99% confidence interval.</p>
<p>Using our quadcopter simulation, we can define a function that computes the cost for a given set of PID parameters.</p>
<div class="sourceCode"><pre class="sourceCode matlab"><code class="sourceCode matlab">function J = cost(theta)
    <span class="co">% Create a controller using the given gains.</span>
    control = controller(<span class="st">'pid'</span>, theta(<span class="fl">1</span>), theta(<span class="fl">2</span>), theta(<span class="fl">3</span>));

    <span class="co">% Perform a simulation.</span>
    data = simulate(control);

    <span class="co">% Compute the integral, $\frac{1}{t_f - t_0} \int_{t_0}^{t_f} e(t)^2 dt$</span>
    t0 = <span class="fl">0</span>;
    tf = <span class="fl">1</span>;
    J = <span class="fl">1</span>/(tf - t0) * sum(data.theta(data.t &gt;= t0 &amp; data.t &lt;= tf) .^ <span class="fl">2</span>) * data.dt;
end</code></pre></div>
<p>We can use this function to approximate a derivative with respect to a gain:</p>
<div class="sourceCode"><pre class="sourceCode matlab"><code class="sourceCode matlab"><span class="co">% Compute derivative with respect to first parameter.</span>
delta = <span class="fl">0.01</span>;
var = [<span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>];
derivative = (cost(theta + delta * var) - cost(theta - delta * var)) / (<span class="fl">2</span> * delta);</code></pre></div>
<p>We can then use our gradient descent method (with all modifications described above) to minimize the cost function and obtain a good set of PID parameters. We can verify that our tuning method is working by visualizing the cost function versus the iteration number, and seeing that the cost function is indeed going down and stabilizing at a local minimum.</p>
<p><img src="./Quadcopter_Dynamics_and_Simulation_files/training.png" alt="image"><br>
<span> Cost function plotted as a function of iteration number, along with moving average. Tuning stops when the slope of the moving average becomes statistically indistinguishable from zero with a 99% confidence interval. </span></p>
<p>We can compare the manually-chosen PID parameters with those designed by the algorithm.</p>
<p><img src="./Quadcopter_Dynamics_and_Simulation_files/pid_gains_comparison.png" alt="image"><br>
<span> Top: Angular velocities and angular displacements, using manually tuned PID controller. Bottom: Angular velocities and angular displacements, using automatically tuned PID controller. </span></p>
<p>The automatically-chosen PID parameters do significantly better overall. They have significantly smaller swings in value, overshoot significantly less, and converge faster. However, the error in the angular displacement takes longer to converge to zero with the automatically tuned parameters than with the manually turned parameters, although the initial convergence is much better when the parameters are chosen via gradient descent. This is due to the fact that our cost function emphasizes squared error, and thus gives priority to minimizing overall error magnitude rather than long-term convergence. We could easily modify our cost function to give higher priority to long-term error, in which case the automatically-tuned parameters are likely to do better.</p>
<h1 id="conclusion" class="unnumbered">Conclusion</h1>
<p>We derived equations of motion for a quadcopter, starting with the voltage-torque relation for the brushless motors and working through the quadcopter kinematics and dynamics. We ignored aerodynamical effects such as blade-flapping and non-zero free stream velocity, but included air friction as a linear drag force in all directions. We used the equations of motion to create a simulator in which to test and visualize quadcopter control mechanisms.</p>
<p>We began with a simple PD controller. Although the PD controller worked, it left a significant steady-state error. In order to decrease the steady-state error, we added an integral term in order to create a PID controller. We tested the PID controller (with minor modifications to prevent integral wind-up) and found that it was better at preventing steady-state error than the PD controller when presented with the same disturbances and using the same proportional and derivative gains. We also found that tuning the PID controller was difficult, and would often lead to an unstable system for unknown reasons. In order to avoid the difficulty of PID tuning and find the optimal set of parameters, we used a gradient-descent based extremum seeking method in order to numerically estimate gradients of a cost function in PID-parameter space and iteratively choose a set of parameters to minimize the cost function. We found that the resulting controller was significantly better than the one using manually turned parameters.</p>
</div>


  <footer>
    <p class="meta">
      Friday, November 23, 2012 - Posted in <a href="http://andrew.gibiansky.com/blog/categories/physics">physics</a>, <a href="http://andrew.gibiansky.com/blog/categories/simulations">simulations</a>
    </p>

    <p class="meta">
      
        <a class="basic-alignment left" href="http://andrew.gibiansky.com/blog/electrical-engineering/the-digital-state" title="Previous Post: The Digital State">« The Digital State</a>
      
      
        <a class="basic-alignment right" href="http://andrew.gibiansky.com/blog/electrical-engineering/digital-design-tools-verilog-and-hdls" title="Next Post: Digital Design Tools: Verilog and HDLs">Digital Design Tools: Verilog and HDLs »</a>
      
    </p>
  </footer>

</article>
</div>

<aside class="sidebar">
  <section>
    <h1>Contact</h1>

    <p>
      If you've got questions, comments, suggestions, or just want to talk, feel
      free to email me at andrew.gibiansky on Gmail.
    </p>

    <img src="./Quadcopter_Dynamics_and_Simulation_files/photo.jpg" alt="photo">
  </section>


  <section>
    <h1>Recent Posts <a href="http://andrew.gibiansky.com/feed.rss">(RSS)</a></h1>

    <ul id="recent_posts">
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/machine-learning/nram-2">NRAM: Theano Implementation</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/machine-learning/nram-1">NRAM: Neural Random Access Memory</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/command-line/jq-primer">jq Primer: Munging JSON Data</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/thoughts/engineering-practices">Creating a Culture of Good Engineering</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/genetics/technique-primers">Common Techniques in Molecular Biology</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/genetics/crispr">CRISPR Gene Editing</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/machine-learning/coding-intro-to-nns">Quick Coding Intro to Neural Networks</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/verification/writing-a-sat-solver">Writing a SAT Solver</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/physics/lattice-boltzmann-method">Lattice Boltzmann Method</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/haskell/finger-trees">Finger Trees</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/haskell/haskell-abstractions">Abstraction in Haskell (Monoids, Functors, Monads)</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/haskell/haskell-typeclasses">Typeclasses: Polymorphism in Haskell</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/haskell/haskell-gloss">Your First Haskell Application (with Gloss)</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/haskell/haskell-syntax">Intro to Haskell Syntax</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/linguistics/why-syntax">Linguistics and Syntax</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/machine-learning/speech-recognition-neural-networks">Speech Recognition with Neural Networks</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/mathematics/matrix-multiplication">Matrix Multiplication</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/machine-learning/recurrent-neural-networks">Recurrent Neural Networks</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/machine-learning/gauss-newton-matrix">Gauss Newton Matrix</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/machine-learning/convolutional-neural-networks">Convolutional Neural Networks</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/machine-learning/fully-connected-neural-networks">Fully Connected Neural Network Algorithms</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/machine-learning/hessian-free-optimization">Hessian Free Optimization</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/machine-learning/conjugate-gradient">Conjugate Gradient</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/machine-learning/gradient-descent">Gradient Descent Typeclasses in Haskell</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/linguistics/homophony-groups">Homophony Groups in Haskell</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/ipython/ipython-kernels">Creating Language Kernels for IPython</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/machine-learning/qpcr-blog-post">Detecting Genetic Copynumber with Gaussian Mixture Models</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/machine-learning/k-nearest-neighbors-simplest-machine-learning">K Nearest Neighbors: Simplest Machine Learning</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/mathematics/cool-linear-algebra-singular-value-decomposition">Cool Linear Algebra: Singular Value Decomposition</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/economics/accelerating-options-pricing-via-fourier-transforms">Accelerating Options Pricing via Fourier Transforms</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/economics/binomial-options-pricing-model">Pricing Stock Options via the Binomial Model</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/electrical-engineering/your-very-first-microprocessor">Your Very First Microprocessor</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/electrical-engineering/circuits-and-arithmetic">Circuits and Arithmetic</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/electrical-engineering/digital-design-tools-verilog-and-hdls">Digital Design Tools: Verilog and HDLs</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/physics/quadcopter-dynamics">Quadcopter Dynamics and Simulation</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/electrical-engineering/the-digital-state">The Digital State</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/electrical-engineering/computing-with-transistors">Computing with Transistors</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/machine-learning/machine-learning-neural-networks">Machine Learning: Neural Networks</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/machine-learning/machine-learning-the-basics">Machine Learning: the Basics</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/economics/iranian-political-embargoes-and-their-non-existent-impact-on-gasoline-prices">Iranian Political Embargoes, and their Non-Existent Impact on Gasoline Prices</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/physics/computational-fluid-dynamics">Computational Fluid Dynamics</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/physics/fluid-dynamics-the-navier-stokes-equations">Fluid Dynamics: The Navier-Stokes Equations</a>
        </li>
      
        <li class="post">
          <a href="http://andrew.gibiansky.com/blog/image-processing/image-morphing">Image Morphing</a>
        </li>
      
    </ul>

  </section>

  <section>
      <p>The content on this blog is licensed under the <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA license</a>.</p>
  </section>
</aside>


    </div>
  </div>


<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: STIXSizeOneSym, sans-serif;"></div></div></body></html>